'use strict';
var __extends = (function () {
		var K = function (E, F) {
			return (K =
				Object.setPrototypeOf ||
				({ __proto__: [] } instanceof Array &&
					function (Z, Y) {
						Z.__proto__ = Y;
					}) ||
				function (Z, Y) {
					for (var $ in Y) Object.prototype.hasOwnProperty.call(Y, $) && (Z[$] = Y[$]);
				})(E, F);
		};
		return function (E, F) {
			function Z() {
				this.constructor = E;
			}
			if (typeof F != 'function' && F !== null)
				throw new TypeError('Class extends value ' + String(F) + ' is not a constructor or null');
			K(E, F),
				(E.prototype = F === null ? Object.create(F) : ((Z.prototype = F.prototype), new Z()));
		};
	})(),
	__assign = function () {
		return (
			(__assign =
				Object.assign ||
				function (K) {
					var E, F, Z, Y;
					for (F = 1, Z = arguments.length; F < Z; F++) {
						E = arguments[F];
						for (Y in E) Object.prototype.hasOwnProperty.call(E, Y) && (K[Y] = E[Y]);
					}
					return K;
				}),
			__assign.apply(this, arguments)
		);
	};
(function () {
	function K() {}
	function E(o, n) {
		if (!n) throw new Error('prayer failed: ' + o);
	}
	function F(o) {
		E('a direction was passed', o === l || o === c);
	}
	function Z(o) {
		var n,
			t = document.implementation.createHTMLDocument('');
		if (((t.body.innerHTML = o), t.body.children.length === 1)) return t.body.children[0];
		for (n = document.createDocumentFragment(); t.body.firstChild; )
			n.appendChild(t.body.firstChild);
		return n;
	}
	function Y(o, n) {
		var t, e, r, i, a;
		if (typeof ((t = o) === null || t === void 0 ? void 0 : t.closest) == 'function')
			return o.closest(n);
		if (!(o instanceof HTMLElement)) return null;
		(i =
			Element.prototype.matches ||
			Element.prototype.msMatchesSelector ||
			Element.prototype.webkitMatchesSelector),
			(a = o);
		do {
			if (i.call(a, n)) return a;
			a =
				(r = (e = a?.parentElement) !== null && e !== void 0 ? e : a?.parentNode) !== null &&
				r !== void 0
					? r
					: null;
		} while (a !== null && a.nodeType === 1);
		return null;
	}
	function $(o) {
		return o.getClientRects().length
			? o.getBoundingClientRect()
			: { top: 0, left: 0, height: 0, width: 0, x: 0, y: 0, bottom: 0, right: 0 };
	}
	function Ze() {
		return window.pageXOffset !== void 0
			? window.pageXOffset
			: (document.documentElement || document.body.parentNode || document.body).scrollLeft;
	}
	function Ye() {
		return window.pageYOffset !== void 0
			? window.pageYOffset
			: (document.documentElement || document.body.parentNode || document.body).scrollTop;
	}
	function Xe(o, n, t, e) {
		n.insertBefore(t, o === l ? e : e.nextSibling);
	}
	function Je(o, n, t) {
		o === l ? t.insertBefore(n, t.firstChild) : t.appendChild(n);
	}
	function we(o, n) {
		var t,
			e = o[l];
		if (e && (t = o[c])) for (t = t[c]; e !== t && n(e) !== !1; e = e[c]);
	}
	function be(o, n, t) {
		var e,
			r = o[l];
		if (!r || !(e = o[c])) return n;
		for (e = e[c]; r !== e; r = r[c]) n = t(n, r);
		return n;
	}
	function Bt(o, n, t) {
		E('a parent is always present', o),
			E(
				'leftward is properly set up',
				(function () {
					return n ? n[c] === t && n.parent === o : o.getEnd(l) === t;
				})()
			),
			E(
				'rightward is properly set up',
				(function () {
					return t ? t[l] === n && t.parent === o : o.getEnd(c) === n;
				})()
			);
	}
	function zt(o) {
		return o && o.prototype instanceof W;
	}
	function et(o) {
		return kt(), yt || (yt = qt(1)), yt(o);
	}
	function qt(o) {
		function n(y, w) {
			var g, v, b;
			for (g in w)
				if (w.hasOwnProperty(g)) {
					if (g === 'substituteKeyboardEvents' && e >= 3)
						throw new Error(
							[
								"As of interface version 3, the 'substituteKeyboardEvents'",
								"option is no longer supported. Use 'overrideTypedText' and",
								"'overrideKeystroke' instead."
							].join(' ')
						);
					(v = w[g]), (b = i[g]), (y[g] = b ? b(v) : v);
				}
		}
		function t(y, w) {
			function g(v, b) {
				var x, q;
				return v && v.nodeType
					? (x = m(v)) instanceof w
						? x
						: ((q = new Zt(new w.RootBlock(), v, new a(e))),
						  (q.KIND_OF_MQ = y),
						  new w(q).__mathquillify(b || {}, e))
					: null;
			}
			return E(y + ' is defined', w), (g.prototype = w.prototype), g;
		}
		var e, r, i, a, u, p, h, m;
		if (o !== 1 && o !== 2 && o !== 3)
			throw (
				'Only interface versions between ' + Ae + ' and ' + _e + ' supported. You specified: ' + o
			);
		if ((e = o) < 3) {
			if (!(r = window.jQuery))
				throw 'MathQuill interface version '.concat(
					e,
					' requires jQuery 1.5.2+ to be loaded first'
				);
			z.prototype.jQuery = r;
		}
		return (
			(i = __assign(__assign({}, st), {
				handlers: function (y) {
					return { fns: y || {}, APIClasses: h };
				}
			})),
			(a =
				e < 3
					? z
					: (function (y) {
							function w() {
								return (y !== null && y.apply(this, arguments)) || this;
							}
							return __extends(w, y), w;
					  })(z)),
			(u = (function (y) {
				function w(g) {
					var v = y.call(this) || this;
					return (
						(v.__controller = g), (v.__options = g.options), (v.id = g.id), (v.data = g.data), v
					);
				}
				return (
					__extends(w, y),
					(w.prototype.mathquillify = function (g) {
						var v,
							b = this.__controller,
							x = b.root,
							q = b.container;
						b.createTextarea(),
							(v = O(q).addClass(g).children().detach()),
							x.setDOM(
								O(f('span', { class: 'mq-root-block', 'aria-hidden': !0 }))
									.appendTo(q)
									.oneElement()
							),
							Q.linkElementByBlockNode(x.domFrag().oneElement(), x),
							this.latex(v.text()),
							(this.revert = function () {
								return (
									b.removeMouseEventListener(),
									O(q).removeClass('mq-editable-field mq-math-mode mq-text-mode').empty().append(v),
									e < 3 ? this.__options.assertJquery()(q) : q
								);
							});
					}),
					(w.prototype.setAriaLabel = function (g) {
						return this.__controller.setAriaLabel(g), this;
					}),
					(w.prototype.getAriaLabel = function () {
						return this.__controller.getAriaLabel();
					}),
					(w.prototype.config = function (g) {
						return n(this.__options, g), this;
					}),
					(w.prototype.el = function () {
						return this.__controller.container;
					}),
					(w.prototype.text = function () {
						return this.__controller.exportText();
					}),
					(w.prototype.mathspeak = function () {
						return this.__controller.exportMathSpeak();
					}),
					(w.prototype.latex = function (g) {
						if (arguments.length > 0) {
							this.__controller.renderLatexMath(g);
							var v = this.__controller.cursor;
							return this.__controller.blurred && v.hide().parent.blur(v), this;
						}
						return this.__controller.exportLatex();
					}),
					(w.prototype.selection = function () {
						return this.__controller.exportLatexSelection();
					}),
					(w.prototype.html = function () {
						return this.__controller.root
							.domFrag()
							.oneElement()
							.innerHTML.replace(/ jQuery\d+="(?:\d+|null)"/g, '')
							.replace(/ mathquill-(?:command|block)-id="?\d+"?/g, '')
							.replace(/<span class="?mq-cursor( mq-blink)?"?>.?<\/span>/i, '')
							.replace(/ mq-hasCursor|mq-hasCursor ?/, '')
							.replace(/ class=(""|(?= |>))/g, '');
					}),
					(w.prototype.reflow = function () {
						return (
							this.__controller.root.postOrder(function (g) {
								g.reflow();
							}),
							this
						);
					}),
					w
				);
			})(Wt)),
			(p = (function (y) {
				function w() {
					return (y !== null && y.apply(this, arguments)) || this;
				}
				return (
					__extends(w, y),
					(w.prototype.mathquillify = function (g) {
						return (
							y.prototype.mathquillify.call(this, g),
							(this.__controller.editable = !0),
							this.__controller.addMouseEventListener(),
							this.__controller.editablesTextareaEvents(),
							this
						);
					}),
					(w.prototype.focus = function () {
						return (
							this.__controller.getTextareaOrThrow().focus(), this.__controller.scrollHoriz(), this
						);
					}),
					(w.prototype.blur = function () {
						return this.__controller.getTextareaOrThrow().blur(), this;
					}),
					(w.prototype.write = function (g) {
						this.__controller.writeLatex(g), this.__controller.scrollHoriz();
						var v = this.__controller.cursor;
						return this.__controller.blurred && v.hide().parent.blur(v), this;
					}),
					(w.prototype.empty = function () {
						var g,
							v = this.__controller.root,
							b = this.__controller.cursor;
						return (
							v.setEnds(((g = {}), (g[l] = 0), (g[c] = 0), g)),
							v.domFrag().empty(),
							delete b.selection,
							b.insAtRightEnd(v),
							this
						);
					}),
					(w.prototype.cmd = function (g) {
						var v,
							b,
							x = this.__controller.notify(void 0),
							q = x.cursor;
						return (
							/^\\[a-z]+$/i.test(g) && !q.isTooDeep()
								? ((g = g.slice(1)),
								  (v = s[g]) &&
										((b = v.constructor ? new v(g) : v(g)),
										q.selection && b.replaces(q.replaceSelection()),
										b.createLeftOf(q.show())))
								: q.parent.write(q, g),
							x.scrollHoriz(),
							x.blurred && q.hide().parent.blur(q),
							this
						);
					}),
					(w.prototype.select = function () {
						return this.__controller.selectAll(), this;
					}),
					(w.prototype.clearSelection = function () {
						return this.__controller.cursor.clearSelection(), this;
					}),
					(w.prototype.moveToDirEnd = function (g) {
						return (
							this.__controller.notify('move').cursor.insAtDirEnd(g, this.__controller.root), this
						);
					}),
					(w.prototype.moveToLeftEnd = function () {
						return this.moveToDirEnd(l);
					}),
					(w.prototype.moveToRightEnd = function () {
						return this.moveToDirEnd(c);
					}),
					(w.prototype.keystroke = function (g, v) {
						var b,
							x = g.replace(/^\s+|\s+$/g, '').split(/\s+/);
						for (b = 0; b < x.length; b += 1) this.__controller.keystroke(x[b], v);
						return this;
					}),
					(w.prototype.typedText = function (g) {
						for (var v = 0; v < g.length; v += 1) this.__controller.typedText(g.charAt(v));
						return this;
					}),
					(w.prototype.dropEmbedded = function (g, v, b) {
						var x,
							q = g - Ze(),
							L = v - Ye(),
							A = document.elementFromPoint(q, L);
						this.__controller.seek(A, q, L),
							(x = new me().setOptions(b)),
							x.createLeftOf(this.__controller.cursor);
					}),
					(w.prototype.setAriaPostLabel = function (g, v) {
						return this.__controller.setAriaPostLabel(g, v), this;
					}),
					(w.prototype.getAriaPostLabel = function () {
						return this.__controller.getAriaPostLabel();
					}),
					(w.prototype.clickAt = function (g, v, b) {
						var x, q, L;
						return (
							(b = b || document.elementFromPoint(g, v)),
							(x = this.__controller),
							(q = x.root),
							(L = q.domFrag().oneElement()),
							L.contains(b) || (b = L),
							x.seek(b, g, v),
							x.blurred && this.focus(),
							this
						);
					}),
					(w.prototype.ignoreNextMousedown = function (g) {
						return (this.__controller.cursor.options.ignoreNextMousedown = g), this;
					}),
					w
				);
			})(u)),
			(h = { AbstractMathQuill: u, EditableField: p }),
			E('API.StaticMath defined', U.StaticMath),
			(h.StaticMath = U.StaticMath(h)),
			E('API.MathField defined', U.MathField),
			(h.MathField = U.MathField(h)),
			E('API.InnerMathField defined', U.InnerMathField),
			(h.InnerMathField = U.InnerMathField(h)),
			U.TextField && (h.TextField = U.TextField(h)),
			(m = function (y) {
				var w, g, v, b, x, q, L, A;
				if (!y || !y.nodeType) return null;
				for (g = O(y).children().toElementArray(), v = 0, b = g; v < b.length; v++)
					if (((x = b[v]), x.classList.contains('mq-root-block'))) {
						w = x;
						break;
					}
				return (
					(q = Q.getNodeOfElement(w)),
					(L = q && q.controller),
					(A = L && h[L.KIND_OF_MQ]),
					L && A ? new A(L) : null
				);
			}),
			(m.L = l),
			(m.R = c),
			(m.config = function (y) {
				return n(a.prototype, y), this;
			}),
			(m.registerEmbed = function (y, w) {
				if (!/^[a-z][a-z0-9]*$/i.test(y))
					throw 'Embed name must start with letter and be only letters and digits';
				Ut[y] = w;
			}),
			(m.StaticMath = t('StaticMath', h.StaticMath)),
			(m.MathField = t('MathField', h.MathField)),
			(m.InnerMathField = t('InnerMathField', h.InnerMathField)),
			h.TextField && (m.TextField = t('TextField', h.TextField)),
			(m.prototype = u.prototype),
			(m.EditableField = function () {
				throw "wtf don't call me, I'm 'abstract'";
			}),
			(m.EditableField.prototype = p.prototype),
			e < 3 && (m.saneKeyboardEvents = Ee),
			m
		);
	}
	function xe(o) {
		(o.moveOutOf = function (n) {
			E('controller is defined', this.controller), this.controller.handle('moveOutOf', n);
		}),
			(o.deleteOutOf = function (n) {
				E('controller is defined', this.controller), this.controller.handle('deleteOutOf', n);
			}),
			(o.selectOutOf = function (n) {
				E('controller is defined', this.controller), this.controller.handle('selectOutOf', n);
			}),
			(o.upOutOf = function () {
				E('controller is defined', this.controller), this.controller.handle('upOutOf');
			}),
			(o.downOutOf = function () {
				E('controller is defined', this.controller), this.controller.handle('downOutOf');
			}),
			(o.reflow = function () {
				E('controller is defined', this.controller),
					this.controller.handle('reflow'),
					this.controller.handle('edited'),
					this.controller.handle('edit');
			});
	}
	function tn(o, n) {
		throw ((o = o ? "'" + o + "'" : 'EOF'), 'Parse Error: ' + n + ' at ' + o);
	}
	function Ee(o, n) {
		return Gt(o[0], n);
	}
	function d(o, n, t) {
		return function () {
			return new it(o, n ? f.entityText(n) : void 0, t);
		};
	}
	function D(o, n, t, e) {
		return function () {
			return new P(o, n ? f.entityText(n) : void 0, t, e);
		};
	}
	function qe(o) {
		var n, t, e;
		if ((o.domFrag().oneElement().normalize(), (n = o.domFrag().children()), !n.isEmpty()))
			return (
				(t = n.oneText()),
				E('only node in TextBlock span is Text node', t.nodeType === 3),
				(e = new dt(t.data)),
				e.setDOM(t),
				o.children().disown(),
				e.adopt(o, 0, 0),
				e
			);
	}
	function ft(o, n, t, e) {
		return (function (r) {
			function i() {
				var a = (r !== null && r.apply(this, arguments)) || this;
				return (
					(a.ctrlSeq = o), (a.mathspeakTemplate = ['Start' + n, 'End' + n]), (a.ariaLabel = n), a
				);
			}
			return (
				__extends(i, r),
				(i.prototype.html = function () {
					var a = f(t, e, [f.text(this.textContents())]);
					return this.setDOM(a), Q.linkElementByCmdNode(a, this), a;
				}),
				i
			);
		})(Dt);
	}
	function nt(o, n, t) {
		return function () {
			return new ct(o, f.entityText(n));
		};
	}
	function Tt(o) {
		if (!o) return !1;
		var n = o[l];
		return n
			? !(n instanceof P || /^(\\ )|[,;:\(\[]$/.test(n.ctrlSeq))
			: !!(o.parent && o.parent.parent && o.parent.parent.isStyleBlock()) && Tt(o.parent.parent);
	}
	function Pt(o) {
		if (!o) return '';
		var n = '';
		return (
			o.eachChild(function (t) {
				t.ctrlSeq !== void 0 && (n += t.ctrlSeq);
			}),
			n
		);
	}
	function Ht(o) {
		var n = this.parent,
			t = o;
		do {
			if (t[c]) return o.insLeftOf(n);
			t = t.parent.parent;
		} while (t !== n);
		o.insRightOf(n);
	}
	function en(o) {
		var n = o.side,
			t = o.sides[n];
		return { ch: Et[t.ch], ctrlSeq: Et[t.ctrlSeq] };
	}
	function $t(o, n, t) {
		var e, r;
		(n = n || o),
			(e = Et[o]),
			(r = Et[n]),
			(rt[o] = function () {
				return new tt(l, o, e, n, r);
			}),
			(rt[e] = function () {
				return new tt(c, o, e, n, r);
			}),
			(mt[o] = mt[e] = t);
	}
	var Vt,
		gt,
		ke,
		Le,
		Oe,
		Se,
		Te,
		jt,
		Ce,
		Fe,
		O,
		at,
		Q,
		I,
		s,
		rt,
		Ct,
		De,
		Qt,
		lt,
		U,
		Ut,
		st,
		z,
		Wt,
		kt,
		yt,
		Ae,
		_e,
		Me,
		k,
		Ne,
		Gt,
		Ie,
		Re,
		ut,
		W,
		Be,
		G,
		ze,
		Kt,
		Lt,
		Pe,
		He,
		Zt,
		Yt,
		N,
		M,
		V,
		it,
		P,
		R,
		Ft,
		Dt,
		dt,
		Xt,
		$e,
		At,
		Ot,
		ct,
		pt,
		_t,
		Ve,
		Jt,
		te,
		vt,
		H,
		wt,
		ee,
		ne,
		bt,
		re,
		oe,
		je,
		ie,
		se,
		ae,
		xt,
		X,
		St,
		J,
		le,
		ht,
		Qe,
		Ue,
		ue,
		ce,
		pe,
		Mt,
		he,
		fe,
		tt,
		Et,
		mt,
		Nt,
		It,
		de,
		We,
		me,
		ge,
		l = -1,
		c = 1,
		nn = Math.min,
		Rt = Math.max,
		f =
			(new URLSearchParams(window.location.search),
			function (o, n, t) {
				var e, r, i, a;
				switch (o) {
					case 'svg':
					case 'path':
						e = document.createElementNS('http://www.w3.org/2000/svg', o);
						break;
					default:
						e = document.createElement(o);
				}
				for (r in n)
					(i = n[r]) !== void 0 && e.setAttribute(r, typeof i == 'string' ? i : String(i));
				if (t) for (a = 0; a < t.length; a++) e.appendChild(t[a]);
				return e;
			});
	(f.text = function (o) {
		return document.createTextNode(o);
	}),
		(f.block = function (o, n, t) {
			var e = f(o, n, [t.html()]);
			return t.setDOM(e), Q.linkElementByBlockNode(e, t), e;
		}),
		(f.entityText = function (o) {
			var n = Z(o);
			return (
				E(
					'entity parses to a single text node',
					n instanceof DocumentFragment &&
						n.childNodes.length === 1 &&
						n.childNodes[0] instanceof Text
				),
				n.childNodes[0]
			);
		}),
		(Vt = '\xA0'),
		(gt = '\u200B'),
		(ke = '\u02D9'),
		(Le = '\u2211'),
		(Oe = '\u220F'),
		(Se = '\u2210'),
		(Te = '\u222B'),
		(jt = (function () {
			var o, n;
			return (
				typeof requestAnimationFrame == 'function' && typeof cancelAnimationFrame == 'function'
					? ((o = requestAnimationFrame), (n = cancelAnimationFrame))
					: ((o = function (t) {
							return setTimeout(t, 13);
					  }),
					  (n = clearTimeout)),
				function (t, e) {
					function r() {
						var m = (Date.now() - p) / t;
						m <= h ? a() : (h = m), e(h, a, i);
					}
					function i() {
						u !== void 0 && n(u), (u = void 0);
					}
					function a() {
						i(), (u = o(r));
					}
					var u,
						p = Date.now(),
						h = 0;
					e(t <= 0 ? 1 : 0, a, i);
				}
			);
		})()),
		(Ce = (function () {
			function o(n) {
				(this.span = f('span', {
					class: 'mq-aria-alert',
					'aria-live': 'assertive',
					'aria-atomic': 'true'
				})),
					(this.msg = ''),
					(this.items = []),
					(this.controller = n);
			}
			return (
				(o.prototype.attach = function () {
					var n = this.controller.container;
					this.span.parentNode !== n && O(n).prepend(O(this.span));
				}),
				(o.prototype.queue = function (n, t) {
					var e, r;
					return (
						t === void 0 && (t = !1),
						(e = ''),
						n instanceof W
							? ((r = n.mathspeak({ ignoreShorthand: !0 })),
							  t &&
									(n.parent && n.parent.ariaLabel && n.ariaLabel === 'block'
										? (e = n.parent.ariaLabel + ' ' + r)
										: n.ariaLabel && (e = n.ariaLabel + ' ' + r)),
							  e === '' && (e = r))
							: (e = n || ''),
						this.items.push(e),
						this
					);
				}),
				(o.prototype.queueDirOf = function (n) {
					return F(n), this.queue(n === l ? 'before' : 'after');
				}),
				(o.prototype.queueDirEndOf = function (n) {
					return F(n), this.queue(n === l ? 'beginning of' : 'end of');
				}),
				(o.prototype.alert = function (n) {
					return (
						this.attach(),
						n && this.queue(n),
						this.items.length &&
							((this.msg = this.items
								.join(' ')
								.replace(/ +(?= )/g, '')
								.trim()),
							this.controller.containerHasFocus() && (this.span.textContent = this.msg)),
						this.clear()
					);
				}),
				(o.prototype.clear = function () {
					return (this.items.length = 0), this;
				}),
				o
			);
		})()),
		(Fe = (function () {
			function o(n, t) {
				var e;
				arguments.length === 1 && (t = n),
					n && t && (this.ends = ((e = {}), (e[l] = n), (e[c] = t), e));
			}
			return (
				(o.create = function (n, t) {
					arguments.length === 1 && (t = n), E('No half-empty DOMFragments', !!n == !!t);
					var e = new o(n, t);
					return E('last is a forward sibling of first', e.isValid()), e;
				}),
				(o.prototype.isEmpty = function () {
					return this.ends === void 0;
				}),
				(o.prototype.isOneNode = function () {
					return !(!this.ends || this.ends[l] !== this.ends[c]);
				}),
				(o.prototype.isValid = function () {
					if (!this.ends || this.ends[l] === this.ends[c]) return !0;
					var n;
					return (
						this.eachNode(function (t) {
							return (n = t);
						}),
						n === this.ends[c]
					);
				}),
				(o.prototype.firstNode = function () {
					return E('Fragment is not empty', this.ends), this.ends[l];
				}),
				(o.prototype.lastNode = function () {
					return E('Fragment is not empty', this.ends), this.ends[c];
				}),
				(o.prototype.children = function () {
					var n = this.oneNode(),
						t = n.firstChild,
						e = n.lastChild;
					return t && e ? new o(t, e) : new o();
				}),
				(o.prototype.join = function (n) {
					var t, e;
					if (!this.ends) return n;
					if (!n.ends) return this;
					for (t = !1, e = this.ends[c].nextSibling; e; ) {
						if (e === n.ends[l]) {
							t = !0;
							break;
						}
						e = e.nextSibling;
					}
					return (
						E('sibling must be a forward DOM sibling of this fragment', t),
						new o(this.ends[l], n.ends[c])
					);
				}),
				(o.prototype.oneNode = function () {
					return (
						E('Fragment has a single node', this.ends && this.ends[l] === this.ends[c]),
						this.ends[l]
					);
				}),
				(o.prototype.oneElement = function () {
					var n = this.oneNode();
					return E('Node is an Element', n.nodeType === Node.ELEMENT_NODE), n;
				}),
				(o.prototype.oneText = function () {
					var n = this.oneNode();
					return E('Node is Text', n.nodeType === Node.TEXT_NODE), n;
				}),
				(o.prototype.eachNode = function (n) {
					var t, e, r;
					if (!this.ends) return this;
					for (
						t = this.ends[c], e = this.ends[l], r = void 0;
						e && ((r = e.nextSibling), n(e), e !== t);
						e = r
					);
					return this;
				}),
				(o.prototype.eachElement = function (n) {
					return (
						this.eachNode(function (t) {
							t.nodeType === Node.ELEMENT_NODE && n(t);
						}),
						this
					);
				}),
				(o.prototype.text = function () {
					var n = '';
					return (
						this.eachNode(function (t) {
							n += t.textContent || '';
						}),
						n
					);
				}),
				(o.prototype.toNodeArray = function () {
					var n = [];
					return (
						this.eachNode(function (t) {
							return n.push(t);
						}),
						n
					);
				}),
				(o.prototype.toElementArray = function () {
					var n = [];
					return (
						this.eachElement(function (t) {
							return n.push(t);
						}),
						n
					);
				}),
				(o.prototype.toDocumentFragment = function () {
					var n = document.createDocumentFragment();
					return (
						this.eachNode(function (t) {
							return n.appendChild(t);
						}),
						n
					);
				}),
				(o.prototype.insertBefore = function (n) {
					return this.insDirOf(l, n);
				}),
				(o.prototype.insertAfter = function (n) {
					return this.insDirOf(c, n);
				}),
				(o.prototype.append = function (n) {
					return n.appendTo(this.oneElement()), this;
				}),
				(o.prototype.prepend = function (n) {
					return n.prependTo(this.oneElement()), this;
				}),
				(o.prototype.appendTo = function (n) {
					return this.insAtDirEnd(c, n);
				}),
				(o.prototype.prependTo = function (n) {
					return this.insAtDirEnd(l, n);
				}),
				(o.prototype.parent = function () {
					if (!this.ends) return this;
					var n = this.ends[l].parentNode;
					return n ? new o(n) : new o();
				}),
				(o.prototype.wrapAll = function (n) {
					var t, e;
					return (
						(n.textContent = ''),
						this.ends
							? ((t = this.ends[l].parentNode),
							  (e = this.ends[c].nextSibling),
							  this.appendTo(n),
							  t && t.insertBefore(n, e),
							  this)
							: this
					);
				}),
				(o.prototype.replaceWith = function (n) {
					var t,
						e,
						r = (t = this.ends) === null || t === void 0 ? void 0 : t[c],
						i = r?.parentNode,
						a = r?.nextSibling;
					return (
						this.detach(),
						(e = n.toDocumentFragment()),
						r && i ? (i.insertBefore(e, a || null), this) : this
					);
				}),
				(o.prototype.nthElement = function (n) {
					if (this.ends && !(n < 0 || n !== Math.floor(n)))
						for (var t = this.ends[l]; t; ) {
							if (t.nodeType === Node.ELEMENT_NODE) {
								if (n <= 0) return t;
								n -= 1;
							}
							if (t === this.ends[c]) return;
							t = t.nextSibling;
						}
				}),
				(o.prototype.firstElement = function () {
					return this.nthElement(0);
				}),
				(o.prototype.lastElement = function () {
					if (this.ends)
						for (var n = this.ends[c]; n; ) {
							if (n.nodeType === Node.ELEMENT_NODE) return n;
							if (n === this.ends[l]) return;
							n = n.previousSibling;
						}
				}),
				(o.prototype.first = function () {
					return new o(this.firstElement());
				}),
				(o.prototype.last = function () {
					return new o(this.lastElement());
				}),
				(o.prototype.eq = function (n) {
					return new o(this.nthElement(n));
				}),
				(o.prototype.slice = function (n) {
					if (!this.ends) return this;
					var t = this.nthElement(n);
					return t ? new o(t, this.ends[c]) : new o();
				}),
				(o.prototype.next = function () {
					for (var n = this.oneNode(); n; )
						if ((n = n.nextSibling) && n.nodeType === Node.ELEMENT_NODE) return new o(n);
					return new o();
				}),
				(o.prototype.prev = function () {
					for (var n = this.oneNode(); n; )
						if ((n = n.previousSibling) && n.nodeType === Node.ELEMENT_NODE) return new o(n);
					return new o();
				}),
				(o.prototype.empty = function () {
					return (
						this.eachElement(function (n) {
							n.textContent = '';
						}),
						this
					);
				}),
				(o.prototype.remove = function () {
					return this.toDocumentFragment(), this;
				}),
				(o.prototype.detach = function () {
					return this.remove();
				}),
				(o.prototype.insDirOf = function (n, t) {
					var e, r;
					return this.ends
						? (r = (e = t.ends) === null || e === void 0 ? void 0 : e[n]) && r.parentNode
							? (Xe(n, r.parentNode, this.toDocumentFragment(), r), this)
							: this.detach()
						: this;
				}),
				(o.prototype.insAtDirEnd = function (n, t) {
					return this.ends ? (Je(n, this.toDocumentFragment(), t), this) : this;
				}),
				(o.prototype.hasClass = function (n) {
					var t = !1;
					return (
						this.eachElement(function (e) {
							e.classList.contains(n) && (t = !0);
						}),
						t
					);
				}),
				(o.prototype.addClass = function (n) {
					var t,
						e,
						r,
						i = function (u) {
							if (!u) return 'continue';
							a.eachElement(function (p) {
								p.classList.add(u);
							});
						},
						a = this;
					for (t = 0, e = n.split(/\s+/); t < e.length; t++) (r = e[t]), i(r);
					return this;
				}),
				(o.prototype.removeClass = function (n) {
					var t,
						e,
						r,
						i = function (u) {
							if (!u) return 'continue';
							a.eachElement(function (p) {
								p.classList.remove(u);
							});
						},
						a = this;
					for (t = 0, e = n.split(/\s+/); t < e.length; t++) (r = e[t]), i(r);
					return this;
				}),
				(o.prototype.toggleClass = function (n, t) {
					var e, r, i, a, u;
					if (t === !0) return this.addClass(n);
					if (t === !1) return this.removeClass(n);
					for (
						e = function (p) {
							if (!p) return 'continue';
							r.eachElement(function (h) {
								h.classList.toggle(p);
							});
						},
							r = this,
							i = 0,
							a = n.split(/\s+/);
						i < a.length;
						i++
					)
						(u = a[i]), e(u);
					return this;
				}),
				o
			);
		})()),
		(O = Fe.create),
		(at = (function () {
			function o(n, t, e) {
				this.init(n, t, e);
			}
			return (
				(o.prototype.init = function (n, t, e) {
					(this.parent = n), (this[l] = t), (this[c] = e);
				}),
				(o.copy = function (n) {
					return new o(n.parent, n[l], n[c]);
				}),
				o
			);
		})()),
		(Q = (function () {
			function o() {
				var e;
				(this[n] = 0),
					(this[t] = 0),
					(this.parent = 0),
					(this.ends = ((e = {}), (e[l] = 0), (e[c] = 0), e)),
					(this.id = o.uniqueNodeId());
			}
			(o.uniqueNodeId = function () {
				return (o.idCounter += 1);
			}),
				(o.getNodeOfElement = function (e) {
					if (e) {
						if (!e.nodeType) throw new Error('must pass an Element to NodeBase.getNodeOfElement');
						var r = e;
						return r.mqBlockNode || r.mqCmdNode;
					}
				}),
				(o.linkElementByBlockNode = function (e, r) {
					e.mqBlockNode = r;
				}),
				(o.linkElementByCmdNode = function (e, r) {
					e.mqCmdNode = r;
				}),
				(o.prototype.setEnds = function (e) {
					(this.ends = e), E('No half-empty node ends', !!this.ends[l] == !!this.ends[c]);
				}),
				(o.prototype.getEnd = function (e) {
					return this.ends[e];
				}),
				(o.prototype.toString = function () {
					return '{{ MathQuill Node #' + this.id + ' }}';
				}),
				(o.prototype.setDOM = function (e) {
					return (
						e &&
							E(
								'DOM is an element or a text node',
								e.nodeType === Node.ELEMENT_NODE || e.nodeType === Node.TEXT_NODE
							),
						(this._el = e),
						this
					);
				}),
				(o.prototype.domFrag = function () {
					return O(this._el);
				}),
				(o.prototype.createDir = function (e, r) {
					F(e);
					var i = this;
					return (
						i.html(),
						i.domFrag().insDirOf(e, r.domFrag()),
						(r[e] = i.adopt(r.parent, r[l], r[c])),
						i
					);
				}),
				(o.prototype.createLeftOf = function (e) {
					this.createDir(l, e);
				}),
				(o.prototype.selectChildren = function (e, r) {
					return new Qt(e, r);
				}),
				(o.prototype.bubble = function (e) {
					var r,
						i = this.getSelfNode();
					for (r = i; r && e(r) !== !1; r = r.parent);
					return this;
				}),
				(o.prototype.postOrder = function (e) {
					var r = this.getSelfNode();
					return (
						(function i(a) {
							return !!a && (a.eachChild(i), e(a), !0);
						})(r),
						r
					);
				}),
				(o.prototype.isEmpty = function () {
					return this.ends[l] === 0 && this.ends[c] === 0;
				}),
				(o.prototype.isQuietEmptyDelimiter = function (e) {
					if (!this.isEmpty() || !e || !this.parent || this.parent.ctrlSeq === void 0) return !1;
					var r = this.parent.ctrlSeq.replace(/^\\(left|right)?/, '');
					return e.hasOwnProperty(r);
				}),
				(o.prototype.isStyleBlock = function () {
					return !1;
				}),
				(o.prototype.isTextBlock = function () {
					return !1;
				}),
				(o.prototype.children = function () {
					return new I(this.getEnd(l), this.getEnd(c));
				}),
				(o.prototype.eachChild = function (e) {
					return we(this.ends, e), this;
				}),
				(o.prototype.foldChildren = function (e, r) {
					return be(this.ends, e, r);
				}),
				(o.prototype.withDirAdopt = function (e, r, i, a) {
					var u = this.getSelfNode();
					return new I(u, u).withDirAdopt(e, r, i, a), this;
				}),
				(o.prototype.adopt = function (e, r, i) {
					var a = this.getSelfNode();
					return new I(a, a).adopt(e, r, i), this.getSelfNode();
				}),
				(o.prototype.disown = function () {
					var e = this.getSelfNode();
					return new I(e, e).disown(), this;
				}),
				(o.prototype.remove = function () {
					return this.domFrag().remove(), this.disown();
				}),
				(o.prototype.shouldIgnoreSubstitutionInSimpleSubscript = function (e) {
					return (
						!!e.disableAutoSubstitutionInSubscripts &&
						!!this.parent &&
						this.parent.parent instanceof J &&
						!!this.parent.domFrag().hasClass('mq-sub')
					);
				}),
				(o.prototype.getSelfNode = function () {
					return this;
				}),
				(o.prototype.parser = function () {
					E('Abstract parser() method is never called', !1);
				}),
				(o.prototype.html = function () {
					throw new Error('html() unimplemented in NodeBase');
				}),
				(o.prototype.text = function () {
					return '';
				}),
				(o.prototype.latex = function () {
					var e = { latex: '', startIndex: -1, endIndex: -1 };
					return this.latexRecursive(e), e.latex;
				}),
				(o.prototype.latexRecursive = function (e) {}),
				(o.prototype.checkCursorContextOpen = function (e) {
					e.startSelectionBefore === this && (e.startIndex = e.latex.length),
						e.endSelectionBefore === this && (e.endIndex = e.latex.length);
				}),
				(o.prototype.checkCursorContextClose = function (e) {
					e.startSelectionAfter === this && (e.startIndex = e.latex.length),
						e.endSelectionAfter === this && (e.endIndex = e.latex.length);
				}),
				(o.prototype.finalizeTree = function (e, r) {}),
				(o.prototype.contactWeld = function (e, r) {}),
				(o.prototype.blur = function (e) {}),
				(o.prototype.focus = function () {}),
				(o.prototype.intentionalBlur = function () {}),
				(o.prototype.reflow = function () {}),
				(o.prototype.registerInnerField = function (e, r) {}),
				(o.prototype.chToCmd = function (e, r) {
					E('Abstract chToCmd() method is never called', !1);
				}),
				(o.prototype.mathspeak = function (e) {
					return '';
				}),
				(o.prototype.seek = function (e, r) {}),
				(o.prototype.siblingDeleted = function (e, r) {}),
				(o.prototype.siblingCreated = function (e, r) {}),
				(o.prototype.finalizeInsert = function (e, r) {}),
				(o.prototype.fixDigitGrouping = function (e) {}),
				(o.prototype.writeLatex = function (e, r) {}),
				(o.prototype.write = function (e, r) {});
			var n, t;
			return (n = l), (t = c), (o.idCounter = 0), o;
		})()),
		(I = (function () {
			function o(n, t, e) {
				var r, i, a, u;
				if (
					((this.disowned = !1),
					e === void 0 && (e = l),
					F(e),
					E('no half-empty fragments', !n == !t),
					!n || !t)
				)
					return void this.setEnds(((r = {}), (r[l] = 0), (r[c] = 0), r));
				E('withDir is passed to Fragment', n instanceof W),
					E('oppDir is passed to Fragment', t instanceof W),
					E('withDir and oppDir have the same parent', n.parent === t.parent),
					(i = {}),
					(i[e] = n),
					(i[-e] = t),
					(a = i),
					this.setEnds(a),
					(u = 0),
					this.each(function (p) {
						u = p;
					}),
					E('following direction siblings from start reaches end', u === a[c]);
			}
			return (
				(o.prototype.getDOMFragFromEnds = function () {
					var n = this.ends[l],
						t = this.ends[c];
					return n === 0 || t === 0 ? O() : n === t ? n.domFrag() : n.domFrag().join(t.domFrag());
				}),
				(o.prototype.setEnds = function (n) {
					this.ends = n;
				}),
				(o.prototype.getEnd = function (n) {
					return this.ends ? this.ends[n] : 0;
				}),
				(o.prototype.domFrag = function () {
					return this.getDOMFragFromEnds();
				}),
				(o.prototype.withDirAdopt = function (n, t, e, r) {
					return n === l ? this.adopt(t, e, r) : this.adopt(t, r, e);
				}),
				(o.prototype.adopt = function (n, t, e) {
					var r, i, a, u, p;
					return (
						Bt(n, t, e),
						(i = this),
						(this.disowned = !1),
						(a = i.ends[l]) && (u = i.ends[c])
							? ((r = {}),
							  (r[l] = n.getEnd(l)),
							  (r[c] = n.getEnd(c)),
							  (p = r),
							  t || (p[l] = a),
							  e ? (e[l] = u) : (p[c] = u),
							  n.setEnds(p),
							  (u[c] = e),
							  i.each(function (h) {
									return (h[l] = t), (h.parent = n), t && (t[c] = h), (t = h), !0;
							  }),
							  i)
							: this
					);
				}),
				(o.prototype.disown = function () {
					var n,
						t,
						e,
						r,
						i,
						a,
						u = this,
						p = u.ends[l];
					return !p || u.disowned
						? u
						: ((this.disowned = !0),
						  (t = u.ends[c]) &&
								((e = p.parent),
								Bt(e, p[l], p),
								Bt(e, t, t[c]),
								(n = {}),
								(n[l] = e.getEnd(l)),
								(n[c] = e.getEnd(c)),
								(r = n),
								p[l] ? ((i = p[l]), (i[c] = t[c])) : (r[l] = t[c]),
								t[c] ? ((a = t[c]), (a[l] = p[l])) : (r[c] = p[l]),
								r[l] && r[c] ? e.setEnds(r) : (e.ends = r)),
						  u);
				}),
				(o.prototype.remove = function () {
					return this.domFrag().remove(), this.disown();
				}),
				(o.prototype.each = function (n) {
					return we(this.ends, n), this;
				}),
				(o.prototype.fold = function (n, t) {
					return be(this.ends, n, t);
				}),
				o
			);
		})()),
		(s = {}),
		(rt = {}),
		(Ct = (function (o) {
			function n(t, e, r) {
				var i = o.call(this, t, e, r) || this;
				return (i.ancestors = {}), i;
			}
			return (
				__extends(n, o),
				(n.fromCursor = function (t) {
					return new n(t.parent, t[l], t[c]);
				}),
				n
			);
		})(at)),
		(De = (function (o) {
			function n(t, e, r) {
				var i = o.call(this, t, 0, 0) || this;
				return (
					(i.upDownCache = {}),
					(i.cursorElement = f('span', { class: 'mq-cursor' }, [f.text(gt)])),
					(i._domFrag = O()),
					(i.controller = r),
					(i.options = e),
					i.setDOMFrag(O(i.cursorElement)),
					(i.blink = function () {
						O(i.cursorElement).toggleClass('mq-blink');
					}),
					i
				);
			}
			return (
				__extends(n, o),
				(n.prototype.setDOMFrag = function (t) {
					return (this._domFrag = t), this;
				}),
				(n.prototype.domFrag = function () {
					return this._domFrag;
				}),
				(n.prototype.show = function () {
					var t, e;
					return (
						O(this.cursorElement).removeClass('mq-blink'),
						this.setDOMFrag(O(this.cursorElement)),
						this.intervalId
							? clearInterval(this.intervalId)
							: ((t = this[c]),
							  t
									? ((e = this.selection),
									  e && e.getEnd(l)[l] === this[l]
											? this.domFrag().insertBefore(e.domFrag())
											: this.domFrag().insertBefore(t.domFrag()))
									: this.domFrag().appendTo(this.parent.domFrag().oneElement()),
							  this.parent.focus()),
						(this.intervalId = setInterval(this.blink, 500)),
						this
					);
				}),
				(n.prototype.hide = function () {
					return (
						this.intervalId && clearInterval(this.intervalId),
						(this.intervalId = 0),
						this.domFrag().detach(),
						this.setDOMFrag(O()),
						this
					);
				}),
				(n.prototype.withDirInsertAt = function (t, e, r, i) {
					var a = this.parent;
					(this.parent = e), (this[t] = r), (this[-t] = i), a !== e && a.blur && a.blur(this);
				}),
				(n.prototype.insDirOf = function (t, e) {
					return (
						F(t),
						this.domFrag().insDirOf(t, e.domFrag()),
						this.withDirInsertAt(t, e.parent, e[t], e),
						this.parent.domFrag().addClass('mq-hasCursor'),
						this
					);
				}),
				(n.prototype.insLeftOf = function (t) {
					return this.insDirOf(l, t);
				}),
				(n.prototype.insRightOf = function (t) {
					return this.insDirOf(c, t);
				}),
				(n.prototype.insAtDirEnd = function (t, e) {
					return (
						F(t),
						this.domFrag().insAtDirEnd(t, e.domFrag().oneElement()),
						this.withDirInsertAt(t, e, 0, e.getEnd(t)),
						e.focus(),
						this
					);
				}),
				(n.prototype.insAtLeftEnd = function (t) {
					return this.insAtDirEnd(l, t);
				}),
				(n.prototype.insAtRightEnd = function (t) {
					return this.insAtDirEnd(c, t);
				}),
				(n.prototype.jumpUpDown = function (t, e) {
					var r,
						i,
						a,
						u = this;
					(u.upDownCache[t.id] = at.copy(u)),
						(r = u.upDownCache[e.id]),
						r
							? ((i = r[c]), i ? u.insLeftOf(i) : u.insAtRightEnd(r.parent))
							: ((a = u.getBoundingClientRectWithoutMargin().left), e.seek(a, u)),
						u.controller.aria.queue(e, !0);
				}),
				(n.prototype.getBoundingClientRectWithoutMargin = function () {
					var t,
						e,
						r,
						i = this.domFrag();
					return (
						i.removeClass('mq-cursor'),
						(t = $(i.oneElement())),
						(e = t.left),
						(r = t.right),
						i.addClass('mq-cursor'),
						{ left: e, right: r }
					);
				}),
				(n.prototype.unwrapGramp = function () {
					var t,
						e,
						r,
						i,
						a,
						u = this.parent.parent,
						p = u.parent,
						h = u[c],
						m = this,
						y = u[l];
					if (
						(u.disown().eachChild(function (w) {
							return (
								!!w.isEmpty() ||
								(w
									.children()
									.adopt(p, y, h)
									.each(function (g) {
										return g.domFrag().insertBefore(u.domFrag()), !0;
									}),
								(y = w.getEnd(c)),
								!0)
							);
						}),
						!this[c])
					)
						if ((t = this[l])) this[c] = t[c];
						else
							for (; !this[c]; ) {
								if (!(e = this.parent[c])) {
									(this[c] = u[c]), (this.parent = p);
									break;
								}
								(this.parent = e), (this[c] = e.getEnd(l));
							}
					(r = this[c]),
						r ? this.insLeftOf(r) : this.insAtRightEnd(p),
						u.domFrag().remove(),
						(i = u[l]),
						(a = u[c]),
						i && i.siblingDeleted(m.options, c),
						a && a.siblingDeleted(m.options, l);
				}),
				(n.prototype.startSelection = function () {
					var t,
						e = (this.anticursor = Ct.fromCursor(this)),
						r = e.ancestors;
					for (t = e; t.parent; t = t.parent) r[t.parent.id] = t;
				}),
				(n.prototype.endSelection = function () {
					delete this.anticursor;
				}),
				(n.prototype.select = function () {
					var t,
						e,
						r,
						i,
						a,
						u,
						p,
						h,
						m,
						y = this.anticursor;
					if (this[l] === y[l] && this.parent === y.parent) return !1;
					for (e = this; e.parent; e = e.parent)
						if (e.parent.id in y.ancestors) {
							t = e.parent;
							break;
						}
					if (
						(E('cursor and anticursor in the same tree', t),
						(r = t),
						(i = y.ancestors[r.id]),
						(p = c),
						e[l] !== i)
					) {
						for (h = e; h; h = h[c])
							if (h[c] === i[c]) {
								(p = l), (a = e), (u = i);
								break;
							}
					}
					return (
						p === c && ((a = i), (u = e)),
						a instanceof at && (a = a[c]),
						u instanceof at && (u = u[l]),
						(this.hide().selection = r.selectChildren(a, u)),
						(m = this.selection.getEnd(p)),
						this.insDirOf(p, m),
						this.selectionChanged(),
						!0
					);
				}),
				(n.prototype.resetToEnd = function (t) {
					this.clearSelection();
					var e = t.root;
					(this[c] = 0), (this[l] = e.getEnd(c)), (this.parent = e);
				}),
				(n.prototype.clearSelection = function () {
					return (
						this.selection &&
							(this.selection.clear(), delete this.selection, this.selectionChanged()),
						this
					);
				}),
				(n.prototype.deleteSelection = function () {
					var t = this.selection;
					t &&
						((this[l] = t.getEnd(l)[l]),
						(this[c] = t.getEnd(c)[c]),
						t.remove(),
						this.selectionChanged(),
						delete this.selection);
				}),
				(n.prototype.replaceSelection = function () {
					var t = this.selection;
					return (
						t && ((this[l] = t.getEnd(l)[l]), (this[c] = t.getEnd(c)[c]), delete this.selection), t
					);
				}),
				(n.prototype.depth = function () {
					for (var t = this, e = 0; (t = t.parent); ) e += t instanceof R ? 1 : 0;
					return e;
				}),
				(n.prototype.isTooDeep = function (t) {
					return (
						this.options.maxDepth !== void 0 && this.depth() + (t || 0) > this.options.maxDepth
					);
				}),
				(n.prototype.selectionChanged = function () {}),
				n
			);
		})(at)),
		(Qt = (function (o) {
			function n(t, e, r) {
				var i = o.call(this, t, e, r) || this;
				return (
					(i._el = f('span', { class: 'mq-selection' })), i.getDOMFragFromEnds().wrapAll(i._el), i
				);
			}
			return (
				__extends(n, o),
				(n.prototype.isCleared = function () {
					return this._el === void 0;
				}),
				(n.prototype.domFrag = function () {
					return this.isCleared() ? this.getDOMFragFromEnds() : O(this._el);
				}),
				(n.prototype.setEnds = function (t) {
					E('Selection ends are never empty', t[l] && t[c]), (this.ends = t);
				}),
				(n.prototype.getEnd = function (t) {
					return this.ends[t];
				}),
				(n.prototype.adopt = function (t, e, r) {
					return this.clear(), o.prototype.adopt.call(this, t, e, r);
				}),
				(n.prototype.clear = function () {
					var t = this.getDOMFragFromEnds();
					return this.domFrag().replaceWith(t), (this._el = void 0), this;
				}),
				(n.prototype.join = function (t, e) {
					return (
						e === void 0 && (e = ''),
						this.fold('', function (r, i) {
							return r + e + i[t]();
						})
					);
				}),
				n
			);
		})(I)),
		(lt = (function () {
			function o(n, t, e) {
				(this.textareaEventListeners = {}),
					(this.id = n.id),
					(this.data = {}),
					(this.root = n),
					(this.container = t),
					(this.options = e),
					(this.aria = new Ce(this.getControllerSelf())),
					(this.ariaLabel = 'Math Input'),
					(this.ariaPostLabel = ''),
					(n.controller = this.getControllerSelf()),
					(this.cursor = n.cursor = new De(n, e, this.getControllerSelf()));
			}
			return (
				(o.prototype.getControllerSelf = function () {
					return this;
				}),
				(o.prototype.handle = function (n, t) {
					var e,
						r,
						i,
						a = this.options.handlers,
						u = (e = this.options.handlers) === null || e === void 0 ? void 0 : e.fns[n];
					u &&
						((r = a?.APIClasses[this.KIND_OF_MQ]),
						E('APIClass is defined', r),
						(i = new r(this)),
						t === l || t === c ? u(t, i) : u(i));
				}),
				(o.onNotify = function (n) {
					o.notifyees.push(n);
				}),
				(o.prototype.notify = function (n) {
					for (var t = 0; t < o.notifyees.length; t += 1) o.notifyees[t](this.cursor, n);
					return this;
				}),
				(o.prototype.setAriaLabel = function (n) {
					var t = this.getAriaLabel();
					return (
						n && typeof n == 'string' && n !== ''
							? (this.ariaLabel = n)
							: this.editable
							? (this.ariaLabel = 'Math Input')
							: (this.ariaLabel = ''),
						this.ariaLabel === t || this.containerHasFocus() || this.updateMathspeak(),
						this
					);
				}),
				(o.prototype.getAriaLabel = function () {
					return this.ariaLabel !== 'Math Input'
						? this.ariaLabel
						: this.editable
						? 'Math Input'
						: '';
				}),
				(o.prototype.setAriaPostLabel = function (n, t) {
					var e = this;
					return (
						n && typeof n == 'string' && n !== ''
							? (n !== this.ariaPostLabel &&
									typeof t == 'number' &&
									(this._ariaAlertTimeout && clearTimeout(this._ariaAlertTimeout),
									(this._ariaAlertTimeout = setTimeout(function () {
										e.containerHasFocus()
											? e.aria.alert(e.root.mathspeak().trim() + ' ' + n.trim())
											: e.updateMathspeak();
									}, t))),
							  (this.ariaPostLabel = n))
							: (this._ariaAlertTimeout && clearTimeout(this._ariaAlertTimeout),
							  (this.ariaPostLabel = '')),
						this
					);
				}),
				(o.prototype.getAriaPostLabel = function () {
					return this.ariaPostLabel || '';
				}),
				(o.prototype.containerHasFocus = function () {
					return document.activeElement && this.container.contains(document.activeElement);
				}),
				(o.prototype.getTextareaOrThrow = function () {
					var n = this.textarea;
					if (!n) throw new Error('expected a textarea');
					return n;
				}),
				(o.prototype.getTextareaSpanOrThrow = function () {
					var n = this.textareaSpan;
					if (!n) throw new Error('expected a textareaSpan');
					return n;
				}),
				(o.prototype.addTextareaEventListeners = function (n) {
					var t, e;
					if (this.textarea)
						for (t in n)
							(e = t), this.removeTextareaEventListener(e), this.textarea.addEventListener(e, n[e]);
				}),
				(o.prototype.removeTextareaEventListener = function (n) {
					if (this.textarea) {
						var t = this.textareaEventListeners[n];
						t && this.textarea.removeEventListener(n, t);
					}
				}),
				(o.prototype.exportMathSpeak = function () {
					return this.root.mathspeak();
				}),
				(o.prototype.updateMathspeak = function () {}),
				(o.prototype.scrollHoriz = function () {}),
				(o.prototype.selectionChanged = function () {}),
				(o.prototype.setOverflowClasses = function () {}),
				(o.notifyees = []),
				o
			);
		})()),
		(U = {}),
		(Ut = {}),
		(st = {}),
		(z = (function () {
			function o(n) {
				this.version = n;
			}
			return (
				(o.prototype.assertJquery = function () {
					return (
						E('Interface versions > 2 do not depend on JQuery', this.version <= 2),
						E('JQuery is set for interface v < 3', this.jQuery),
						this.jQuery
					);
				}),
				o
			);
		})()),
		(Wt = (function () {
			function o() {}
			return o;
		})()),
		(kt = function () {
			window.console &&
				console.warn(`You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`);
		}),
		(et.prototype = Wt.prototype),
		(et.VERSION = 'v0.10.1'),
		(et.interfaceVersion = function (o) {
			if (o !== 1) throw 'Only interface version 1 supported. You specified: ' + o;
			return (
				(kt = function () {
					window.console &&
						console.warn(`You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`);
				}),
				kt(),
				et
			);
		}),
		(et.getInterface = qt),
		(Ae = qt.MIN = 1),
		(_e = qt.MAX = 3),
		(et.noConflict = function () {
			return (window.MathQuill = Me), et;
		}),
		(Me = window.MathQuill),
		(window.MathQuill = et),
		(k = (function () {
			function o(n) {
				this._ = n;
			}
			return (
				(o.prototype.parse = function (n) {
					function t(e, r) {
						return r;
					}
					return this.skip(o.eof)._('' + n, t, tn);
				}),
				(o.prototype.or = function (n) {
					E('or is passed a parser', n instanceof o);
					var t = this;
					return new o(function (e, r, i) {
						function a(u) {
							return n._(e, r, i);
						}
						return t._(e, r, a);
					});
				}),
				(o.prototype.then = function (n) {
					var t = this;
					return new o(function (e, r, i) {
						function a(u, p) {
							var h = n instanceof o ? n : n(p);
							return E('a parser is returned', h instanceof o), h._(u, r, i);
						}
						return t._(e, a, i);
					});
				}),
				(o.prototype.many = function () {
					var n = this;
					return new o(function (t, e, r) {
						function i(p, h) {
							return (t = p), u.push(h), !0;
						}
						function a() {
							return !1;
						}
						for (var u = []; n._(t, i, a); );
						return e(t, u);
					});
				}),
				(o.prototype.times = function (n, t) {
					arguments.length < 2 && (t = n);
					var e = this;
					return new o(function (r, i, a) {
						function u(v, b) {
							return w.push(b), (r = v), !0;
						}
						function p(v, b) {
							return (m = b), (r = v), !1;
						}
						function h(v, b) {
							return !1;
						}
						var m,
							y,
							w = [],
							g = !0;
						for (y = 0; y < n; y += 1) if (!(g = !!e._(r, u, p))) return a(r, m);
						for (; y < t && g; y += 1) e._(r, u, h);
						return i(r, w);
					});
				}),
				(o.prototype.result = function (n) {
					return this.then(o.succeed(n));
				}),
				(o.prototype.atMost = function (n) {
					return this.times(0, n);
				}),
				(o.prototype.atLeast = function (n) {
					var t = this;
					return t.times(n).then(function (e) {
						return t.many().map(function (r) {
							return e.concat(r);
						});
					});
				}),
				(o.prototype.map = function (n) {
					return this.then(function (t) {
						return o.succeed(n(t));
					});
				}),
				(o.prototype.skip = function (n) {
					return this.then(function (t) {
						return n.result(t);
					});
				}),
				(o.string = function (n) {
					var t = n.length,
						e = "expected '" + n + "'";
					return new o(function (r, i, a) {
						var u = r.slice(0, t);
						return u === n ? i(r.slice(t), u) : a(r, e);
					});
				}),
				(o.regex = function (n) {
					E('regexp parser is anchored', n.toString().charAt(1) === '^');
					var t = 'expected ' + n;
					return new o(function (e, r, i) {
						var a,
							u = n.exec(e);
						return u ? ((a = u[0]), r(e.slice(a.length), a)) : i(e, t);
					});
				}),
				(o.succeed = function (n) {
					return new o(function (t, e) {
						return e(t, n);
					});
				}),
				(o.fail = function (n) {
					return new o(function (t, e, r) {
						return r(t, n);
					});
				}),
				(o.letter = o.regex(/^[a-z]/i)),
				(o.letters = o.regex(/^[a-z]*/i)),
				(o.digit = o.regex(/^[0-9]/)),
				(o.digits = o.regex(/^[0-9]*/)),
				(o.whitespace = o.regex(/^\s+/)),
				(o.optWhitespace = o.regex(/^\s*/)),
				(o.any = new o(function (n, t, e) {
					return n ? t(n.slice(1), n.charAt(0)) : e(n, 'expected any character');
				})),
				(o.all = new o(function (n, t, e) {
					return t('', n);
				})),
				(o.eof = new o(function (n, t, e) {
					return n ? e(n, 'expected EOF') : t(n, n);
				})),
				o
			);
		})()),
		(Ne = (function () {
			function o() {
				this.fn = K;
			}
			return (
				(o.prototype.listen = function (n) {
					(this.fn = n), clearTimeout(this.timeoutId), (this.timeoutId = setTimeout(this.fn));
				}),
				(o.prototype.listenOnce = function (n) {
					var t = this;
					this.listen(function () {
						var e,
							r = [];
						for (e = 0; e < arguments.length; e++) r[e] = arguments[e];
						t.clearListener(), n.apply(void 0, r);
					});
				}),
				(o.prototype.clearListener = function () {
					(this.fn = K), clearTimeout(this.timeoutId);
				}),
				(o.prototype.trigger = function () {
					var n,
						t = [];
					for (n = 0; n < arguments.length; n++) t[n] = arguments[n];
					this.fn.apply(this, t);
				}),
				o
			);
		})()),
		(Gt = (function () {
			function o(a) {
				switch (t(a)) {
					case 'Right':
					case 'Left':
					case 'Down':
					case 'Up':
						return !0;
				}
				return !1;
			}
			function n(a) {
				return a.length === 1 && a >= 'a' && a <= 'z';
			}
			function t(a) {
				var u, p;
				return a.key === void 0
					? ((p = a.which || a.keyCode), r[p] || String.fromCharCode(p))
					: n(a.key)
					? a.key.toUpperCase()
					: (u = i[a.key]) !== null && u !== void 0
					? u
					: a.key;
			}
			function e(a) {
				var u = t(a),
					p = [];
				return (
					a.ctrlKey && p.push('Ctrl'),
					a.metaKey && p.push('Meta'),
					a.altKey && p.push('Alt'),
					a.shiftKey && p.push('Shift'),
					p.length ? (p.push(u), p.join('-')) : u
				);
			}
			var r = {
					8: 'Backspace',
					9: 'Tab',
					10: 'Enter',
					13: 'Enter',
					16: 'Shift',
					17: 'Control',
					18: 'Alt',
					20: 'CapsLock',
					27: 'Esc',
					32: 'Spacebar',
					33: 'PageUp',
					34: 'PageDown',
					35: 'End',
					36: 'Home',
					37: 'Left',
					38: 'Up',
					39: 'Right',
					40: 'Down',
					45: 'Insert',
					46: 'Del',
					144: 'NumLock'
				},
				i = {
					ArrowRight: 'Right',
					ArrowLeft: 'Left',
					ArrowDown: 'Down',
					ArrowUp: 'Up',
					Delete: 'Del',
					Escape: 'Esc',
					' ': 'Spacebar'
				};
			return function (a, u) {
				function p() {
					try {
						a instanceof HTMLTextAreaElement && a.select();
					} catch {}
				}
				function h(T) {
					C.trigger(),
						C.clearListener(),
						a instanceof HTMLTextAreaElement && (a.value = T),
						T && p(),
						(ot = !!T);
				}
				function m() {
					return (
						'selectionStart' in a &&
						a instanceof HTMLTextAreaElement &&
						a.selectionStart !== a.selectionEnd
					);
				}
				function y() {
					u.options && u.options.overrideKeystroke
						? u.options.overrideKeystroke(e(S), S)
						: u.keystroke(e(S), S);
				}
				function w(T) {
					C.trigger(T),
						T.target === a &&
							((S = T),
							(_ = null),
							ot &&
								C.listenOnce(function (j) {
									(j && j.type === 'focusout') || p();
								}),
							y());
				}
				function g(T) {
					C.trigger(T),
						T.target === a && (S && _ && y(), (_ = T), o(T) ? C.listenOnce(x) : C.listen(b));
				}
				function v(T) {
					C.trigger(T), T.target === a && S && !_ && (o(T) ? C.listenOnce(x) : C.listen(b));
				}
				function b() {
					if (!m() && a instanceof HTMLTextAreaElement) {
						var T = a.value;
						T.length === 1
							? ((a.value = ''),
							  u.options && u.options.overrideTypedText
									? u.options.overrideTypedText(T)
									: u.typedText(T))
							: x();
					}
				}
				function x() {
					a instanceof HTMLTextAreaElement && a.value.length > 1 && p();
				}
				function q() {
					(S = null),
						(_ = null),
						C.clearListener(),
						a instanceof HTMLTextAreaElement && (a.value = '');
				}
				function L(T) {
					C.trigger(),
						T.target === a &&
							(document.activeElement !== a && a.focus(),
							C.listen(function () {
								if (a instanceof HTMLTextAreaElement) {
									var j = a.value;
									(a.value = ''), j && u.paste(j);
								}
							}));
				}
				function A(T) {
					C.trigger(T);
				}
				var S = null,
					_ = null,
					C = new Ne(),
					ot = !1;
				return (
					u.options && u.options.disableCopyPaste
						? u.addTextareaEventListeners({
								keydown: w,
								keypress: g,
								keyup: v,
								focusout: q,
								copy: function (T) {
									T.preventDefault();
								},
								cut: function (T) {
									T.preventDefault();
								},
								paste: function (T) {
									C.trigger(), T.preventDefault();
								},
								input: A
						  })
						: u.addTextareaEventListeners({
								keydown: w,
								keypress: g,
								keyup: v,
								focusout: q,
								cut: function () {
									C.listenOnce(function () {
										u.cut();
									});
								},
								copy: function () {
									C.listenOnce(function () {
										u.copy();
									});
								},
								paste: L,
								input: A
						  }),
					{ select: h }
				);
			};
		})()),
		(Ie = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.exportText = function () {
					return this.root.foldChildren('', function (t, e) {
						return t + e.text();
					});
				}),
				n
			);
		})(lt)),
		lt.onNotify(function (o, n) {
			if (n === 'edit' || n === 'replace' || n === void 0) {
				var t = o.controller;
				if (!t || !t.options.enableDigitGrouping || t.blurred !== !1) return;
				t.disableGroupingForSeconds(1);
			}
		}),
		(Re = (function (o) {
			function n() {
				var t = (o !== null && o.apply(this, arguments)) || this;
				return (
					(t.handleTextareaFocusEditable = function () {
						var e = t.cursor;
						t.updateMathspeak(),
							(t.blurred = !1),
							clearTimeout(t.blurTimeout),
							O(t.container).addClass('mq-focused'),
							e.parent || e.insAtRightEnd(t.root),
							e.selection
								? (e.selection.domFrag().removeClass('mq-blur'), t.selectionChanged())
								: e.show(),
							t.setOverflowClasses();
					}),
					(t.handleTextareaBlurEditable = function () {
						t.textareaSelectionTimeout &&
							(clearTimeout(t.textareaSelectionTimeout), (t.textareaSelectionTimeout = 0)),
							t.disableGroupingForSeconds(0),
							(t.blurred = !0),
							(t.blurTimeout = setTimeout(function () {
								t.root.postOrder(function (e) {
									e.intentionalBlur();
								}),
									t.cursor.clearSelection().endSelection(),
									t.blur(),
									t.updateMathspeak(),
									t.scrollHoriz();
							})),
							window.addEventListener('blur', t.handleWindowBlur);
					}),
					(t.handleTextareaFocusStatic = function () {
						t.blurred = !1;
					}),
					(t.handleTextareaBlurStatic = function () {
						t.cursor.selection && t.cursor.selection.clear(),
							setTimeout(function () {
								O(t.getTextareaSpanOrThrow()).detach(), (t.blurred = !0);
							});
					}),
					(t.handleWindowBlur = function () {
						clearTimeout(t.blurTimeout),
							t.cursor.selection && t.cursor.selection.domFrag().addClass('mq-blur'),
							t.blur(),
							t.updateMathspeak();
					}),
					t
				);
			}
			return (
				__extends(n, o),
				(n.prototype.disableGroupingForSeconds = function (t) {
					var e = this;
					clearTimeout(this.__disableGroupingTimeout),
						t === 0
							? this.root.domFrag().removeClass('mq-suppress-grouping')
							: (this.root.domFrag().addClass('mq-suppress-grouping'),
							  (this.__disableGroupingTimeout = setTimeout(function () {
									e.root.domFrag().removeClass('mq-suppress-grouping');
							  }, 1e3 * t)));
				}),
				(n.prototype.blur = function () {
					this.cursor.hide().parent.blur(this.cursor),
						O(this.container).removeClass('mq-focused'),
						window.removeEventListener('blur', this.handleWindowBlur),
						this.options && this.options.resetCursorOnBlur && this.cursor.resetToEnd(this);
				}),
				(n.prototype.addEditableFocusBlurListeners = function () {
					var t = this,
						e = t.cursor;
					this.addTextareaEventListeners({
						focus: this.handleTextareaFocusEditable,
						blur: this.handleTextareaBlurEditable
					}),
						(t.blurred = !0),
						e.hide().parent.blur(e);
				}),
				(n.prototype.addStaticFocusBlurListeners = function () {
					this.addTextareaEventListeners({
						focus: this.handleTextareaFocusStatic,
						blur: this.handleTextareaBlurStatic
					});
				}),
				n
			);
		})(Ie)),
		(ut = !1),
		(W = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.keystroke = function (t, e, r) {
					var i = r.cursor;
					switch (t) {
						case 'Ctrl-Shift-Backspace':
						case 'Ctrl-Backspace':
							r.ctrlDeleteDir(l);
							break;
						case 'Shift-Backspace':
						case 'Backspace':
							r.backspace();
							break;
						case 'Esc':
						case 'Tab':
							return void r.escapeDir(c, t, e);
						case 'Shift-Tab':
						case 'Shift-Esc':
							return void r.escapeDir(l, t, e);
						case 'End':
							r.notify('move').cursor.insAtRightEnd(i.parent),
								r.aria.queue('end of').queue(i.parent, !0);
							break;
						case 'Ctrl-End':
							r.notify('move').cursor.insAtRightEnd(r.root),
								r.aria.queue('end of').queue(r.ariaLabel).queue(r.root).queue(r.ariaPostLabel);
							break;
						case 'Shift-End':
							r.selectToBlockEndInDir(c);
							break;
						case 'Ctrl-Shift-End':
							r.selectToRootEndInDir(c);
							break;
						case 'Home':
							r.notify('move').cursor.insAtLeftEnd(i.parent),
								r.aria.queue('beginning of').queue(i.parent, !0);
							break;
						case 'Ctrl-Home':
							r.notify('move').cursor.insAtLeftEnd(r.root),
								r.aria
									.queue('beginning of')
									.queue(r.ariaLabel)
									.queue(r.root)
									.queue(r.ariaPostLabel);
							break;
						case 'Shift-Home':
							r.selectToBlockEndInDir(l);
							break;
						case 'Ctrl-Shift-Home':
							r.selectToRootEndInDir(l);
							break;
						case 'Left':
							r.moveLeft();
							break;
						case 'Shift-Left':
							r.selectLeft();
							break;
						case 'Ctrl-Left':
							break;
						case 'Right':
							r.moveRight();
							break;
						case 'Shift-Right':
							r.selectRight();
							break;
						case 'Ctrl-Right':
							break;
						case 'Up':
							r.moveUp();
							break;
						case 'Down':
							r.moveDown();
							break;
						case 'Shift-Up':
							r.withIncrementalSelection(function (a) {
								if (i[l]) for (; i[l]; ) a(l);
								else a(l);
							});
							break;
						case 'Shift-Down':
							r.withIncrementalSelection(function (a) {
								if (i[c]) for (; i[c]; ) a(c);
								else a(c);
							});
							break;
						case 'Ctrl-Up':
						case 'Ctrl-Down':
							break;
						case 'Ctrl-Shift-Del':
						case 'Ctrl-Del':
							r.ctrlDeleteDir(c);
							break;
						case 'Shift-Del':
						case 'Del':
							r.deleteForward();
							break;
						case 'Meta-A':
						case 'Ctrl-A':
							r.selectAll();
							break;
						case 'Ctrl-Alt-Up':
							i.parent.parent && i.parent.parent instanceof n
								? r.aria.queue(i.parent.parent)
								: r.aria.queue('nothing above');
							break;
						case 'Ctrl-Alt-Down':
							i.parent && i.parent instanceof n
								? r.aria.queue(i.parent)
								: r.aria.queue('block is empty');
							break;
						case 'Ctrl-Alt-Left':
							i.parent.parent && i.parent.parent.getEnd(l)
								? r.aria.queue(i.parent.parent.getEnd(l))
								: r.aria.queue('nothing to the left');
							break;
						case 'Ctrl-Alt-Right':
							i.parent.parent && i.parent.parent.getEnd(c)
								? r.aria.queue(i.parent.parent.getEnd(c))
								: r.aria.queue('nothing to the right');
							break;
						case 'Ctrl-Alt-Shift-Down':
							i.selection
								? r.aria.queue(i.selection.join('mathspeak', ' ').trim() + ' selected')
								: r.aria.queue('nothing selected');
							break;
						case 'Ctrl-Alt-=':
						case 'Ctrl-Alt-Shift-Right':
							r.ariaPostLabel.length ? r.aria.queue(r.ariaPostLabel) : r.aria.queue('no answer');
							break;
						default:
							return;
					}
					r.aria.alert(), e?.preventDefault(), r.scrollHoriz();
				}),
				(n.prototype.moveOutOf = function (t, e, r) {
					E('overridden or never called on this node', !1);
				}),
				(n.prototype.moveTowards = function (t, e, r) {
					E('overridden or never called on this node', !1);
				}),
				(n.prototype.deleteOutOf = function (t, e) {
					E('overridden or never called on this node', !1);
				}),
				(n.prototype.deleteTowards = function (t, e) {
					E('overridden or never called on this node', !1);
				}),
				(n.prototype.unselectInto = function (t, e) {
					E('overridden or never called on this node', !1);
				}),
				(n.prototype.selectOutOf = function (t, e) {
					E('overridden or never called on this node', !1);
				}),
				(n.prototype.selectTowards = function (t, e) {
					E('overridden or never called on this node', !1);
				}),
				n
			);
		})(Q)),
		lt.onNotify(function (o, n) {
			(n !== 'move' && n !== 'upDown') || o.show().clearSelection();
		}),
		(st.leftRightIntoCmdGoes = function (o) {
			if (o && o !== 'up' && o !== 'down')
				throw '"up" or "down" required for leftRightIntoCmdGoes option, got "' + o + '"';
			return o;
		}),
		lt.onNotify(function (o, n) {
			n !== 'upDown' && (o.upDownCache = {});
		}),
		lt.onNotify(function (o, n) {
			n === 'edit' && o.show().deleteSelection();
		}),
		lt.onNotify(function (o, n) {
			n !== 'select' && o.endSelection();
		}),
		(Be = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.keystroke = function (t, e) {
					this.cursor.parent.keystroke(t, e, this.getControllerSelf());
				}),
				(n.prototype.escapeDir = function (t, e, r) {
					F(t);
					var i = this.cursor;
					if ((i.parent !== this.root && r?.preventDefault(), i.parent !== this.root))
						return (
							i.clearSelection(),
							i.parent.moveOutOf(t, i),
							i.controller.aria.alert(),
							this.notify('move')
						);
				}),
				(n.prototype.moveDir = function (t) {
					var e, r, i;
					return (
						F(t),
						(e = this.cursor),
						(r = e.options.leftRightIntoCmdGoes),
						(i = e[t]),
						e.selection
							? e.insDirOf(t, e.selection.getEnd(t))
							: i
							? i.moveTowards(t, e, r)
							: e.parent.moveOutOf(t, e, r),
						this.notify('move')
					);
				}),
				(n.prototype.moveLeft = function () {
					return this.moveDir(l);
				}),
				(n.prototype.moveRight = function () {
					return this.moveDir(c);
				}),
				(n.prototype.moveUp = function () {
					return this.moveUpDown('up');
				}),
				(n.prototype.moveDown = function () {
					return this.moveUpDown('down');
				}),
				(n.prototype.moveUpDown = function (t) {
					var e,
						r,
						i,
						a,
						u,
						p,
						h = this,
						m = h.notify('upDown').cursor;
					return (
						t === 'up' ? ((e = 'upInto'), (r = 'upOutOf')) : ((e = 'downInto'), (r = 'downOutOf')),
						(i = m[l]),
						(a = m[c]),
						(u = a && a[e]),
						(p = i && i[e]),
						u
							? m.insAtLeftEnd(u)
							: p
							? m.insAtRightEnd(p)
							: m.parent.bubble(function (y) {
									var w = y[r];
									if (
										w &&
										(typeof w == 'function' && (w = w.call(y, m)),
										w instanceof W && m.jumpUpDown(y, w),
										w !== !0)
									)
										return !1;
							  }),
						h
					);
				}),
				(n.prototype.deleteDir = function (t) {
					var e, r, i, a, u, p, h, m, y, w;
					return (
						F(t),
						(e = this.cursor),
						(r = e[t]),
						(i = e.parent.parent),
						(a = e.controller),
						r && r instanceof W
							? r.sides
								? a.aria.queue(r.parent.chToCmd(r.sides[-t].ch).mathspeak({ createdLeftOf: e }))
								: r.blocks || r.parent.ctrlSeq === '\\text' || a.aria.queue(r)
							: i &&
							  i instanceof W &&
							  (i.sides
									? a.aria.queue(i.parent.chToCmd(i.sides[t].ch).mathspeak({ createdLeftOf: e }))
									: i.blocks && i.mathspeakTemplate
									? i.upInto && i.downInto
										? a.aria.queue(i.mathspeakTemplate[1])
										: ((u = i.mathspeakTemplate),
										  (p = t === l ? u[0] : u[u.length - 1]),
										  a.aria.queue(p))
									: a.aria.queue(i)),
						(h = e.selection),
						this.notify('edit'),
						h || ((m = e[t]), m ? m.deleteTowards(t, e) : e.parent.deleteOutOf(t, e)),
						(y = e[l]),
						(w = e[c]),
						y.siblingDeleted && y.siblingDeleted(e.options, c),
						w.siblingDeleted && w.siblingDeleted(e.options, l),
						e.parent.bubble(function (g) {
							g.reflow();
						}),
						this
					);
				}),
				(n.prototype.ctrlDeleteDir = function (t) {
					var e, r, i, a;
					return (
						F(t),
						(e = this.cursor),
						!e[t] || e.selection
							? this.deleteDir(t)
							: (this.notify('edit'),
							  (r = t === l ? new I(e.parent.getEnd(l), e[l]) : new I(e[c], e.parent.getEnd(c))),
							  e.controller.aria.queue(r),
							  r.remove(),
							  e.insAtDirEnd(t, e.parent),
							  (i = e[l]),
							  (a = e[c]),
							  i && i.siblingDeleted(e.options, c),
							  a && a.siblingDeleted(e.options, l),
							  e.parent.bubble(function (u) {
									u.reflow();
							  }),
							  this)
					);
				}),
				(n.prototype.backspace = function () {
					return this.deleteDir(l);
				}),
				(n.prototype.deleteForward = function () {
					return this.deleteDir(c);
				}),
				(n.prototype.startIncrementalSelection = function () {
					E("Multiple selections can't be simultaneously open", !ut),
						(ut = !0),
						this.notify('select');
					var t = this.cursor;
					t.anticursor || t.startSelection();
				}),
				(n.prototype.selectDirIncremental = function (t) {
					var e, r, i;
					E('A selection is open', ut),
						(ut = !0),
						(e = this.cursor),
						(r = e.selection),
						F(t),
						(i = e[t]),
						i
							? r && r.getEnd(t) === i && e.anticursor[-t] !== i
								? i.unselectInto(t, e)
								: i.selectTowards(t, e)
							: e.parent.selectOutOf(t, e);
				}),
				(n.prototype.finishIncrementalSelection = function () {
					var t, e;
					E('A selection is open', ut),
						(t = this.cursor),
						t.clearSelection(),
						t.select() || t.show(),
						(e = t.selection),
						e && t.controller.aria.clear().queue(e.join('mathspeak', ' ').trim() + ' selected'),
						(ut = !1);
				}),
				(n.prototype.withIncrementalSelection = function (t) {
					var e = this;
					try {
						this.startIncrementalSelection();
						try {
							t(function (r) {
								return e.selectDirIncremental(r);
							});
						} finally {
							this.finishIncrementalSelection();
						}
					} finally {
						ut = !1;
					}
				}),
				(n.prototype.selectDir = function (t) {
					this.withIncrementalSelection(function (e) {
						return e(t);
					});
				}),
				(n.prototype.selectLeft = function () {
					return this.selectDir(l);
				}),
				(n.prototype.selectRight = function () {
					return this.selectDir(c);
				}),
				(n.prototype.selectAll = function () {
					this.notify('move');
					var t = this.cursor;
					t.insAtRightEnd(this.root),
						this.withIncrementalSelection(function (e) {
							for (; t[l]; ) e(l);
						});
				}),
				(n.prototype.selectToBlockEndInDir = function (t) {
					var e = this.cursor;
					this.withIncrementalSelection(function (r) {
						for (; e[t]; ) r(t);
					});
				}),
				(n.prototype.selectToRootEndInDir = function (t) {
					var e = this,
						r = this.cursor;
					this.withIncrementalSelection(function (i) {
						for (; r[t] || r.parent !== e.root; ) i(t);
					});
				}),
				n
			);
		})(Re)),
		(function (o) {
			function n(t) {
				return o.call(this) || this;
			}
			__extends(n, o);
		})(W),
		(G = (function () {
			function o(S) {
				var _ = new R();
				return S.adopt(_, 0, 0), _;
			}
			function n(S) {
				var _,
					C = S[0] || new R();
				for (_ = 1; _ < S.length; _ += 1) S[_].children().adopt(C, C.getEnd(c), 0);
				return C;
			}
			var t = k.string,
				e = k.regex,
				r = k.letter,
				i = k.digit,
				a = k.any,
				u = k.optWhitespace,
				p = k.succeed,
				h = k.fail,
				m = r.map(function (S) {
					return new pt(S);
				}),
				y = i.map(function (S) {
					return new Ot(S);
				}),
				w = e(/^[^${}\\_^]/).map(function (S) {
					return new it(S);
				}),
				g = e(/^[^\\a-eg-zA-Z]/)
					.or(
						t('\\').then(
							e(/^[a-z]+/i)
								.or(e(/^\s+/).result(' '))
								.or(a)
						)
					)
					.then(function (S) {
						var _,
							C,
							ot = s[S];
						return ot
							? ot.constructor
								? ((_ = ot), new _(S).parser())
								: ((C = ot), C(S).parser())
							: h('unknown command: \\' + S);
					}),
				v = g.or(m).or(y).or(w),
				b = t('{')
					.then(function () {
						return q;
					})
					.skip(t('}')),
				x = u.then(b.or(v.map(o))),
				q = x.many().map(n).skip(u),
				L = t('[')
					.then(
						x
							.then(function (S) {
								return S.join('latex') !== ']' ? p(S) : h('');
							})
							.many()
							.map(n)
							.skip(u)
					)
					.skip(t(']')),
				A = q;
			return (A.block = x), (A.optBlock = L), A;
		})()),
		(st.maxDepth = function (o) {
			return typeof o == 'number' ? o : void 0;
		}),
		(ze = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.cleanLatex = function (t) {
					return t.replace(/(\\[a-z]+) (?![a-z])/gi, '$1');
				}),
				(n.prototype.exportLatex = function () {
					return this.cleanLatex(this.root.latex());
				}),
				(n.prototype.writeLatex = function (t) {
					var e = this.notify('edit').cursor;
					return e.parent.writeLatex(e, t), this;
				}),
				(n.prototype.exportLatexSelection = function () {
					var t,
						e,
						r,
						i,
						a,
						u,
						p,
						h,
						m = { latex: '', startIndex: -1, endIndex: -1 },
						y = this.cursor.selection;
					for (
						y
							? ((m.startSelectionBefore = y.getEnd(l)), (m.endSelectionAfter = y.getEnd(c)))
							: ((t = this.cursor[l]),
							  t ? (m.startSelectionAfter = t) : (m.startSelectionBefore = this.cursor.parent),
							  (e = this.cursor[c]),
							  e ? (m.endSelectionBefore = e) : (m.endSelectionAfter = this.cursor.parent)),
							this.root.latexRecursive(m),
							r = m.latex,
							i = this.cleanLatex(r),
							a = m.startIndex,
							u = m.endIndex,
							p = 0,
							h = 0;
						h < m.endIndex;
						h++
					)
						r[h] !== i[p] ? (h < m.startIndex && (a -= 1), (u -= 1)) : (p += 1);
					return { latex: i, startIndex: a, endIndex: u };
				}),
				(n.prototype.classifyLatexForEfficientUpdate = function (t) {
					if (typeof t == 'string') {
						var e = t.match(/-?[0-9.]+$/g);
						return e && e.length === 1
							? { latex: t, prefix: t.substr(0, t.length - e[0].length), digits: e[0] }
							: void 0;
					}
				}),
				(n.prototype.updateLatexMathEfficiently = function (t, e) {
					var r,
						i,
						a,
						u,
						p,
						h,
						m,
						y,
						w,
						g,
						v,
						b,
						x,
						q,
						L,
						A,
						S,
						_,
						C,
						ot,
						T,
						j,
						Ge,
						Ke,
						ye,
						B = this.root,
						ve = this.classifyLatexForEfficientUpdate(t);
					if (!ve || !(p = this.classifyLatexForEfficientUpdate(e)) || p.prefix !== ve.prefix)
						return !1;
					for (
						h = p.digits,
							m = ve.digits,
							y = !1,
							w = !1,
							h[0] === '-' && ((y = !0), (h = h.substr(1))),
							m[0] === '-' && ((w = !0), (m = m.substr(1))),
							g = this.root.getEnd(c),
							v = [],
							b = h.length - 1;
						b >= 0;
						b--
					) {
						if (!g || g.ctrlSeq !== h[b] || g.parent !== B) return !1;
						v.unshift(g), (g = g[l]);
					}
					if (y && !w) {
						if (
							!(x = g) ||
							x.ctrlSeq !== '-' ||
							x[c] !== v[0] ||
							x.parent !== B ||
							((q = x[l]) && q.parent !== B)
						)
							return !1;
						(v[0][l] = x[l]),
							B.getEnd(l) === x && B.setEnds(((r = {}), (r[l] = v[0]), (r[c] = B.getEnd(c)), r)),
							q && (q[c] = v[0]),
							x.domFrag().remove();
					}
					for (
						!y &&
							w &&
							((L = new wt('-')),
							(A = document.createElement('span')),
							(A.textContent = '-'),
							L.setDOM(A),
							(S = v[0][l]),
							S && (S[c] = L),
							B.getEnd(l) === v[0] && B.setEnds(((i = {}), (i[l] = L), (i[c] = B.getEnd(c)), i)),
							(L.parent = B),
							(L[l] = v[0][l]),
							(L[c] = v[0]),
							(v[0][l] = L),
							L.contactWeld(this.cursor),
							L.domFrag().insertBefore(v[0].domFrag())),
							_ = Math.min(h.length, m.length),
							b = 0;
						b < _;
						b++
					)
						(C = m[b]),
							(g = v[b]),
							g.ctrlSeq !== C &&
								((g.ctrlSeq = C),
								(g.domFrag().oneElement().textContent = C),
								(g.mathspeakName = C));
					if (h.length > m.length)
						for (
							g = v[m.length - 1],
								B.setEnds(((a = {}), (a[l] = B.getEnd(l)), (a[c] = g), a)),
								g[c] = 0,
								b = h.length - 1;
							b >= _;
							b--
						)
							v[b].domFrag().remove();
					if (m.length > h.length) {
						for (ot = document.createDocumentFragment(), b = _; b < m.length; b++)
							(T = document.createElement('span')),
								(T.className = 'mq-digit'),
								(T.textContent = m[b]),
								(j = new Ot(m[b])),
								(j.parent = B),
								j.setDOM(T),
								ot.appendChild(T),
								(j[l] = B.getEnd(c)),
								(j[c] = 0),
								(Ge = j[l]),
								(Ge[c] = j),
								B.setEnds(((u = {}), (u[l] = B.getEnd(l)), (u[c] = j), u));
						B.domFrag().oneElement().appendChild(ot);
					}
					return (Ke = this.exportLatex()) !== t
						? (console.warn(
								'tried updating latex efficiently but did not work. Attempted: ' +
									t +
									' but wrote: ' +
									Ke
						  ),
						  !1)
						: ((ye = B.getEnd(c)), ye && ye.fixDigitGrouping(this.cursor.options), !0);
				}),
				(n.prototype.renderLatexMathFromScratch = function (t) {
					var e,
						r,
						i = this.root,
						a = this.cursor,
						u = k.all,
						p = k.eof,
						h = G.skip(p).or(u.result(!1)).parse(t);
					i.setEnds(((e = {}), (e[l] = 0), (e[c] = 0), e)),
						h && h.children().adopt(i, 0, 0),
						h
							? ((r = i.domFrag()),
							  r.children().remove(),
							  r.oneElement().appendChild(h.html()),
							  i.finalizeInsert(a.options, a))
							: i.domFrag().empty();
				}),
				(n.prototype.renderLatexMath = function (t) {
					var e,
						r = this.cursor,
						i = this.root;
					this.notify('replace'),
						r.clearSelection(),
						(e = this.exportLatex()),
						(i.getEnd(l) && i.getEnd(c) && e === t) ||
							(this.updateLatexMathEfficiently(t, e) || this.renderLatexMathFromScratch(t),
							this.updateMathspeak()),
						r.insAtRightEnd(i);
				}),
				(n.prototype.renderLatexText = function (t) {
					var e,
						r,
						i,
						a,
						u,
						p,
						h,
						m,
						y,
						w,
						g,
						v = this.root,
						b = this.cursor;
					if (
						(v.domFrag().children().slice(1).remove(),
						v.setEnds(((e = {}), (e[l] = 0), (e[c] = 0), e)),
						delete b.selection,
						b.show().insAtRightEnd(v),
						(r = k.regex),
						(i = k.string),
						(a = k.eof),
						(u = k.all),
						(p = i('$')
							.then(G)
							.skip(i('$').or(a))
							.map(function (x) {
								var q,
									L = new Xt(b);
								return L.createBlocks(), (q = L.getEnd(l)), x.children().adopt(q, 0, 0), L;
							})),
						(h = i('\\$').result('$')),
						(m = h.or(r(/^[^$]/)).map(function (x) {
							return new it(x);
						})),
						(y = p.or(m).many()),
						(w = y.skip(a).or(u.result(!1)).parse(t)))
					) {
						for (g = 0; g < w.length; g += 1) w[g].adopt(v, v.getEnd(c), 0);
						O(v.html()).appendTo(v.domFrag().oneElement()), v.finalizeInsert(b.options, b);
					}
				}),
				n
			);
		})(Be)),
		(Kt = function (o) {
			return !1;
		}),
		(z.prototype.ignoreNextMousedown = Kt),
		(function () {
			lt.onNotify(function (o, n) {
				(n !== 'edit' && n !== 'replace') || (Lt && Lt.cursor === o && Lt.cb());
			});
		})(),
		(Pe = (function (o) {
			function n() {
				var t = (o !== null && o.apply(this, arguments)) || this;
				return (
					(t.handleMouseDown = function (e) {
						function r(A) {
							h = A.target;
						}
						function i(A) {
							b.anticursor || b.startSelection(),
								v.seek(h, A.clientX, A.clientY).cursor.select(),
								b.selection &&
									b.controller.aria
										.clear()
										.queue(b.selection.join('mathspeak') + ' selected')
										.alert(),
								(h = null);
						}
						function a() {
							y?.removeEventListener('mousemove', r),
								g?.removeEventListener('mousemove', i),
								g?.removeEventListener('mouseup', p),
								(Lt = void 0);
						}
						function u() {
							v.editable ? (b.show(), b.controller.aria.queue(b.parent).alert()) : O(q).detach();
						}
						function p() {
							(b.blink = x), b.selection || u(), a();
						}
						var h,
							m,
							y = Y(e.target, '.mq-root-block'),
							w = (y && Q.getNodeOfElement(y)) || Q.getNodeOfElement(t.root.domFrag().oneElement()),
							g = w.domFrag().firstNode().ownerDocument,
							v = w.controller,
							b = v.cursor,
							x = b.blink,
							q = v.getTextareaSpanOrThrow(),
							L = v.getTextareaOrThrow();
						e.preventDefault(),
							(e.target.unselectable = !0),
							b.options.ignoreNextMousedown(e) ||
								((b.options.ignoreNextMousedown = Kt),
								(h = null),
								(Lt = {
									cursor: b,
									cb: function () {
										(m = !0), (b.blink = x), b.clearSelection(), u(), a();
									}
								}),
								(v.blurred && (y && !v.editable && O(y).prepend(O(q)), L.focus(), m)) ||
									((b.blink = K),
									v.seek(e.target, e.clientX, e.clientY).cursor.startSelection(),
									y?.addEventListener('mousemove', r),
									g?.addEventListener('mousemove', i),
									g?.addEventListener('mouseup', p)));
					}),
					t
				);
			}
			return (
				__extends(n, o),
				(n.prototype.addMouseEventListener = function () {
					this.container.addEventListener('mousedown', this.handleMouseDown);
				}),
				(n.prototype.removeMouseEventListener = function () {
					this.container.removeEventListener('mousedown', this.handleMouseDown);
				}),
				(n.prototype.seek = function (t, e, r) {
					for (var i, a = this.notify('select').cursor; t && !(i = Q.getNodeOfElement(t)); )
						t = t.parentElement;
					return (
						i || (i = this.root), a.clearSelection().show(), i.seek(e, a), this.scrollHoriz(), this
					);
				}),
				n
			);
		})(ze)),
		(He = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.setOverflowClasses = function () {
					var t,
						e,
						r,
						i = this.root.domFrag().oneElement(),
						a = !1,
						u = !1;
					this.blurred ||
						((t = $(i).width),
						(e = i.scrollWidth),
						(r = i.scrollLeft),
						(a = e > t + r),
						(u = r > 0)),
						i.classList.contains('mq-editing-overflow-right') !== a &&
							i.classList.toggle('mq-editing-overflow-right'),
						i.classList.contains('mq-editing-overflow-left') !== u &&
							i.classList.toggle('mq-editing-overflow-left');
				}),
				(n.prototype.scrollHoriz = function () {
					var t,
						e,
						r,
						i,
						a,
						u,
						p,
						h,
						m,
						y,
						w = this,
						g = this.cursor,
						v = g.selection,
						b = $(this.root.domFrag().oneElement());
					if (g.domFrag().isEmpty() && !v)
						return (
							this.cancelScrollHoriz &&
								(this.cancelScrollHoriz(), (this.cancelScrollHoriz = void 0)),
							(t = this.root.domFrag().oneElement()),
							(e = t.scrollLeft),
							void jt(this.getScrollAnimationDuration(), function (x, q, L) {
								x >= 1
									? ((w.cancelScrollHoriz = void 0), (t.scrollLeft = 0), w.setOverflowClasses())
									: ((w.cancelScrollHoriz = L), q(), (t.scrollLeft = Math.round((1 - x) * e)));
							})
						);
					if (v)
						if (
							((a = $(v.domFrag().oneElement())),
							(u = a.left - (b.left + 20)),
							(p = a.right - (b.right - 20)),
							v.getEnd(l) === g[c])
						)
							if (u < 0) i = u;
							else {
								if (!(p > 0)) return;
								i = a.left - p < b.left + 20 ? u : p;
							}
						else if (p > 0) i = p;
						else {
							if (!(u < 0)) return;
							i = a.right - u > b.right - 20 ? p : u;
						}
					else if ((r = $(g.domFrag().oneElement()).left) > b.right - 20) i = r - (b.right - 20);
					else {
						if (!(r < b.left + 20)) return;
						i = r - (b.left + 20);
					}
					(h = this.root.domFrag().oneElement()),
						(i < 0 && h.scrollLeft === 0) ||
							(i > 0 && h.scrollWidth <= h.scrollLeft + b.width) ||
							(this.cancelScrollHoriz &&
								(this.cancelScrollHoriz(), (this.cancelScrollHoriz = void 0)),
							(m = this.root.domFrag().oneElement()),
							(y = m.scrollLeft),
							jt(this.getScrollAnimationDuration(), function (x, q, L) {
								x >= 1
									? ((w.cancelScrollHoriz = void 0),
									  (m.scrollLeft = Math.round(y + i)),
									  w.setOverflowClasses())
									: ((w.cancelScrollHoriz = L), q(), (m.scrollLeft = Math.round(y + x * i)));
							}));
				}),
				(n.prototype.getScrollAnimationDuration = function () {
					var t;
					return (t = this.options.scrollAnimationDuration) !== null && t !== void 0 ? t : 100;
				}),
				n
			);
		})(Pe)),
		(z.prototype.substituteTextarea = function () {
			return f('textarea', {
				autocapitalize: 'off',
				autocomplete: 'off',
				autocorrect: 'off',
				spellcheck: !1,
				'x-palm-disable-ste-all': !0
			});
		}),
		(z.prototype.substituteKeyboardEvents = Ee),
		(Zt = (function (o) {
			function n() {
				var t = (o !== null && o.apply(this, arguments)) || this;
				return (t.selectFn = K), t;
			}
			return (
				__extends(n, o),
				(n.prototype.createTextarea = function () {
					var t, e;
					if (
						((this.textareaSpan = f('span', { class: 'mq-textarea' })),
						(t = this.options.substituteTextarea()),
						!t.nodeType)
					)
						throw 'substituteTextarea() must return a DOM element, got ' + t;
					(this.textarea = O(t).appendTo(this.textareaSpan).oneElement()),
						(e = this),
						(e.cursor.selectionChanged = function () {
							e.selectionChanged();
						});
				}),
				(n.prototype.selectionChanged = function () {
					var t = this;
					t.textareaSelectionTimeout ||
						(t.textareaSelectionTimeout = setTimeout(function () {
							t.setTextareaSelection();
						}));
				}),
				(n.prototype.setTextareaSelection = function () {
					this.textareaSelectionTimeout = 0;
					var t = '';
					this.cursor.selection &&
						((t = this.cleanLatex(this.cursor.selection.join('latex'))),
						this.options.statelessClipboard && (t = '$' + t + '$')),
						this.selectFn(t);
				}),
				(n.prototype.staticMathTextareaEvents = function () {
					var t = this;
					this.removeTextareaEventListener('cut'),
						this.removeTextareaEventListener('paste'),
						t.options.disableCopyPaste
							? this.removeTextareaEventListener('copy')
							: this.addTextareaEventListeners({
									copy: function () {
										t.setTextareaSelection();
									}
							  }),
						this.addStaticFocusBlurListeners(),
						(t.selectFn = function (e) {
							var r = t.getTextareaOrThrow();
							r instanceof HTMLTextAreaElement && ((r.value = e), e && r.select());
						});
				}),
				(n.prototype.editablesTextareaEvents = function () {
					var t,
						e,
						r,
						i = this,
						a = i.getTextareaOrThrow(),
						u = i.getTextareaSpanOrThrow();
					this.options.version < 3
						? ((t = this.options.assertJquery()),
						  (e = this.options.substituteKeyboardEvents(t(a), this)),
						  (this.selectFn = function (p) {
								e.select(p);
						  }))
						: ((r = Gt(a, this).select), (this.selectFn = r)),
						O(this.container).prepend(O(u)),
						this.addEditableFocusBlurListeners(),
						this.updateMathspeak();
				}),
				(n.prototype.unbindEditablesEvents = function () {
					var t = this,
						e = t.getTextareaOrThrow(),
						r = t.getTextareaSpanOrThrow();
					(this.selectFn = function (i) {
						e instanceof HTMLTextAreaElement && ((e.value = i), i && e.select());
					}),
						O(r).remove(),
						this.removeTextareaEventListener('focus'),
						this.removeTextareaEventListener('blur'),
						(t.blurred = !0),
						this.removeTextareaEventListener('cut'),
						this.removeTextareaEventListener('paste');
				}),
				(n.prototype.typedText = function (t) {
					if (
						t ===
						`
`
					)
						return this.handle('enter');
					var e = this.notify(void 0).cursor;
					e.parent.write(e, t), this.scrollHoriz();
				}),
				(n.prototype.cut = function () {
					var t = this,
						e = t.cursor;
					e.selection &&
						setTimeout(function () {
							t.notify('edit'),
								e.parent.bubble(function (r) {
									r.reflow();
								}),
								t.options && t.options.onCut && t.options.onCut();
						});
				}),
				(n.prototype.copy = function () {
					this.setTextareaSelection();
				}),
				(n.prototype.paste = function (t) {
					this.options.statelessClipboard &&
						(t =
							t.slice(0, 1) === '$' && t.slice(-1) === '$' ? t.slice(1, -1) : '\\text{' + t + '}'),
						this.writeLatex(t).cursor.show(),
						this.scrollHoriz(),
						this.options && this.options.onPaste && this.options.onPaste();
				}),
				(n.prototype.setupStaticField = function () {
					(this.mathspeakSpan = f('span', { class: 'mq-mathspeak' })),
						O(this.container).prepend(O(this.mathspeakSpan)),
						this.updateMathspeak(),
						(this.blurred = !0),
						this.cursor.hide().parent.blur(this.cursor);
				}),
				(n.prototype.updateMathspeak = function () {
					var t,
						e = this,
						r = e.getAriaLabel(),
						i = /[A-Za-z0-9]$/.test(r) ? r + ':' : r,
						a = e.root.mathspeak().trim();
					this.aria.clear(),
						(t = e.getTextareaOrThrow()),
						e.mathspeakSpan
							? (t.setAttribute('aria-label', ''),
							  (e.mathspeakSpan.textContent = (i + ' ' + a).trim()))
							: t.setAttribute('aria-label', (i + ' ' + a + ' ' + e.ariaPostLabel).trim());
				}),
				n
			);
		})(He)),
		(Yt = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.finalizeInsert = function (t, e) {
					var r,
						i,
						a = this;
					a.postOrder(function (u) {
						u.finalizeTree(t);
					}),
						a.postOrder(function (u) {
							u.contactWeld(e);
						}),
						a.postOrder(function (u) {
							u.blur(e);
						}),
						a.postOrder(function (u) {
							u.reflow();
						}),
						(r = a[c]),
						(i = a[l]),
						r && r.siblingCreated(t, l),
						i && i.siblingCreated(t, c),
						a.bubble(function (u) {
							u.reflow();
						});
				}),
				(n.prototype.prepareInsertionAt = function (t) {
					var e,
						r = t.options.maxDepth;
					if (r !== void 0) {
						if ((e = t.depth()) > r) return !1;
						this.removeNodesDeeperThan(r - e);
					}
					return !0;
				}),
				(n.prototype.removeNodesDeeperThan = function (t) {
					for (var e, r, i = 0, a = [[this, i]]; (e = a.shift()); )
						(r = e),
							r[0].children().each(function (u) {
								var p = u instanceof R ? 1 : 0;
								(i = r[1] + p), i <= t ? a.push([u, i]) : (p ? u.children() : u).remove();
							});
				}),
				n
			);
		})(W)),
		(N = (function () {
			function o(n, t) {
				(this.childCount = n), (this.render = t);
			}
			return o;
		})()),
		(M = (function (o) {
			function n(t, e, r) {
				var i = o.call(this) || this;
				return (
					(i.textTemplate = ['']), (i.mathspeakTemplate = ['']), i.setCtrlSeqHtmlAndText(t, e, r), i
				);
			}
			return (
				__extends(n, o),
				(n.prototype.setEnds = function (t) {
					E('MathCommand ends are never empty', t[l] && t[c]), (this.ends = t);
				}),
				(n.prototype.getEnd = function (t) {
					return this.ends[t];
				}),
				(n.prototype.setCtrlSeqHtmlAndText = function (t, e, r) {
					this.ctrlSeq || (this.ctrlSeq = t), e && (this.domView = e), r && (this.textTemplate = r);
				}),
				(n.prototype.replaces = function (t) {
					t.disown(), (this.replacedFragment = t);
				}),
				(n.prototype.isEmpty = function () {
					return this.foldChildren(!0, function (t, e) {
						return t && e.isEmpty();
					});
				}),
				(n.prototype.parser = function () {
					var t = this;
					return G.block.times(this.numBlocks()).map(function (e) {
						t.blocks = e;
						for (var r = 0; r < e.length; r += 1) e[r].adopt(t, t.getEnd(c), 0);
						return t;
					});
				}),
				(n.prototype.createLeftOf = function (t) {
					var e,
						r = this,
						i = r.replacedFragment;
					r.createBlocks(),
						o.prototype.createLeftOf.call(this, t),
						i &&
							((e = r.getEnd(l)),
							i.adopt(e, 0, 0),
							i.domFrag().appendTo(e.domFrag().oneElement()),
							r.placeCursor(t),
							r.prepareInsertionAt(t)),
						r.finalizeInsert(t.options, t),
						r.placeCursor(t);
				}),
				(n.prototype.createBlocks = function () {
					var t,
						e,
						r = this,
						i = r.numBlocks(),
						a = (r.blocks = Array(i));
					for (t = 0; t < i; t += 1) (e = a[t] = new R()), e.adopt(r, r.getEnd(c), 0);
				}),
				(n.prototype.placeCursor = function (t) {
					t.insAtRightEnd(
						this.foldChildren(this.getEnd(l), function (e, r) {
							return e.isEmpty() ? e : r;
						})
					);
				}),
				(n.prototype.moveTowards = function (t, e, r) {
					var i, a;
					r === 'up' ? (i = this.upInto) : r === 'down' && (i = this.downInto),
						(a = i || this.getEnd(-t)),
						e.insAtDirEnd(-t, a),
						e.controller.aria.queueDirEndOf(-t).queue(e.parent, !0);
				}),
				(n.prototype.deleteTowards = function (t, e) {
					this.isEmpty() ? (e[t] = this.remove()[t]) : this.moveTowards(t, e);
				}),
				(n.prototype.selectTowards = function (t, e) {
					(e[-t] = this), (e[t] = this[t]);
				}),
				(n.prototype.selectChildren = function () {
					return new Qt(this, this);
				}),
				(n.prototype.unselectInto = function (t, e) {
					var r = e.anticursor,
						i = r.ancestors[this.id];
					e.insAtDirEnd(-t, i);
				}),
				(n.prototype.seek = function (t, e) {
					function r(p) {
						var h,
							m = p.domFrag().oneElement(),
							y = $(m).left,
							w = y + m.offsetWidth;
						return (h = {}), (h[l] = y), (h[c] = w), h;
					}
					var i,
						a = this,
						u = r(a);
					return t < u[l]
						? e.insLeftOf(a)
						: t > u[c]
						? e.insRightOf(a)
						: ((i = u[l]),
						  void a.eachChild(function (p) {
								var h = r(p);
								return t < h[l]
									? (t - i < h[l] - t
											? p[l]
												? e.insAtRightEnd(p[l])
												: e.insLeftOf(a)
											: e.insAtLeftEnd(p),
									  !1)
									: t > h[c]
									? void (p[c]
											? (i = h[c])
											: u[c] - t < t - h[c]
											? e.insRightOf(a)
											: e.insAtRightEnd(p))
									: (p.seek(t, e), !1);
						  }));
				}),
				(n.prototype.numBlocks = function () {
					return this.domView.childCount;
				}),
				(n.prototype.html = function () {
					var t,
						e,
						r = this.blocks;
					return (
						E('domView is defined', this.domView),
						(t = this.domView),
						(e = t.render(r || [])),
						this.setDOM(e),
						Q.linkElementByCmdNode(e, this),
						e
					);
				}),
				(n.prototype.latexRecursive = function (t) {
					this.checkCursorContextOpen(t),
						(t.latex += this.ctrlSeq || ''),
						this.eachChild(function (e) {
							var r, i;
							(t.latex += '{'),
								(r = t.latex.length),
								e.latexRecursive(t),
								(i = t.latex.length),
								r === i && (t.latex += ' '),
								(t.latex += '}');
						}),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.text = function () {
					var t = this,
						e = 0;
					return t.foldChildren(t.textTemplate[e], function (r, i) {
						e += 1;
						var a = i.text();
						return r && t.textTemplate[e] === '(' && a[0] === '(' && a.slice(-1) === ')'
							? r + a.slice(1, -1) + t.textTemplate[e]
							: r + a + (t.textTemplate[e] || '');
					});
				}),
				(n.prototype.mathspeak = function () {
					var t = this,
						e = 0;
					return t.foldChildren(
						t.mathspeakTemplate[e] || 'Start' + t.ctrlSeq + ' ',
						function (r, i) {
							return (
								(e += 1),
								r +
									' ' +
									i.mathspeak() +
									' ' +
									(t.mathspeakTemplate[e] + ' ' || 'End' + t.ctrlSeq + ' ')
							);
						}
					);
				}),
				n
			);
		})(Yt)),
		(V = (function (o) {
			function n(t, e, r, i) {
				var a = o.call(this) || this;
				return (
					a.setCtrlSeqHtmlTextAndMathspeak(
						t,
						e
							? new N(0, function () {
									return e.cloneNode(!0);
							  })
							: void 0,
						r,
						i
					),
					a
				);
			}
			return (
				__extends(n, o),
				(n.prototype.setCtrlSeqHtmlTextAndMathspeak = function (t, e, r, i) {
					!r && t && (r = t.replace(/^\\/, '')),
						(this.mathspeakName = i || r),
						o.prototype.setCtrlSeqHtmlAndText.call(this, t, e, [r || '']);
				}),
				(n.prototype.parser = function () {
					return k.succeed(this);
				}),
				(n.prototype.numBlocks = function () {
					return 0;
				}),
				(n.prototype.replaces = function (t) {
					t.remove();
				}),
				(n.prototype.createBlocks = function () {}),
				(n.prototype.moveTowards = function (t, e) {
					e.domFrag().insDirOf(t, this.domFrag()),
						(e[-t] = this),
						(e[t] = this[t]),
						e.controller.aria.queue(this);
				}),
				(n.prototype.deleteTowards = function (t, e) {
					e[t] = this.remove()[t];
				}),
				(n.prototype.seek = function (t, e) {
					var r = this.domFrag().oneElement();
					return t - $(r).left < r.offsetWidth / 2 ? e.insLeftOf(this) : e.insRightOf(this), e;
				}),
				(n.prototype.latexRecursive = function (t) {
					this.checkCursorContextOpen(t),
						(t.latex += this.ctrlSeq || ''),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.text = function () {
					return this.textTemplate.join('');
				}),
				(n.prototype.mathspeak = function (t) {
					return this.mathspeakName || '';
				}),
				(n.prototype.placeCursor = function () {}),
				(n.prototype.isEmpty = function () {
					return !0;
				}),
				n
			);
		})(M)),
		(it = (function (o) {
			function n(t, e, r) {
				return o.call(this, t, f('span', {}, [e || f.text(t)]), void 0, r) || this;
			}
			return __extends(n, o), n;
		})(V)),
		(P = (function (o) {
			function n(t, e, r, i, a) {
				return a
					? o.call(this, t, f('span', {}, [e || f.text(t || '')]), void 0, i) || this
					: o.call(this, t, f('span', { class: 'mq-binary-operator' }, e ? [e] : []), r, i) || this;
			}
			return __extends(n, o), n;
		})(V)),
		(R = (function (o) {
			function n() {
				var t = (o !== null && o.apply(this, arguments)) || this;
				return (t.ariaLabel = 'block'), t;
			}
			return (
				__extends(n, o),
				(n.prototype.join = function (t) {
					return this.foldChildren('', function (e, r) {
						return e + r[t]();
					});
				}),
				(n.prototype.html = function () {
					var t = document.createDocumentFragment();
					return (
						this.eachChild(function (e) {
							var r = e.html();
							t.appendChild(r);
						}),
						t
					);
				}),
				(n.prototype.latexRecursive = function (t) {
					this.checkCursorContextOpen(t),
						this.eachChild(function (e) {
							return e.latexRecursive(t);
						}),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.text = function () {
					var t = this.getEnd(l);
					return t === this.getEnd(c) && t !== 0 ? t.text() : this.join('text');
				}),
				(n.prototype.mathspeak = function () {
					var t = '',
						e = {};
					return (
						this.controller && (e = this.controller.options.autoOperatorNames),
						this.foldChildren([], function (r, i) {
							var a, u, p;
							return (
								i.isPartOfOperator
									? (t += i.mathspeak())
									: (t !== '' &&
											(e._maxLength > 0 && typeof (a = e[t.toLowerCase()]) == 'string' && (t = a),
											r.push(t + ' '),
											(t = '')),
									  (u = i.mathspeak()),
									  (p = i.ctrlSeq),
									  !isNaN(p) ||
											p === '.' ||
											(i.parent && i.parent.parent && i.parent.parent.isTextBlock()) ||
											(u = ' ' + u + ' '),
									  r.push(u)),
								r
							);
						})
							.join('')
							.replace(/ +(?= )/g, '')
							.replace(/(\.)([0-9]+)/g, function (r, i, a) {
								return i + a.split('').join(' ').trim();
							})
					);
				}),
				(n.prototype.keystroke = function (t, e, r) {
					return !r.options.spaceBehavesLikeTab || (t !== 'Spacebar' && t !== 'Shift-Spacebar')
						? o.prototype.keystroke.call(this, t, e, r)
						: (e?.preventDefault(), void r.escapeDir(t === 'Shift-Spacebar' ? l : c, t, e));
				}),
				(n.prototype.moveOutOf = function (t, e, r) {
					var i, a;
					r === 'up' ? (i = this.parent.upInto) : r === 'down' && (i = this.parent.downInto),
						!i && this[t]
							? ((a = -t),
							  e.insAtDirEnd(a, this[t]),
							  e.controller.aria.queueDirEndOf(a).queue(e.parent, !0))
							: (e.insDirOf(t, this.parent), e.controller.aria.queueDirOf(t).queue(this.parent));
				}),
				(n.prototype.selectOutOf = function (t, e) {
					e.insDirOf(t, this.parent);
				}),
				(n.prototype.deleteOutOf = function (t, e) {
					e.unwrapGramp();
				}),
				(n.prototype.seek = function (t, e) {
					var r,
						i,
						a = this.getEnd(c);
					if (!a) return e.insAtRightEnd(this);
					if (((r = a.domFrag().oneElement()), $(r).left + r.offsetWidth < t))
						return e.insAtRightEnd(this);
					if (((i = this.getEnd(l)), t < $(i.domFrag().oneElement()).left))
						return e.insAtLeftEnd(this);
					for (; t < $(a.domFrag().oneElement()).left; ) a = a[l];
					return a.seek(t, e);
				}),
				(n.prototype.chToCmd = function (t, e) {
					var r;
					return t.match(/^[a-eg-zA-Z]$/)
						? new pt(t)
						: /^\d$/.test(t)
						? new Ot(t)
						: e && e.typingSlashWritesDivisionSymbol && t === '/'
						? s['\xF7'](t)
						: e && e.typingAsteriskWritesTimesSymbol && t === '*'
						? s['\xD7'](t)
						: e && e.typingPercentWritesPercentOf && t === '%'
						? s.percentof(t)
						: (r = rt[t] || s[t])
						? r.constructor
							? new r(t)
							: r(t)
						: new it(t);
				}),
				(n.prototype.write = function (t, e) {
					var r = this.chToCmd(e, t.options);
					t.selection && r.replaces(t.replaceSelection()),
						t.isTooDeep() ||
							(r.createLeftOf(t.show()),
							e === '/'
								? t.controller.aria.alert('over')
								: t.controller.aria.alert(r.mathspeak({ createdLeftOf: t })));
				}),
				(n.prototype.writeLatex = function (t, e) {
					var r,
						i,
						a,
						u,
						p = k.all,
						h = k.eof,
						m = G.skip(h).or(p.result(!1)).parse(e);
					m &&
						!m.isEmpty() &&
						m.prepareInsertionAt(t) &&
						(m.children().adopt(t.parent, t[l], t[c]),
						O(m.html()).insertBefore(t.domFrag()),
						(t[l] = m.getEnd(c)),
						m.finalizeInsert(t.options, t),
						(r = m.getEnd(c)),
						(i = m.getEnd(l)),
						(a = r[c]),
						(u = i[l]),
						a && a.siblingCreated(t.options, l),
						u && u.siblingCreated(t.options, c),
						t.parent.bubble(function (y) {
							y.reflow();
						}));
				}),
				(n.prototype.focus = function () {
					return (
						this.domFrag().addClass('mq-hasCursor'), this.domFrag().removeClass('mq-empty'), this
					);
				}),
				(n.prototype.blur = function (t) {
					return (
						this.domFrag().removeClass('mq-hasCursor'),
						this.isEmpty() &&
							(this.domFrag().addClass('mq-empty'),
							t &&
								this.isQuietEmptyDelimiter(t.options.quietEmptyDelimiters) &&
								this.domFrag().addClass('mq-quiet-delimiter')),
						this
					);
				}),
				n
			);
		})(Yt)),
		(z.prototype.mouseEvents = !0),
		(U.StaticMath = function (o) {
			var n;
			return (
				(n = (function (t) {
					function e(r) {
						var i = t.call(this, r) || this,
							a = (i.innerFields = []);
						return (
							i.__controller.root.postOrder(function (u) {
								u.registerInnerField(a, o.InnerMathField);
							}),
							i
						);
					}
					return (
						__extends(e, t),
						(e.prototype.__mathquillify = function (r, i) {
							return (
								this.config(r),
								t.prototype.mathquillify.call(this, 'mq-math-mode'),
								this.__controller.setupStaticField(),
								this.__options.mouseEvents &&
									(this.__controller.addMouseEventListener(),
									this.__controller.staticMathTextareaEvents()),
								this
							);
						}),
						(e.prototype.latex = function (r) {
							var i,
								a = t.prototype.latex.apply(this, arguments);
							return (
								arguments.length > 0 &&
									((i = this.innerFields = []),
									this.__controller.root.postOrder(function (u) {
										u.registerInnerField(i, o.InnerMathField);
									}),
									this.__controller.updateMathspeak()),
								a
							);
						}),
						(e.prototype.setAriaLabel = function (r) {
							return this.__controller.setAriaLabel(r), this;
						}),
						(e.prototype.getAriaLabel = function () {
							return this.__controller.getAriaLabel();
						}),
						e
					);
				})(o.AbstractMathQuill)),
				(n.RootBlock = R),
				n
			);
		}),
		(Ft = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return __extends(n, o), n;
		})(R)),
		xe(Ft.prototype),
		(U.MathField = function (o) {
			var n;
			return (
				(n = (function (t) {
					function e() {
						return (t !== null && t.apply(this, arguments)) || this;
					}
					return (
						__extends(e, t),
						(e.prototype.__mathquillify = function (r, i) {
							return (
								this.config(r),
								i > 1 && (this.__controller.root.reflow = K),
								t.prototype.mathquillify.call(this, 'mq-editable-field mq-math-mode'),
								delete this.__controller.root.reflow,
								this
							);
						}),
						e
					);
				})(o.EditableField)),
				(n.RootBlock = Ft),
				n
			);
		}),
		(U.InnerMathField = function (o) {
			return (
				E('MathField class is defined', o.MathField),
				(function (n) {
					function t() {
						return (n !== null && n.apply(this, arguments)) || this;
					}
					return (
						__extends(t, n),
						(t.prototype.makeStatic = function () {
							(this.__controller.editable = !1),
								this.__controller.root.blur(),
								this.__controller.unbindEditablesEvents(),
								O(this.__controller.container).removeClass('mq-editable-field');
						}),
						(t.prototype.makeEditable = function () {
							(this.__controller.editable = !0),
								this.__controller.editablesTextareaEvents(),
								this.__controller.cursor.insAtRightEnd(this.__controller.root),
								O(this.__controller.container).addClass('mq-editable-field');
						}),
						t
					);
				})(o.MathField)
			);
		}),
		(Dt = (function (o) {
			function n() {
				var t = (o !== null && o.apply(this, arguments)) || this;
				return (
					(t.ctrlSeq = '\\text'),
					(t.ariaLabel = 'Text'),
					(t.mathspeakTemplate = ['StartText', 'EndText']),
					t
				);
			}
			return (
				__extends(n, o),
				(n.prototype.replaces = function (t) {
					t instanceof I
						? (this.replacedText = t.remove().domFrag().text())
						: typeof t == 'string' && (this.replacedText = t);
				}),
				(n.prototype.setDOMFrag = function (t) {
					var e, r;
					return (
						o.prototype.setDOM.call(this, t),
						(e = this.getEnd(l)),
						e && ((r = this.domFrag().children()), r.isEmpty() || e.setDOM(r.oneText())),
						this
					);
				}),
				(n.prototype.createLeftOf = function (t) {
					var e,
						r,
						i,
						a = this;
					if ((o.prototype.createLeftOf.call(this, t), t.insAtRightEnd(a), a.replacedText))
						for (e = 0; e < a.replacedText.length; e += 1) a.write(t, a.replacedText.charAt(e));
					(r = a[c]),
						r && r.siblingCreated(t.options, l),
						(i = a[l]),
						i && i.siblingCreated(t.options, c),
						a.bubble(function (u) {
							u.reflow();
						});
				}),
				(n.prototype.parser = function () {
					var t = this,
						e = k.string,
						r = k.regex;
					return k.optWhitespace
						.then(e('{'))
						.then(r(/^[^}]*/))
						.skip(e('}'))
						.map(function (i) {
							return i.length === 0 ? new I(0, 0) : (new dt(i).adopt(t, 0, 0), t);
						});
				}),
				(n.prototype.textContents = function () {
					return this.foldChildren('', function (t, e) {
						return t + e.textStr;
					});
				}),
				(n.prototype.text = function () {
					return '"' + this.textContents() + '"';
				}),
				(n.prototype.latexRecursive = function (t) {
					this.checkCursorContextOpen(t);
					var e = this.textContents();
					e.length > 0 &&
						((t.latex += this.ctrlSeq + '{'),
						(t.latex += e.replace(/\\/g, '\\backslash ').replace(/[{}]/g, '\\$&')),
						(t.latex += '}')),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.html = function () {
					var t = f('span', { class: 'mq-text-mode' }, [f.text(this.textContents())]);
					return this.setDOM(t), Q.linkElementByCmdNode(t, this), t;
				}),
				(n.prototype.mathspeak = function (t) {
					return t && t.ignoreShorthand
						? this.mathspeakTemplate[0] +
								', ' +
								this.textContents() +
								', ' +
								this.mathspeakTemplate[1]
						: this.textContents();
				}),
				(n.prototype.isTextBlock = function () {
					return !0;
				}),
				(n.prototype.moveTowards = function (t, e) {
					e.insAtDirEnd(-t, this), e.controller.aria.queueDirEndOf(-t).queue(e.parent, !0);
				}),
				(n.prototype.moveOutOf = function (t, e) {
					e.insDirOf(t, this), e.controller.aria.queueDirOf(t).queue(this);
				}),
				(n.prototype.unselectInto = function (t, e) {
					this.moveTowards(t, e);
				}),
				(n.prototype.selectTowards = function (t, e) {
					M.prototype.selectTowards.call(this, t, e);
				}),
				(n.prototype.deleteTowards = function (t, e) {
					M.prototype.deleteTowards.call(this, t, e);
				}),
				(n.prototype.selectOutOf = function (t, e) {
					e.insDirOf(t, this);
				}),
				(n.prototype.deleteOutOf = function (t, e) {
					this.isEmpty() && e.insRightOf(this);
				}),
				(n.prototype.write = function (t, e) {
					var r, i, a;
					t.show().deleteSelection(),
						e !== '$'
							? ((r = t[l]), r ? r instanceof dt && r.appendText(e) : new dt(e).createLeftOf(t))
							: this.isEmpty()
							? (t.insRightOf(this), new it('\\$', f.text('$')).createLeftOf(t))
							: t[c]
							? t[l]
								? ((i = new n()),
								  (a = this.getEnd(l)),
								  a && (a.disown().domFrag().detach(), a.adopt(i, 0, 0)),
								  t.insLeftOf(this),
								  o.prototype.createLeftOf.call(i, t))
								: t.insLeftOf(this)
							: t.insRightOf(this),
						this.bubble(function (u) {
							u.reflow();
						}),
						t.controller.aria.alert(e);
				}),
				(n.prototype.writeLatex = function (t, e) {
					var r = t[l];
					r ? r instanceof dt && r.appendText(e) : new dt(e).createLeftOf(t),
						this.bubble(function (i) {
							i.reflow();
						});
				}),
				(n.prototype.seek = function (t, e) {
					var r, i, a, u, p, h, m, y, w, g, v, b, x, q, L, A;
					if ((e.hide(), (r = qe(this)))) {
						for (
							i = this.domFrag().children().oneText(),
								a = document.createRange(),
								a.selectNodeContents(i),
								u = a.getClientRects(),
								u.length === 1
									? ((p = u[0]),
									  (h = p.width),
									  (m = p.left),
									  (y = h / this.textContents().length),
									  (w = Math.round((t - m) / y)),
									  w <= 0
											? e.insAtLeftEnd(this)
											: w >= r.textStr.length
											? e.insAtRightEnd(this)
											: e.insLeftOf(r.splitRight(w)))
									: e.insAtLeftEnd(this),
								g = t - e.show().getBoundingClientRectWithoutMargin().left,
								v = g && g < 0 ? l : c,
								b = v;
							e[v] && g * b > 0;

						)
							e[v].moveTowards(v, e),
								(b = g),
								(g = t - e.getBoundingClientRectWithoutMargin().left);
						v * g < -v * b && e[-v].moveTowards(-v, e),
							e.anticursor
								? e.anticursor.parent === this &&
								  ((x = e[l]),
								  (q = x && x.textStr.length),
								  this.anticursorPosition === q
										? (e.anticursor = Ct.fromCursor(e))
										: (this.anticursorPosition < q
												? ((L = x.splitRight(this.anticursorPosition)), (e[l] = L))
												: ((A = e[c]), (L = A.splitRight(this.anticursorPosition - q))),
										  (e.anticursor = new Ct(this, L[l], L))))
								: ((x = e[l]), (this.anticursorPosition = x && x.textStr.length));
					}
				}),
				(n.prototype.blur = function (t) {
					R.prototype.blur.call(this, t),
						t &&
							(this.textContents() === ''
								? (this.remove(),
								  t[l] === this ? (t[l] = this[l]) : t[c] === this && (t[c] = this[c]))
								: qe(this));
				}),
				(n.prototype.focus = function () {
					R.prototype.focus.call(this);
				}),
				n
			);
		})(W)),
		(dt = (function (o) {
			function n(t) {
				var e = o.call(this) || this;
				return (e.textStr = t), e;
			}
			return (
				__extends(n, o),
				(n.prototype.html = function () {
					var t = f.text(this.textStr);
					return this.setDOM(t), t;
				}),
				(n.prototype.appendText = function (t) {
					(this.textStr += t), this.domFrag().oneText().appendData(t);
				}),
				(n.prototype.prependText = function (t) {
					(this.textStr = t + this.textStr), this.domFrag().oneText().insertData(0, t);
				}),
				(n.prototype.insTextAtDirEnd = function (t, e) {
					F(e), e === c ? this.appendText(t) : this.prependText(t);
				}),
				(n.prototype.splitRight = function (t) {
					var e = new n(this.textStr.slice(t)).adopt(this.parent, this, this[c]);
					return (
						e.setDOM(this.domFrag().oneText().splitText(t)),
						(this.textStr = this.textStr.slice(0, t)),
						e
					);
				}),
				(n.prototype.endChar = function (t, e) {
					return e.charAt(t === l ? 0 : -1 + e.length);
				}),
				(n.prototype.moveTowards = function (t, e) {
					var r, i;
					return (
						F(t),
						(r = this.endChar(-t, this.textStr)),
						(i = this[-t]),
						i instanceof n ? i.insTextAtDirEnd(r, t) : new n(r).createDir(-t, e),
						this.deleteTowards(t, e)
					);
				}),
				(n.prototype.mathspeak = function () {
					return this.textStr;
				}),
				(n.prototype.latexRecursive = function (t) {
					this.checkCursorContextOpen(t),
						(t.latex += this.textStr),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.deleteTowards = function (t, e) {
					if (this.textStr.length > 1) {
						var r;
						t === c
							? (this.domFrag().oneText().deleteData(0, 1),
							  (r = this.textStr[0]),
							  (this.textStr = this.textStr.slice(1)))
							: (this.domFrag()
									.oneText()
									.deleteData(-1 + this.textStr.length, 1),
							  (r = this.textStr[this.textStr.length - 1]),
							  (this.textStr = this.textStr.slice(0, -1))),
							e.controller.aria.queue(r);
					} else this.remove(), (e[t] = this[t]), e.controller.aria.queue(this.textStr);
				}),
				(n.prototype.selectTowards = function (t, e) {
					var r, i, a, u, p;
					if ((F(t), (r = e.anticursor)))
						return (
							(i = this.endChar(-t, this.textStr)),
							r[t] === this
								? ((a = new n(i).createDir(t, e)), (r[t] = a), e.insDirOf(t, a))
								: ((u = this[-t]),
								  u instanceof n
										? u.insTextAtDirEnd(i, t)
										: ((a = new n(i).createDir(-t, e)),
										  (p = e.selection) && a.domFrag().insDirOf(-t, p.domFrag())),
								  this.textStr.length === 1 && r[-t] === this && (r[-t] = this[-t])),
							this.deleteTowards(t, e)
						);
				}),
				n
			);
		})(W)),
		(s.text = s.textnormal = s.textrm = s.textup = s.textmd = Dt),
		(s.em =
			s.italic =
			s.italics =
			s.emph =
			s.textit =
			s.textsl =
				ft('\\textit', 'Italic', 'i', { class: 'mq-text-mode' })),
		(s.strong = s.bold = s.textbf = ft('\\textbf', 'Bold', 'b', { class: 'mq-text-mode' })),
		(s.sf = s.textsf =
			ft('\\textsf', 'Sans serif font', 'span', { class: 'mq-sans-serif mq-text-mode' })),
		(s.tt = s.texttt =
			ft('\\texttt', 'Mono space font', 'span', { class: 'mq-monospace mq-text-mode' })),
		(s.textsc = ft('\\textsc', 'Variable font', 'span', {
			style: 'font-variant:small-caps',
			class: 'mq-text-mode'
		})),
		(s.uppercase = ft('\\uppercase', 'Uppercase', 'span', {
			style: 'text-transform:uppercase',
			class: 'mq-text-mode'
		})),
		(s.lowercase = ft('\\lowercase', 'Lowercase', 'span', {
			style: 'text-transform:lowercase',
			class: 'mq-text-mode'
		})),
		(Xt = (function (o) {
			function n(t) {
				var e = o.call(this, '$') || this;
				return (
					(e.domView = new N(1, function (r) {
						return f.block('span', { class: 'mq-math-mode' }, r[0]);
					})),
					(e.cursor = t),
					e
				);
			}
			return (
				__extends(n, o),
				(n.prototype.createBlocks = function () {
					o.prototype.createBlocks.call(this);
					var t = this.getEnd(l);
					(t.cursor = this.cursor),
						(t.write = function (e, r) {
							r !== '$'
								? R.prototype.write.call(this, e, r)
								: this.isEmpty()
								? (e.insRightOf(this.parent),
								  this.parent.deleteTowards(void 0, e),
								  new it('\\$', f.text('$')).createLeftOf(e.show()))
								: e[c]
								? e[l]
									? R.prototype.write.call(this, e, r)
									: e.insLeftOf(this.parent)
								: e.insRightOf(this.parent);
						});
				}),
				(n.prototype.latexRecursive = function (t) {
					this.checkCursorContextOpen(t),
						(t.latex += '$'),
						this.getEnd(l).latexRecursive(t),
						(t.latex += '$'),
						this.checkCursorContextClose(t);
				}),
				n
			);
		})(M)),
		($e = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.keystroke = function (t, e, r) {
					if (t !== 'Spacebar' && t !== 'Shift-Spacebar')
						return o.prototype.keystroke.call(this, t, e, r);
				}),
				(n.prototype.write = function (t, e) {
					if ((t.show().deleteSelection(), e === '$')) new Xt(t).createLeftOf(t);
					else {
						var r;
						e === '<' ? (r = f.entityText('&lt;')) : e === '>' && (r = f.entityText('&gt;')),
							new it(e, r).createLeftOf(t);
					}
				}),
				n
			);
		})(Ft)),
		(U.TextField = function (o) {
			var n;
			return (
				(n = (function (t) {
					function e() {
						return (t !== null && t.apply(this, arguments)) || this;
					}
					return (
						__extends(e, t),
						(e.prototype.__mathquillify = function () {
							return t.prototype.mathquillify.call(this, 'mq-editable-field mq-text-mode'), this;
						}),
						(e.prototype.latex = function (r) {
							return r
								? (this.__controller.renderLatexText(r),
								  this.__controller.blurred && this.__controller.cursor.hide().parent.blur(),
								  this)
								: this.__controller.exportLatex();
						}),
						e
					);
				})(o.EditableField)),
				(n.RootBlock = $e),
				n
			);
		}),
		(s.notin =
			s.cong =
			s.equiv =
			s.oplus =
			s.otimes =
				function (o) {
					return new P('\\' + o + ' ', f.entityText('&' + o + ';'));
				}),
		(s['\u2217'] = s.ast = s.star = s.loast = s.lowast = D('\\ast ', '&lowast;', 'low asterisk')),
		(s.therefor = s.therefore = D('\\therefore ', '&there4;', 'therefore')),
		(s.cuz = s.because = D('\\because ', '&#8757;', 'because')),
		(s.prop = s.propto = D('\\propto ', '&prop;', 'proportional to')),
		(s['\u2248'] = s.asymp = s.approx = D('\\approx ', '&asymp;', 'approximately equal to')),
		(s.isin = s.in = D('\\in ', '&isin;', 'is in')),
		(s.ni = s.contains = D('\\ni ', '&ni;', 'is not in')),
		(s.notni =
			s.niton =
			s.notcontains =
			s.doesnotcontain =
				D('\\not\\ni ', '&#8716;', 'does not contain')),
		(s.sub = s.subset = D('\\subset ', '&sub;', 'subset')),
		(s.sup = s.supset = s.superset = D('\\supset ', '&sup;', 'superset')),
		(s.nsub = s.notsub = s.nsubset = s.notsubset = D('\\not\\subset ', '&#8836;', 'not a subset')),
		(s.nsup =
			s.notsup =
			s.nsupset =
			s.notsupset =
			s.nsuperset =
			s.notsuperset =
				D('\\not\\supset ', '&#8837;', 'not a superset')),
		(s.sube = s.subeq = s.subsete = s.subseteq = D('\\subseteq ', '&sube;', 'subset or equal to')),
		(s.supe =
			s.supeq =
			s.supsete =
			s.supseteq =
			s.supersete =
			s.superseteq =
				D('\\supseteq ', '&supe;', 'superset or equal to')),
		(s.nsube =
			s.nsubeq =
			s.notsube =
			s.notsubeq =
			s.nsubsete =
			s.nsubseteq =
			s.notsubsete =
			s.notsubseteq =
				D('\\not\\subseteq ', '&#8840;', 'not subset or equal to')),
		(s.nsupe =
			s.nsupeq =
			s.notsupe =
			s.notsupeq =
			s.nsupsete =
			s.nsupseteq =
			s.notsupsete =
			s.notsupseteq =
			s.nsupersete =
			s.nsuperseteq =
			s.notsupersete =
			s.notsuperseteq =
				D('\\not\\supseteq ', '&#8841;', 'not superset or equal to')),
		(s.mathbb = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.createLeftOf = function (t) {}),
				(n.prototype.numBlocks = function () {
					return 1;
				}),
				(n.prototype.parser = function () {
					var t = k.string,
						e = k.regex,
						r = k.optWhitespace;
					return r
						.then(t('{'))
						.then(r)
						.then(e(/^[NPZQRCH]/))
						.skip(r)
						.skip(t('}'))
						.map(function (i) {
							var a = s[i];
							return zt(a) ? new a() : a();
						});
				}),
				n
			);
		})(M)),
		(s.N = s.naturals = s.Naturals = d('\\mathbb{N}', '&#8469;', 'naturals')),
		(s.P =
			s.primes =
			s.Primes =
			s.projective =
			s.Projective =
			s.probability =
			s.Probability =
				d('\\mathbb{P}', '&#8473;', 'P')),
		(s.Z = s.integers = s.Integers = d('\\mathbb{Z}', '&#8484;', 'integers')),
		(s.Q = s.rationals = s.Rationals = d('\\mathbb{Q}', '&#8474;', 'rationals')),
		(s.R = s.reals = s.Reals = d('\\mathbb{R}', '&#8477;', 'reals')),
		(s.C =
			s.complex =
			s.Complex =
			s.complexes =
			s.Complexes =
			s.complexplane =
			s.Complexplane =
			s.ComplexPlane =
				d('\\mathbb{C}', '&#8450;', 'complexes')),
		(s.H =
			s.Hamiltonian =
			s.quaternions =
			s.Quaternions =
				d('\\mathbb{H}', '&#8461;', 'quaternions')),
		(s.quad = s.emsp = d('\\quad ', '    ', '4 spaces')),
		(s.qquad = d('\\qquad ', '        ', '8 spaces')),
		(s.diamond = d('\\diamond ', '&#9671;', 'diamond')),
		(s.bigtriangleup = d('\\bigtriangleup ', '&#9651;', 'triangle up')),
		(s.ominus = d('\\ominus ', '&#8854;', 'o minus')),
		(s.uplus = d('\\uplus ', '&#8846;', 'disjoint union')),
		(s.bigtriangledown = d('\\bigtriangledown ', '&#9661;', 'triangle down')),
		(s.sqcap = d('\\sqcap ', '&#8851;', 'greatest lower bound')),
		(s.triangleleft = d('\\triangleleft ', '&#8882;', 'triangle left')),
		(s.sqcup = d('\\sqcup ', '&#8852;', 'least upper bound')),
		(s.triangleright = d('\\triangleright ', '&#8883;', 'triangle right')),
		(s.odot = s.circledot = d('\\odot ', '&#8857;', 'circle dot')),
		(s.bigcirc = d('\\bigcirc ', '&#9711;', 'circle')),
		(s.dagger = d('\\dagger ', '&#0134;', 'dagger')),
		(s.ddagger = d('\\ddagger ', '&#135;', 'big dagger')),
		(s.wr = d('\\wr ', '&#8768;', 'wreath')),
		(s.amalg = d('\\amalg ', '&#8720;', 'amalgam')),
		(s.models = d('\\models ', '&#8872;', 'models')),
		(s.prec = d('\\prec ', '&#8826;', 'precedes')),
		(s.succ = d('\\succ ', '&#8827;', 'succeeds')),
		(s.preceq = d('\\preceq ', '&#8828;', 'precedes or equals')),
		(s.succeq = d('\\succeq ', '&#8829;', 'succeeds or equals')),
		(s.simeq = d('\\simeq ', '&#8771;', 'similar or equal to')),
		(s.mid = d('\\mid ', '&#8739;', 'divides')),
		(s.ll = d('\\ll ', '&#8810;', 'll')),
		(s.gg = d('\\gg ', '&#8811;', 'gg')),
		(s.parallel = d('\\parallel ', '&#8741;', 'parallel with')),
		(s.nparallel = d('\\nparallel ', '&#8742;', 'not parallel with')),
		(s.bowtie = d('\\bowtie ', '&#8904;', 'bowtie')),
		(s.sqsubset = d('\\sqsubset ', '&#8847;', 'square subset')),
		(s.sqsupset = d('\\sqsupset ', '&#8848;', 'square superset')),
		(s.smile = d('\\smile ', '&#8995;', 'smile')),
		(s.sqsubseteq = d('\\sqsubseteq ', '&#8849;', 'square subset or equal to')),
		(s.sqsupseteq = d('\\sqsupseteq ', '&#8850;', 'square superset or equal to')),
		(s.doteq = d('\\doteq ', '&#8784;', 'dotted equals')),
		(s.frown = d('\\frown ', '&#8994;', 'frown')),
		(s.vdash = d('\\vdash ', '&#8870;', 'v dash')),
		(s.dashv = d('\\dashv ', '&#8867;', 'dash v')),
		(s.nless = d('\\nless ', '&#8814;', 'not less than')),
		(s.ngtr = d('\\ngtr ', '&#8815;', 'not greater than')),
		(s.longleftarrow = d('\\longleftarrow ', '&#8592;', 'left arrow')),
		(s.longrightarrow = d('\\longrightarrow ', '&#8594;', 'right arrow')),
		(s.Longleftarrow = d('\\Longleftarrow ', '&#8656;', 'left arrow')),
		(s.Longrightarrow = d('\\Longrightarrow ', '&#8658;', 'right arrow')),
		(s.longleftrightarrow = d('\\longleftrightarrow ', '&#8596;', 'left and right arrow')),
		(s.updownarrow = d('\\updownarrow ', '&#8597;', 'up and down arrow')),
		(s.Longleftrightarrow = d('\\Longleftrightarrow ', '&#8660;', 'left and right arrow')),
		(s.Updownarrow = d('\\Updownarrow ', '&#8661;', 'up and down arrow')),
		(s.mapsto = d('\\mapsto ', '&#8614;', 'maps to')),
		(s.nearrow = d('\\nearrow ', '&#8599;', 'northeast arrow')),
		(s.hookleftarrow = d('\\hookleftarrow ', '&#8617;', 'hook left arrow')),
		(s.hookrightarrow = d('\\hookrightarrow ', '&#8618;', 'hook right arrow')),
		(s.searrow = d('\\searrow ', '&#8600;', 'southeast arrow')),
		(s.leftharpoonup = d('\\leftharpoonup ', '&#8636;', 'left harpoon up')),
		(s.rightharpoonup = d('\\rightharpoonup ', '&#8640;', 'right harpoon up')),
		(s.swarrow = d('\\swarrow ', '&#8601;', 'southwest arrow')),
		(s.leftharpoondown = d('\\leftharpoondown ', '&#8637;', 'left harpoon down')),
		(s.rightharpoondown = d('\\rightharpoondown ', '&#8641;', 'right harpoon down')),
		(s.nwarrow = d('\\nwarrow ', '&#8598;', 'northwest arrow')),
		(s.ldots = d('\\ldots ', '&#8230;', 'l dots')),
		(s.cdots = d('\\cdots ', '&#8943;', 'c dots')),
		(s.vdots = d('\\vdots ', '&#8942;', 'v dots')),
		(s.ddots = d('\\ddots ', '&#8945;', 'd dots')),
		(s.surd = d('\\surd ', '&#8730;', 'unresolved root')),
		(s.triangle = d('\\triangle ', '&#9651;', 'triangle')),
		(s.ell = d('\\ell ', '&#8467;', 'ell')),
		(s.top = d('\\top ', '&#8868;', 'top')),
		(s.flat = d('\\flat ', '&#9837;', 'flat')),
		(s.natural = d('\\natural ', '&#9838;', 'natural')),
		(s.sharp = d('\\sharp ', '&#9839;', 'sharp')),
		(s.wp = d('\\wp ', '&#8472;', 'wp')),
		(s.bot = d('\\bot ', '&#8869;', 'bot')),
		(s.clubsuit = d('\\clubsuit ', '&#9827;', 'club suit')),
		(s.diamondsuit = d('\\diamondsuit ', '&#9826;', 'diamond suit')),
		(s.heartsuit = d('\\heartsuit ', '&#9825;', 'heart suit')),
		(s.spadesuit = d('\\spadesuit ', '&#9824;', 'spade suit')),
		(s.parallelogram = d('\\parallelogram ', '&#9649;', 'parallelogram')),
		(s.square = d('\\square ', '&#11036;', 'square')),
		(s.oint = d('\\oint ', '&#8750;', 'o int')),
		(s.bigcap = d('\\bigcap ', '&#8745;', 'big cap')),
		(s.bigcup = d('\\bigcup ', '&#8746;', 'big cup')),
		(s.bigsqcup = d('\\bigsqcup ', '&#8852;', 'big square cup')),
		(s.bigvee = d('\\bigvee ', '&#8744;', 'big vee')),
		(s.bigwedge = d('\\bigwedge ', '&#8743;', 'big wedge')),
		(s.bigodot = d('\\bigodot ', '&#8857;', 'big o dot')),
		(s.bigotimes = d('\\bigotimes ', '&#8855;', 'big o times')),
		(s.bigoplus = d('\\bigoplus ', '&#8853;', 'big o plus')),
		(s.biguplus = d('\\biguplus ', '&#8846;', 'big u plus')),
		(s.lfloor = d('\\lfloor ', '&#8970;', 'left floor')),
		(s.rfloor = d('\\rfloor ', '&#8971;', 'right floor')),
		(s.lceil = d('\\lceil ', '&#8968;', 'left ceiling')),
		(s.rceil = d('\\rceil ', '&#8969;', 'right ceiling')),
		(s.opencurlybrace = s.lbrace = d('\\lbrace ', '{', 'left brace')),
		(s.closecurlybrace = s.rbrace = d('\\rbrace ', '}', 'right brace')),
		(s.lbrack = d('[', 'left bracket')),
		(s.rbrack = d(']', 'right bracket')),
		(s.slash = d('/', 'slash')),
		(s.vert = d('|', 'vertical bar')),
		(s.perp = s.perpendicular = d('\\perp ', '&perp;', 'perpendicular')),
		(s.nabla = s.del = d('\\nabla ', '&nabla;')),
		(s.hbar = d('\\hbar ', '&#8463;', 'horizontal bar')),
		(s.AA = s.Angstrom = s.angstrom = d('\\text\\AA ', '&#8491;', 'AA')),
		(s.ring = s.circ = s.circle = d('\\circ ', '&#8728;', 'circle')),
		(s.bull = s.bullet = d('\\bullet ', '&bull;', 'bullet')),
		(s.setminus = s.smallsetminus = d('\\setminus ', '&#8726;', 'set minus')),
		(s.not = s['\xAC'] = s.neg = d('\\neg ', '&not;', 'not')),
		(s['\u2026'] =
			s.dots =
			s.ellip =
			s.hellip =
			s.ellipsis =
			s.hellipsis =
				d('\\dots ', '&hellip;', 'ellipsis')),
		(s.converges =
			s.darr =
			s.dnarr =
			s.dnarrow =
			s.downarrow =
				d('\\downarrow ', '&darr;', 'converges with')),
		(s.dArr = s.dnArr = s.dnArrow = s.Downarrow = d('\\Downarrow ', '&dArr;', 'down arrow')),
		(s.diverges = s.uarr = s.uparrow = d('\\uparrow ', '&uarr;', 'diverges from')),
		(s.uArr = s.Uparrow = d('\\Uparrow ', '&uArr;', 'up arrow')),
		(s.rarr = s.rightarrow = d('\\rightarrow ', '&rarr;', 'right arrow')),
		(s.implies = D('\\Rightarrow ', '&rArr;', 'implies')),
		(s.rArr = s.Rightarrow = d('\\Rightarrow ', '&rArr;', 'right arrow')),
		(s.gets = D('\\gets ', '&larr;', 'gets')),
		(s.larr = s.leftarrow = d('\\leftarrow ', '&larr;', 'left arrow')),
		(s.impliedby = D('\\Leftarrow ', '&lArr;', 'implied by')),
		(s.lArr = s.Leftarrow = d('\\Leftarrow ', '&lArr;', 'left arrow')),
		(s.harr =
			s.lrarr =
			s.leftrightarrow =
				d('\\leftrightarrow ', '&harr;', 'left and right arrow')),
		(s.iff = D('\\Leftrightarrow ', '&hArr;', 'if and only if')),
		(s.hArr =
			s.lrArr =
			s.Leftrightarrow =
				d('\\Leftrightarrow ', '&hArr;', 'left and right arrow')),
		(s.Re = s.Real = s.real = d('\\Re ', '&real;', 'real')),
		(s.Im =
			s.imag =
			s.image =
			s.imagin =
			s.imaginary =
			s.Imaginary =
				d('\\Im ', '&image;', 'imaginary')),
		(s.part = s.partial = d('\\partial ', '&part;', 'partial')),
		(s.pounds = d('\\pounds ', '&pound;')),
		(s.alef = s.alefsym = s.aleph = s.alephsym = d('\\aleph ', '&alefsym;', 'alef sym')),
		(s.xist = s.xists = s.exist = s.exists = d('\\exists ', '&exist;', 'there exists at least 1')),
		(s.nexists = s.nexist = d('\\nexists ', '&#8708;', 'there is no')),
		(s.and = s.land = s.wedge = D('\\wedge ', '&and;', 'and')),
		(s.or = s.lor = s.vee = D('\\vee ', '&or;', 'or')),
		(s.o =
			s.O =
			s.empty =
			s.emptyset =
			s.oslash =
			s.Oslash =
			s.nothing =
			s.varnothing =
				D('\\varnothing ', '&empty;', 'nothing')),
		(s.cup = s.union = D('\\cup ', '&cup;', 'union')),
		(s.cap = s.intersect = s.intersection = D('\\cap ', '&cap;', 'intersection')),
		(s.deg = s.degree = d('\\degree ', '&deg;', 'degrees')),
		(s.ang = s.angle = d('\\angle ', '&ang;', 'angle')),
		(s.measuredangle = d('\\measuredangle ', '&#8737;', 'measured angle')),
		(At = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.finalizeTree = function (t, e) {
					this.sharedSiblingMethod(t, e);
				}),
				(n.prototype.siblingDeleted = function (t, e) {
					this.sharedSiblingMethod(t, e);
				}),
				(n.prototype.siblingCreated = function (t, e) {
					this.sharedSiblingMethod(t, e);
				}),
				(n.prototype.sharedSiblingMethod = function (t, e) {
					(e !== l && this[c] instanceof n) || this.fixDigitGrouping(t);
				}),
				(n.prototype.fixDigitGrouping = function (t) {
					var e, r, i, a, u, p, h, m;
					if (t.enableDigitGrouping) {
						(e = this), (r = this), (i = 0), (a = []), (u = '\\ '), (p = '.'), (h = e);
						do
							if (/^[0-9]$/.test(h.ctrlSeq)) e = h;
							else if (h.ctrlSeq === u) (e = h), (i += 1);
							else {
								if (h.ctrlSeq !== p) break;
								(e = h), a.push(h);
							}
						while ((h = e[l]));
						for (; (h = r[c]); )
							if (/^[0-9]$/.test(h.ctrlSeq)) r = h;
							else if (h.ctrlSeq === u) (r = h), (i += 1);
							else {
								if (h.ctrlSeq !== p) break;
								(r = h), a.push(h);
							}
						for (; r !== e && e && e.ctrlSeq === u; ) (e = e[c]), (i -= 1);
						for (; r !== e && r && r.ctrlSeq === u; ) (r = r[l]), (i -= 1);
						(e === r && e && e.ctrlSeq === u) ||
							((m = i > 0 || a.length > 1),
							m
								? this.removeGroupingBetween(e, r)
								: a[0]
								? (a[0] !== e && this.addGroupingBetween(a[0][l], e),
								  a[0] !== r && this.removeGroupingBetween(a[0][c], r))
								: this.addGroupingBetween(r, e));
					}
				}),
				(n.prototype.removeGroupingBetween = function (t, e) {
					var r = t;
					do if ((r instanceof n && r.setGroupingClass(void 0), !r || r === e)) break;
					while ((r = r[c]));
				}),
				(n.prototype.addGroupingBetween = function (t, e) {
					var r,
						i,
						a = t,
						u = 0,
						p = 0;
					for (a = t; a && ((p += 1), a !== e); ) a = a[l];
					for (
						r = p % 3, r === 0 && (r = 3), a = t;
						a &&
						((u += 1),
						(i = void 0),
						p >= 4 &&
							(u === p
								? (i = 'mq-group-leading-' + r)
								: u % 3 == 0 && u !== p && (i = 'mq-group-start'),
							i || (i = 'mq-group-other')),
						a instanceof n && a.setGroupingClass(i),
						a !== e);

					)
						a = a[l];
				}),
				(n.prototype.setGroupingClass = function (t) {
					this._groupingClass !== t &&
						(this._groupingClass && this.domFrag().removeClass(this._groupingClass),
						t && this.domFrag().addClass(t),
						(this._groupingClass = t));
				}),
				n
			);
		})(V)),
		(Ot = (function (o) {
			function n(t, e) {
				return o.call(this, t, f('span', { class: 'mq-digit' }, [f.text(t)]), void 0, e) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.createLeftOf = function (t) {
					var e = t[l],
						r = e && e[l],
						i = t.parent.parent instanceof J ? t.parent.parent.sub : void 0;
					t.options.autoSubscriptNumerals &&
					t.parent !== i &&
					((e instanceof ct && e.isItalic !== !1) ||
						(e instanceof J && r instanceof ct && r.isItalic !== !1))
						? (new le().createLeftOf(t),
						  o.prototype.createLeftOf.call(this, t),
						  t.insRightOf(t.parent.parent))
						: o.prototype.createLeftOf.call(this, t);
				}),
				(n.prototype.mathspeak = function (t) {
					var e, r, i, a;
					return t &&
						t.createdLeftOf &&
						((e = t.createdLeftOf),
						(r = e[l]),
						(i = r && r[l]),
						(a = e.parent.parent instanceof J ? e.parent.parent.sub : void 0),
						e.options.autoSubscriptNumerals &&
							e.parent !== a &&
							((r instanceof ct && r.isItalic !== !1) ||
								(e[l] instanceof J && i instanceof ct && i.isItalic !== !1)))
						? 'Subscript ' + o.prototype.mathspeak.call(this) + ' Baseline'
						: o.prototype.mathspeak.call(this);
				}),
				n
			);
		})(At)),
		(ct = (function (o) {
			function n(t, e) {
				return o.call(this, t, f('var', {}, [e || f.text(t)])) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.text = function () {
					var t = this.ctrlSeq || '';
					return (
						this.isPartOfOperator
							? t[0] == '\\'
								? (t = t.slice(1, t.length))
								: t[t.length - 1] == ' ' && (t = t.slice(0, -1))
							: (!this[l] ||
									this[l] instanceof n ||
									this[l] instanceof P ||
									this[l].ctrlSeq === '\\ ' ||
									(t = '*' + t),
							  !this[c] || this[c] instanceof P || this[c] instanceof J || (t += '*')),
						t
					);
				}),
				(n.prototype.mathspeak = function () {
					var t = this.ctrlSeq || '';
					return this.isPartOfOperator ||
						t.length > 1 ||
						(this.parent && this.parent.parent && this.parent.parent.isTextBlock())
						? o.prototype.mathspeak.call(this)
						: '"' + t + '"';
				}),
				n
			);
		})(V)),
		(z.prototype.autoCommands = { _maxLength: 0 }),
		(st.autoCommands = function (o) {
			var n, t, e, r, i;
			if (typeof o != 'string' || !/^[a-z]+(?: [a-z]+)*$/i.test(o))
				throw '"' + o + '" not a space-delimited list of only letters';
			for (n = o.split(' '), t = {}, e = 0, r = 0; r < n.length; r += 1) {
				if (((i = n[r]), i.length < 2)) throw 'autocommand "' + i + '" not minimum length of 2';
				if (s[i] === Jt) throw '"' + i + '" is a built-in operator name';
				(t[i] = 1), (e = Rt(e, i.length));
			}
			return (t._maxLength = e), t;
		}),
		(z.prototype.quietEmptyDelimiters = {}),
		(st.quietEmptyDelimiters = function (o) {
			var n, t, e, r;
			for (o === void 0 && (o = ''), n = o.split(' '), t = {}, e = 0; e < n.length; e += 1)
				(r = n[e]), (t[r] = 1);
			return t;
		}),
		(z.prototype.autoParenthesizedFunctions = { _maxLength: 0 }),
		(st.autoParenthesizedFunctions = function (o) {
			var n, t, e, r, i;
			if (typeof o != 'string' || !/^[a-z]+(?: [a-z]+)*$/i.test(o))
				throw '"' + o + '" not a space-delimited list of only letters';
			for (n = o.split(' '), t = {}, e = 0, r = 0; r < n.length; r += 1) {
				if (((i = n[r]), i.length < 2)) throw 'autocommand "' + i + '" not minimum length of 2';
				(t[i] = 1), (e = Rt(e, i.length));
			}
			return (t._maxLength = e), t;
		}),
		(pt = (function (o) {
			function n(t) {
				var e = o.call(this, t) || this;
				return (e.letter = t), e;
			}
			return (
				__extends(n, o),
				(n.prototype.checkAutoCmds = function (t) {
					var e, r, i, a, u, p, h;
					if (
						!this.shouldIgnoreSubstitutionInSimpleSubscript(t.options) &&
						((e = t.options.autoCommands), (r = e._maxLength || 0) > 0)
					) {
						for (i = '', a = this, u = 0; a instanceof n && a.ctrlSeq === a.letter && u < r; )
							(i = a.letter + i), (a = a[l]), (u += 1);
						for (; i.length; ) {
							if (e.hasOwnProperty(i)) {
								for (a = this, u = 1; a && u < i.length; u += 1, a = a[l]);
								return (
									new I(a, this).remove(),
									(t[l] = a[l]),
									(p = s[i]),
									(h = zt(p) ? new p(i) : p(i)),
									h.createLeftOf(t)
								);
							}
							i = i.slice(1);
						}
					}
				}),
				(n.prototype.autoParenthesize = function (t) {
					var e,
						r,
						i,
						a,
						u,
						p,
						h = t.parent.getEnd(c);
					if (
						!(
							(h && h instanceof tt && h.ctrlSeq === '\\left(') ||
							this.shouldIgnoreSubstitutionInSimpleSubscript(t.options)
						)
					) {
						for (
							e = '',
								r = this,
								i = 0,
								a = t.options.autoParenthesizedFunctions,
								u = a._maxLength || 0,
								p = t.options.autoOperatorNames;
							r instanceof n && i < u;

						)
							(e = r.letter + e), (r = r[l]), (i += 1);
						for (; e.length; ) {
							if (a.hasOwnProperty(e) && p.hasOwnProperty(e)) return t.parent.write(t, '(');
							e = e.slice(1);
						}
					}
				}),
				(n.prototype.createLeftOf = function (t) {
					o.prototype.createLeftOf.call(this, t), this.checkAutoCmds(t), this.autoParenthesize(t);
				}),
				(n.prototype.italicize = function (t) {
					return (
						(this.isItalic = t),
						(this.isPartOfOperator = !t),
						this.domFrag().toggleClass('mq-operator-name', !t),
						this
					);
				}),
				(n.prototype.finalizeTree = function (t, e) {
					this.sharedSiblingMethod(t, e);
				}),
				(n.prototype.siblingDeleted = function (t, e) {
					this.sharedSiblingMethod(t, e);
				}),
				(n.prototype.siblingCreated = function (t, e) {
					this.sharedSiblingMethod(t, e);
				}),
				(n.prototype.sharedSiblingMethod = function (t, e) {
					(e !== l && this[c] instanceof n) || this.autoUnItalicize(t);
				}),
				(n.prototype.autoUnItalicize = function (t) {
					var e,
						r,
						i,
						a,
						u,
						p,
						h,
						m,
						y,
						w,
						g,
						v,
						b,
						x,
						q,
						L,
						A,
						S,
						_ = t.autoOperatorNames;
					if (_._maxLength !== 0 && !this.shouldIgnoreSubstitutionInSimpleSubscript(t)) {
						for (e = this.letter, r = this[l]; r instanceof n; r = r[l]) e = r.letter + e;
						for (i = this[c]; i instanceof n; i = i[c]) e += i.letter;
						(a = r && r[c]),
							(u = i && i[l]),
							new I(a || this.parent.getEnd(l), u || this.parent.getEnd(c)).each(function (C) {
								C instanceof n &&
									(C.italicize(!0).domFrag().removeClass('mq-first mq-last mq-followed-by-supsub'),
									(C.ctrlSeq = C.letter));
							}),
							(p = _._maxLength || 0);
						t: for (h = 0, m = r[c] || this.parent.getEnd(l); m && h < e.length; h += 1, m = m[c])
							for (y = nn(p, e.length - h); y > 0; y -= 1)
								if (((w = e.slice(h, h + y)), (g = void 0), _.hasOwnProperty(w))) {
									for (v = 0, b = m; v < y; v += 1, b = b[c])
										b instanceof n && (b.italicize(!1), (g = b));
									(x = _t.hasOwnProperty(w)),
										(m.ctrlSeq = (x ? '\\' : '\\operatorname{') + m.ctrlSeq),
										(g.ctrlSeq += x ? ' ' : '}'),
										Ve.hasOwnProperty(w) &&
											((q = g[l]),
											(L = q && q[l]),
											(A = L && L[l]),
											A.domFrag().addClass('mq-last')),
										this.shouldOmitPadding(m[l]) || m.domFrag().addClass('mq-first'),
										this.shouldOmitPadding(g[c]) ||
											(g[c] instanceof J
												? ((S = g[c]),
												  (S.siblingCreated = S.siblingDeleted =
														function () {
															S.domFrag().toggleClass(
																'mq-after-operator-name',
																!(S[c] instanceof tt)
															);
														})())
												: g.domFrag().toggleClass('mq-last', !(g[c] instanceof tt))),
										(h += y - 1),
										(m = g);
									continue t;
								}
					}
				}),
				(n.prototype.shouldOmitPadding = function (t) {
					return !t || t.ctrlSeq === '.' || t instanceof P || t instanceof ht;
				}),
				n
			);
		})(ct)),
		(_t = {}),
		(z.prototype.autoOperatorNames = (function () {
			var o,
				n,
				t,
				e,
				r = { _maxLength: 9 },
				i =
					'arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr'.split(
						' '
					);
			for (o = 0; o < i.length; o += 1) _t[i[o]] = r[i[o]] = 1;
			for (
				n = 'sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth'.split(' '), o = 0;
				o < n.length;
				o += 1
			)
				_t[n[o]] = 1;
			for (t = 'sin cos tan sec cosec csc cotan cot ctg'.split(' '), o = 0; o < t.length; o += 1)
				r[t[o]] =
					r['arc' + t[o]] =
					r[t[o] + 'h'] =
					r['ar' + t[o] + 'h'] =
					r['arc' + t[o] + 'h'] =
						1;
			for (e = 'gcf hcf lcm proj span'.split(' '), o = 0; o < e.length; o += 1) r[e[o]] = 1;
			return r;
		})()),
		(Ve = { limsup: 1, liminf: 1, projlim: 1, injlim: 1 }),
		(st.autoOperatorNames = function (o) {
			var n, t, e, r, i, a;
			if (typeof o != 'string') throw '"' + o + '" not a space-delimited list';
			if (!/^[a-z\|\-]+(?: [a-z\|\-]+)*$/i.test(o))
				throw '"' + o + '" not a space-delimited list of letters or "|"';
			for (n = o.split(' '), t = {}, e = 0, r = 0; r < n.length; r += 1) {
				if (((i = n[r]), i.length < 2)) throw '"' + i + '" not minimum length of 2';
				if (i.indexOf('|') < 0) (t[i] = i), (e = Rt(e, i.length));
				else {
					if (((a = i.split('|')), a.length > 2))
						throw '"' + i + '" has more than 1 mathspeak delimiter';
					if (a[0].length < 2) throw '"' + i[0] + '" not minimum length of 2';
					(t[a[0]] = a[1].replace(/-/g, ' ')), (e = Rt(e, a[0].length));
				}
			}
			return (t._maxLength = e), t;
		}),
		(Jt = (function (o) {
			function n(t) {
				return o.call(this, t || '') || this;
			}
			return (
				__extends(n, o),
				(n.prototype.createLeftOf = function (t) {
					var e,
						r = this.ctrlSeq;
					for (e = 0; e < r.length; e += 1) new pt(r.charAt(e)).createLeftOf(t);
				}),
				(n.prototype.parser = function () {
					var t,
						e = this.ctrlSeq,
						r = new R();
					for (t = 0; t < e.length; t += 1) new pt(e.charAt(t)).adopt(r, r.getEnd(c), 0);
					return k.succeed(r.children());
				}),
				n
			);
		})(V));
	for (te in z.prototype.autoOperatorNames)
		z.prototype.autoOperatorNames.hasOwnProperty(te) && (s[te] = Jt);
	if (
		((s.operatorname = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.createLeftOf = function () {}),
				(n.prototype.numBlocks = function () {
					return 1;
				}),
				(n.prototype.parser = function () {
					return G.block.map(function (t) {
						var e = !0,
							r = '',
							i = t.children();
						return (
							i.each(function (a) {
								a instanceof pt ? (r += a.letter) : (e = !1);
							}),
							e && r === 'ans' ? ue() : i
						);
					});
				}),
				n
			);
		})(M)),
		(s.f = (function (o) {
			function n() {
				var t = this,
					e = 'f';
				return (
					(t = o.call(this, e) || this),
					(t.letter = e),
					(t.domView = new N(0, function () {
						return f('var', { class: 'mq-f' }, [f.text('f')]);
					})),
					t
				);
			}
			return (
				__extends(n, o),
				(n.prototype.italicize = function (t) {
					return (
						this.domFrag().eachElement(function (e) {
							return (e.textContent = 'f');
						}),
						this.domFrag().toggleClass('mq-f', t),
						o.prototype.italicize.call(this, t)
					);
				}),
				n
			);
		})(pt)),
		(s[' '] = s.space =
			function () {
				return new At('\\ ', f('span', {}, [f.text(Vt)]), ' ');
			}),
		(s['.'] = function () {
			return new At('.', f('span', { class: 'mq-digit' }, [f.text('.')]), '.');
		}),
		(s["'"] = s.prime = d("'", '&prime;', 'prime')),
		(s['\u2033'] = s.dprime = d('\u2033', '&Prime;', 'double prime')),
		(s.backslash = d('\\backslash ', '\\', 'backslash')),
		rt['\\'] || (rt['\\'] = s.backslash),
		(s.$ = d('\\$', '$', 'dollar')),
		(s.square = d('\\square ', '\u25A1', 'square')),
		(s.mid = d('\\mid ', '\u2223', 'mid')),
		(vt = (function (o) {
			function n(t, e, r) {
				return o.call(this, t, f('span', { class: 'mq-nonSymbola' }, [e || f.text(t)])) || this;
			}
			return __extends(n, o), n;
		})(V)),
		(s['@'] = function () {
			return new vt('@');
		}),
		(s['&'] = function () {
			return new vt('\\&', f.entityText('&amp;'), 'and');
		}),
		(s['%'] = (function (o) {
			function n() {
				return o.call(this, '\\%', f.text('%'), 'percent') || this;
			}
			return (
				__extends(n, o),
				(n.prototype.parser = function () {
					var t = k.optWhitespace,
						e = k.string;
					return t
						.then(
							e('\\operatorname{of}').map(function () {
								return ce();
							})
						)
						.or(o.prototype.parser.call(this));
				}),
				n
			);
		})(vt)),
		(s['\u2225'] = s.parallel = d('\\parallel ', '&#x2225;', 'parallel')),
		(s['\u2226'] = s.nparallel = d('\\nparallel ', '&#x2226;', 'not parallel')),
		(s['\u27C2'] = s.perp = d('\\perp ', '&#x27C2;', 'perpendicular')),
		(s.alpha =
			s.beta =
			s.gamma =
			s.delta =
			s.zeta =
			s.eta =
			s.theta =
			s.iota =
			s.kappa =
			s.mu =
			s.nu =
			s.xi =
			s.rho =
			s.sigma =
			s.tau =
			s.chi =
			s.psi =
			s.omega =
				function (o) {
					return new ct('\\' + o + ' ', f.entityText('&' + o + ';'));
				}),
		(s.phi = nt('\\phi ', '&#981;', 'phi')),
		(s.phiv = s.varphi = nt('\\varphi ', '&phi;', 'phi')),
		(s.epsilon = nt('\\epsilon ', '&#1013;', 'epsilon')),
		(s.epsiv = s.varepsilon = nt('\\varepsilon ', '&epsilon;', 'epsilon')),
		(s.piv = s.varpi = nt('\\varpi ', '&piv;', 'piv')),
		(s.sigmaf = s.sigmav = s.varsigma = nt('\\varsigma ', '&sigmaf;', 'sigma')),
		(s.thetav = s.vartheta = s.thetasym = nt('\\vartheta ', '&thetasym;', 'theta')),
		(s.upsilon = s.upsi = nt('\\upsilon ', '&upsilon;', 'upsilon')),
		(s.gammad = s.Gammad = s.digamma = nt('\\digamma ', '&#989;', 'gamma')),
		(s.kappav = s.varkappa = nt('\\varkappa ', '&#1008;', 'kappa')),
		(s.rhov = s.varrho = nt('\\varrho ', '&#1009;', 'rho')),
		(s.pi = s.π =
			function () {
				return new vt('\\pi ', f.entityText('&pi;'), 'pi');
			}),
		(s.lambda = function () {
			return new vt('\\lambda ', f.entityText('&lambda;'), 'lambda');
		}),
		(s.Upsilon =
			s.Upsi =
			s.upsih =
			s.Upsih =
				function () {
					return new V(
						'\\Upsilon ',
						f('var', { style: 'font-family: serif' }, [f.entityText('&upsih;')]),
						'capital upsilon'
					);
				}),
		(s.Gamma =
			s.Delta =
			s.Theta =
			s.Lambda =
			s.Xi =
			s.Pi =
			s.Sigma =
			s.Phi =
			s.Psi =
			s.Omega =
			s.forall =
				function (o) {
					return new it('\\' + o + ' ', f.entityText('&' + o + ';'));
				}),
		(H = (function (o) {
			function n(t) {
				var e = o.call(this) || this;
				return (e.latexStr = t), e;
			}
			return (
				__extends(n, o),
				(n.prototype.createLeftOf = function (t) {
					var e,
						r,
						i,
						a,
						u = G.parse(this.latexStr);
					u.children().adopt(t.parent, t[l], t[c]),
						(t[l] = u.getEnd(c)),
						O(u.html()).insertBefore(t.domFrag()),
						u.finalizeInsert(t.options, t),
						(e = u.getEnd(c)),
						(r = e && e[c]),
						r && r.siblingCreated(t.options, l),
						(i = u.getEnd(l)),
						(a = i && i[l]),
						a && a.siblingCreated(t.options, c),
						t.parent.bubble(function (p) {
							p.reflow();
						});
				}),
				(n.prototype.mathspeak = function () {
					return G.parse(this.latexStr).mathspeak();
				}),
				(n.prototype.parser = function () {
					var t = G.parse(this.latexStr).children();
					return k.succeed(t);
				}),
				n
			);
		})(M)),
		(s['\u2070'] = function () {
			return new H('^0');
		}),
		(s['\xB9'] = function () {
			return new H('^1');
		}),
		(s['\xB2'] = function () {
			return new H('^2');
		}),
		(s['\xB3'] = function () {
			return new H('^3');
		}),
		(s['\u2074'] = function () {
			return new H('^4');
		}),
		(s['\u2075'] = function () {
			return new H('^5');
		}),
		(s['\u2076'] = function () {
			return new H('^6');
		}),
		(s['\u2077'] = function () {
			return new H('^7');
		}),
		(s['\u2078'] = function () {
			return new H('^8');
		}),
		(s['\u2079'] = function () {
			return new H('^9');
		}),
		(s['\xBC'] = function () {
			return new H('\\frac14');
		}),
		(s['\xBD'] = function () {
			return new H('\\frac12');
		}),
		(s['\xBE'] = function () {
			return new H('\\frac34');
		}),
		(s['\u221A'] = function () {
			return new H('\\sqrt{}');
		}),
		(wt = (function (o) {
			function n(t, e, r) {
				return o.call(this, t, e, void 0, r, !0) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.contactWeld = function (t, e) {
					this.sharedSiblingMethod(t.options, e);
				}),
				(n.prototype.siblingCreated = function (t, e) {
					this.sharedSiblingMethod(t, e);
				}),
				(n.prototype.siblingDeleted = function (t, e) {
					this.sharedSiblingMethod(t, e);
				}),
				(n.prototype.sharedSiblingMethod = function (t, e) {
					if (e !== c)
						return (
							(this.domFrag().oneElement().className = Tt(this) ? 'mq-binary-operator' : ''), this
						);
				}),
				n
			);
		})(P)),
		(s['+'] = (function (o) {
			function n() {
				return o.call(this, '+', f.text('+')) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.mathspeak = function () {
					return Tt(this) ? 'plus' : 'positive';
				}),
				n
			);
		})(wt)),
		(ee = (function (o) {
			function n() {
				return o.call(this, '-', f.entityText('&minus;')) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.mathspeak = function () {
					return Tt(this) ? 'minus' : 'negative';
				}),
				n
			);
		})(wt)),
		(s['\u2212'] = s['\u2014'] = s['\u2013'] = s['-'] = ee),
		(s['\xB1'] =
			s.pm =
			s.plusmn =
			s.plusminus =
				function () {
					return new wt('\\pm ', f.entityText('&plusmn;'), 'plus-or-minus');
				}),
		(s.mp =
			s.mnplus =
			s.minusplus =
				function () {
					return new wt('\\mp ', f.entityText('&#8723;'), 'minus-or-plus');
				}),
		(rt['*'] = s.sdot = s.cdot = D('\\cdot ', '&middot;', '*', 'times')),
		(ne = (function (o) {
			function n() {
				return o.call(this, '\\to ', f.entityText('&rarr;'), 'to') || this;
			}
			return (
				__extends(n, o),
				(n.prototype.deleteTowards = function (t, e) {
					if (t === l) {
						var r = e[l];
						return (
							new I(r, this).remove(),
							(e[l] = r[l]),
							new ee().createLeftOf(e),
							void e[l].bubble(function (i) {
								i.reflow();
							})
						);
					}
					o.prototype.deleteTowards.call(this, t, e);
				}),
				n
			);
		})(P)),
		(s['\u2192'] = s.to = ne),
		(bt = (function (o) {
			function n(t, e) {
				var r = this,
					i = e ? 'Strict' : '';
				return (
					(r =
						o.call(
							this,
							t['ctrlSeq'.concat(i)],
							f.entityText(t['htmlEntity'.concat(i)]),
							t['text'.concat(i)],
							t['mathspeak'.concat(i)]
						) || this),
					(r.data = t),
					(r.strict = e),
					r
				);
			}
			return (
				__extends(n, o),
				(n.prototype.swap = function (t) {
					this.strict = t;
					var e = t ? 'Strict' : '';
					(this.ctrlSeq = this.data['ctrlSeq'.concat(e)]),
						this.domFrag()
							.children()
							.replaceWith(O(f.entityText(this.data['htmlEntity'.concat(e)]))),
						(this.textTemplate = [this.data['text'.concat(e)]]),
						(this.mathspeakName = this.data['mathspeak'.concat(e)]);
				}),
				(n.prototype.deleteTowards = function (t, e) {
					if (t === l && !this.strict)
						return (
							this.swap(!0),
							void this.bubble(function (r) {
								r.reflow();
							})
						);
					o.prototype.deleteTowards.call(this, t, e);
				}),
				n
			);
		})(P)),
		(re = {
			ctrlSeq: '\\le ',
			htmlEntity: '&le;',
			text: '\u2264',
			mathspeak: 'less than or equal to',
			ctrlSeqStrict: '<',
			htmlEntityStrict: '&lt;',
			textStrict: '<',
			mathspeakStrict: 'less than'
		}),
		(oe = {
			ctrlSeq: '\\ge ',
			htmlEntity: '&ge;',
			text: '\u2265',
			mathspeak: 'greater than or equal to',
			ctrlSeqStrict: '>',
			htmlEntityStrict: '&gt;',
			textStrict: '>',
			mathspeakStrict: 'greater than'
		}),
		(je = (function (o) {
			function n() {
				return o.call(this, oe, !0) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.createLeftOf = function (t) {
					var e,
						r = t[l];
					if (r instanceof P && r.ctrlSeq === '-')
						return (
							(e = r),
							(t[l] = e[l]),
							e.remove(),
							new ne().createLeftOf(t),
							void t[l].bubble(function (i) {
								i.reflow();
							})
						);
					o.prototype.createLeftOf.call(this, t);
				}),
				n
			);
		})(bt)),
		(s['<'] = s.lt =
			function () {
				return new bt(re, !0);
			}),
		(s['>'] = s.gt = je),
		(s['\u2264'] =
			s.le =
			s.leq =
				function () {
					return new bt(re, !1);
				}),
		(s['\u2265'] =
			s.ge =
			s.geq =
				function () {
					return new bt(oe, !1);
				}),
		(s.infty = s.infin = s.infinity = d('\\infty ', '&infin;', 'infinity')),
		(s['\u2260'] = s.ne = s.neq = D('\\ne ', '&ne;', 'not equal')),
		(ie = (function (o) {
			function n() {
				return o.call(this, '=', f.text('='), '=', 'equals') || this;
			}
			return (
				__extends(n, o),
				(n.prototype.createLeftOf = function (t) {
					var e = t[l];
					if (e instanceof bt && e.strict)
						return (
							e.swap(!1),
							void e.bubble(function (r) {
								r.reflow();
							})
						);
					o.prototype.createLeftOf.call(this, t);
				}),
				n
			);
		})(P)),
		(s['='] = ie),
		(s['\xD7'] = s.times = D('\\times ', '&times;', '[x]', 'times')),
		(s['\xF7'] = s.div = s.divide = s.divides = D('\\div ', '&divide;', '[/]', 'over')),
		(se = (function (o) {
			function n() {
				return o.call(this, '\\sim ', f.text('~'), '~', 'tilde') || this;
			}
			return (
				__extends(n, o),
				(n.prototype.createLeftOf = function (t) {
					if (t[l] instanceof n) {
						var e = t[l];
						return (
							(t[l] = e[l]),
							e.remove(),
							new ae().createLeftOf(t),
							void t[l].bubble(function (r) {
								r.reflow();
							})
						);
					}
					o.prototype.createLeftOf.call(this, t);
				}),
				n
			);
		})(P)),
		(ae = (function (o) {
			function n() {
				return (
					o.call(this, '\\approx ', f.entityText('&approx;'), '\u2248', 'approximately equal') ||
					this
				);
			}
			return (
				__extends(n, o),
				(n.prototype.deleteTowards = function (t, e) {
					if (t === l) {
						var r = e[l];
						return (
							new I(r, this).remove(),
							(e[l] = r[l]),
							new se().createLeftOf(e),
							void e[l].bubble(function (i) {
								i.reflow();
							})
						);
					}
					o.prototype.deleteTowards.call(this, t, e);
				}),
				n
			);
		})(P)),
		(s.tildeNbsp = d('~', Vt, ' ')),
		(s.sim = se),
		(s['\u2248'] = s.approx = ae),
		(rt['~'] = s.sim),
		(s['~'] = s.tildeNbsp),
		(st.interpretTildeAsSim = function (o) {
			var n = !!o;
			return (s['~'] = n ? s.sim : s.tildeNbsp), n;
		}),
		(xt = {
			sqrt: {
				width: '',
				html: function () {
					return f('svg', { preserveAspectRatio: 'none', viewBox: '0 0 32 54' }, [
						f('path', { d: 'M0 33 L7 27 L12.5 47 L13 47 L30 0 L32 0 L13 54 L11 54 L4.5 31 L0 33' })
					]);
				}
			},
			'|': {
				width: '.4em',
				html: function () {
					return f('svg', { preserveAspectRatio: 'none', viewBox: '0 0 10 54' }, [
						f('path', { d: 'M4.4 0 L4.4 54 L5.6 54 L5.6 0' })
					]);
				}
			},
			'[': {
				width: '.55em',
				html: function () {
					return f('svg', { preserveAspectRatio: 'none', viewBox: '0 0 11 24' }, [
						f('path', { d: 'M8 0 L3 0 L3 24 L8 24 L8 23 L4 23 L4 1 L8 1' })
					]);
				}
			},
			']': {
				width: '.55em',
				html: function () {
					return f('svg', { preserveAspectRatio: 'none', viewBox: '0 0 11 24' }, [
						f('path', { d: 'M3 0 L8 0 L8 24 L3 24 L3 23 L7 23 L7 1 L3 1' })
					]);
				}
			},
			'(': {
				width: '.55em',
				html: function () {
					return f('svg', { preserveAspectRatio: 'none', viewBox: '3 0 106 186' }, [
						f('path', { d: 'M85 0 A61 101 0 0 0 85 186 L75 186 A75 101 0 0 1 75 0' })
					]);
				}
			},
			')': {
				width: '.55em',
				html: function () {
					return f('svg', { preserveAspectRatio: 'none', viewBox: '3 0 106 186' }, [
						f('path', { d: 'M24 0 A61 101 0 0 1 24 186 L34 186 A75 101 0 0 0 34 0' })
					]);
				}
			},
			'{': {
				width: '.7em',
				html: function () {
					return f('svg', { preserveAspectRatio: 'none', viewBox: '10 0 210 350' }, [
						f('path', {
							d: 'M170 0 L170 6 A47 52 0 0 0 123 60 L123 127 A35 48 0 0 1 88 175 A35 48 0 0 1 123 223 L123 290 A47 52 0 0 0 170 344 L170 350 L160 350 A58 49 0 0 1 102 301 L103 220 A45 40 0 0 0 58 180 L58 170 A45 40 0 0 0 103 130 L103 49 A58 49 0 0 1 161 0'
						})
					]);
				}
			},
			'}': {
				width: '.7em',
				html: function () {
					return f('svg', { preserveAspectRatio: 'none', viewBox: '10 0 210 350' }, [
						f('path', {
							d: 'M60 0 L60 6 A47 52 0 0 1 107 60 L107 127 A35 48 0 0 0 142 175 A35 48 0 0 0 107 223 L107 290 A47 52 0 0 1 60 344 L60 350 L70 350 A58 49 0 0 0 128 301 L127 220 A45 40 0 0 1 172 180 L172 170 A45 40 0 0 1 127 130 L127 49 A58 49 0 0 0 70 0'
						})
					]);
				}
			},
			'&#8741;': {
				width: '.7em',
				html: function () {
					return f('svg', { preserveAspectRatio: 'none', viewBox: '0 0 10 54' }, [
						f('path', { d: 'M3.2 0 L3.2 54 L4 54 L4 0 M6.8 0 L6.8 54 L6 54 L6 0' })
					]);
				}
			},
			'&lang;': {
				width: '.55em',
				html: function () {
					return f('svg', { preserveAspectRatio: 'none', viewBox: '0 0 10 54' }, [
						f('path', { d: 'M6.8 0 L3.2 27 L6.8 54 L7.8 54 L4.2 27 L7.8 0' })
					]);
				}
			},
			'&rang;': {
				width: '.55em',
				html: function () {
					return f('svg', { preserveAspectRatio: 'none', viewBox: '0 0 10 54' }, [
						f('path', { d: 'M3.2 0 L6.8 27 L3.2 54 L2.2 54 L5.8 27 L2.2 0' })
					]);
				}
			}
		}),
		(X = (function (o) {
			function n(t, e, r, i, a) {
				var u =
					o.call(
						this,
						t,
						new N(1, function (p) {
							return f.block(e, r, p[0]);
						})
					) || this;
				return (
					(u.ariaLabel = i || t.replace(/^\\/, '')),
					(u.mathspeakTemplate = ['Start' + u.ariaLabel + ',', 'End' + u.ariaLabel]),
					(u.shouldNotSpeakDelimiters = a && a.shouldNotSpeakDelimiters),
					u
				);
			}
			return (
				__extends(n, o),
				(n.prototype.mathspeak = function (t) {
					return !this.shouldNotSpeakDelimiters || (t && t.ignoreShorthand)
						? o.prototype.mathspeak.call(this)
						: this.foldChildren('', function (e, r) {
								return e + ' ' + r.mathspeak(t);
						  }).trim();
				}),
				n
			);
		})(M)),
		(s.mathrm = (function (o) {
			function n() {
				return (
					o.call(this, '\\mathrm', 'span', { class: 'mq-roman mq-font' }, 'Roman Font', {
						shouldNotSpeakDelimiters: !0
					}) || this
				);
			}
			return (
				__extends(n, o),
				(n.prototype.isTextBlock = function () {
					return !0;
				}),
				n
			);
		})(X)),
		(s.mathit = function () {
			return new X('\\mathit', 'i', { class: 'mq-font' }, 'Italic Font');
		}),
		(s.mathbf = function () {
			return new X('\\mathbf', 'b', { class: 'mq-font' }, 'Bold Font');
		}),
		(s.mathsf = function () {
			return new X('\\mathsf', 'span', { class: 'mq-sans-serif mq-font' }, 'Serif Font');
		}),
		(s.mathtt = function () {
			return new X('\\mathtt', 'span', { class: 'mq-monospace mq-font' }, 'Math Text');
		}),
		(s.underline = function () {
			return new X('\\underline', 'span', { class: 'mq-non-leaf mq-underline' }, 'Underline');
		}),
		(s.overline = s.bar =
			function () {
				return new X('\\overline', 'span', { class: 'mq-non-leaf mq-overline' }, 'Overline');
			}),
		(s.overrightarrow = function () {
			return new X(
				'\\overrightarrow',
				'span',
				{ class: 'mq-non-leaf mq-overarrow mq-arrow-right' },
				'Over Right Arrow'
			);
		}),
		(s.overleftarrow = function () {
			return new X(
				'\\overleftarrow',
				'span',
				{ class: 'mq-non-leaf mq-overarrow mq-arrow-left' },
				'Over Left Arrow'
			);
		}),
		(s.overleftrightarrow = function () {
			return new X(
				'\\overleftrightarrow ',
				'span',
				{ class: 'mq-non-leaf mq-overarrow mq-arrow-leftright' },
				'Over Left and Right Arrow'
			);
		}),
		(s.overarc = function () {
			return new X('\\overarc', 'span', { class: 'mq-non-leaf mq-overarc' }, 'Over Arc');
		}),
		(s.dot = function () {
			return new M(
				'\\dot',
				new N(1, function (o) {
					return f('span', { class: 'mq-non-leaf' }, [
						f('span', { class: 'mq-dot-recurring-inner' }, [
							f('span', { class: 'mq-dot-recurring' }, [f.text(ke)]),
							f.block('span', { class: 'mq-empty-box' }, o[0])
						])
					]);
				})
			);
		}),
		(s.textcolor = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.setColor = function (t) {
					(this.color = t),
						(this.domView = new N(1, function (e) {
							return f.block('span', { class: 'mq-textcolor', style: 'color:' + t }, e[0]);
						})),
						(this.ariaLabel = t.replace(/^\\/, '')),
						(this.mathspeakTemplate = ['Start ' + this.ariaLabel + ',', 'End ' + this.ariaLabel]);
				}),
				(n.prototype.latexRecursive = function (t) {
					this.checkCursorContextOpen(t);
					var e = this.blocks[0];
					(t.latex += '\\textcolor{' + this.color + '}{'),
						e.latexRecursive(t),
						(t.latex += '}'),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.parser = function () {
					var t = this,
						e = k.optWhitespace,
						r = k.string,
						i = k.regex;
					return e
						.then(r('{'))
						.then(i(/^[#\w\s.,()%-]*/))
						.skip(r('}'))
						.then(function (a) {
							return t.setColor(a), o.prototype.parser.call(t);
						});
				}),
				(n.prototype.isStyleBlock = function () {
					return !0;
				}),
				n
			);
		})(M)),
		(s.class = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.parser = function () {
					var t = this,
						e = k.string,
						r = k.regex;
					return k.optWhitespace
						.then(e('{'))
						.then(r(/^[-\w\s\\\xA0-\xFF]*/))
						.skip(e('}'))
						.then(function (i) {
							return (
								(t.cls = i || ''),
								(t.domView = new N(1, function (a) {
									return f.block('span', { class: 'mq-class '.concat(i) }, a[0]);
								})),
								(t.ariaLabel = i + ' class'),
								(t.mathspeakTemplate = ['Start ' + t.ariaLabel + ',', 'End ' + t.ariaLabel]),
								o.prototype.parser.call(t)
							);
						});
				}),
				(n.prototype.latexRecursive = function (t) {
					this.checkCursorContextOpen(t);
					var e = this.blocks[0];
					(t.latex += '\\class{' + this.cls + '}{'),
						e.latexRecursive(t),
						(t.latex += '}'),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.isStyleBlock = function () {
					return !0;
				}),
				n
			);
		})(M)),
		(St = /^[\+\-]?[\d]+$/),
		(z.prototype.charsThatBreakOutOfSupSub = ''),
		(J = (function (o) {
			function n() {
				var t = (o !== null && o.apply(this, arguments)) || this;
				return (t.ctrlSeq = '_{...}^{...}'), t;
			}
			return (
				__extends(n, o),
				(n.prototype.setEnds = function (t) {
					E('SupSub ends must be MathBlocks', t[l] instanceof R && t[c] instanceof R),
						(this.ends = t);
				}),
				(n.prototype.getEnd = function (t) {
					return this.ends[t];
				}),
				(n.prototype.createLeftOf = function (t) {
					if (this.replacedFragment || t[l] || !t.options.supSubsRequireOperand)
						return o.prototype.createLeftOf.call(this, t);
				}),
				(n.prototype.contactWeld = function (t) {
					var e, r, i, a, u, p, h;
					for (e = l; e; e = e === l && c)
						if (((r = this[e]), (i = void 0), r instanceof n)) {
							for (a = 'sub'; a; a = a === 'sub' && 'sup')
								(u = this[a]),
									(p = r[a]),
									u &&
										(p
											? u.isEmpty()
												? (i = new at(p, 0, p.getEnd(l)))
												: (u.domFrag().children().insAtDirEnd(-e, p.domFrag().oneElement()),
												  (h = u.children().disown()),
												  (i = new at(p, h.getEnd(c), p.getEnd(l))),
												  e === l ? h.adopt(p, p.getEnd(c), 0) : h.adopt(p, 0, p.getEnd(l)))
											: r.addBlock(u.disown()),
										(this.placeCursor = (function (m, y) {
											return function (w) {
												w.insAtDirEnd(-e, m || y);
											};
										})(p, u)));
							this.remove(),
								t &&
									t[l] === this &&
									(e === c && i
										? i[l]
											? t.insRightOf(i[l])
											: t.insAtLeftEnd(i.parent)
										: t.insRightOf(r));
							break;
						}
				}),
				(n.prototype.finalizeTree = function () {
					this.getEnd(l).write = function (t, e) {
						if (t.options.autoSubscriptNumerals && this === this.parent.sub) {
							if (e === '_') return;
							var r = this.chToCmd(e, t.options);
							return (
								r instanceof V ? t.deleteSelection() : t.clearSelection().insRightOf(this.parent),
								r.createLeftOf(t.show()),
								void t.controller.aria.queue('Baseline').alert(r.mathspeak({ createdLeftOf: t }))
							);
						}
						t[l] &&
							!t[c] &&
							!t.selection &&
							t.options.charsThatBreakOutOfSupSub.indexOf(e) > -1 &&
							(t.insRightOf(this.parent), t.controller.aria.queue('Baseline')),
							R.prototype.write.call(this, t, e);
					};
				}),
				(n.prototype.moveTowards = function (t, e, r) {
					e.options.autoSubscriptNumerals && !this.sup
						? e.insDirOf(t, this)
						: o.prototype.moveTowards.call(this, t, e, r);
				}),
				(n.prototype.deleteTowards = function (t, e) {
					if (e.options.autoSubscriptNumerals && this.sub) {
						var r = this.sub.getEnd(-t);
						r instanceof V ? r.remove() : r && r.deleteTowards(t, e.insAtDirEnd(-t, this.sub)),
							this.sub.isEmpty() &&
								(this.sub.deleteOutOf(l, e.insAtLeftEnd(this.sub)),
								this.sup && e.insDirOf(-t, this));
					} else o.prototype.deleteTowards.call(this, t, e);
				}),
				(n.prototype.latexRecursive = function (t) {
					var e, r;
					this.checkCursorContextOpen(t),
						this.sub &&
							((t.latex += '_{'),
							(e = t.latex.length),
							this.sub.latexRecursive(t),
							(r = t.latex.length),
							e === r && (t.latex += ' '),
							(t.latex += '}')),
						this.sup &&
							((t.latex += '^{'),
							(e = t.latex.length),
							this.sup.latexRecursive(t),
							(r = t.latex.length),
							e === r && (t.latex += ' '),
							(t.latex += '}')),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.text = function () {
					function t(e, r) {
						var i = (r && r.text()) || '';
						return r ? e + (i.length === 1 ? i : '(' + (i || ' ') + ')') : '';
					}
					return t('_', this.sub) + t('^', this.sup);
				}),
				(n.prototype.addBlock = function (t) {
					this.supsub === 'sub'
						? ((this.sup = this.upInto = this.sub.upOutOf = t),
						  (t.adopt(this, this.sub, 0).downOutOf = this.sub),
						  t.setDOM(
								O(f('span', { class: 'mq-sup' }))
									.append(t.domFrag().children())
									.prependTo(this.domFrag().oneElement())
									.oneElement()
						  ),
						  Q.linkElementByBlockNode(t.domFrag().oneElement(), t))
						: ((this.sub = this.downInto = this.sup.downOutOf = t),
						  (t.adopt(this, 0, this.sup).upOutOf = this.sup),
						  this.domFrag().removeClass('mq-sup-only'),
						  t.setDOM(
								O(f('span', { class: 'mq-sub' }))
									.append(t.domFrag().children())
									.appendTo(this.domFrag().oneElement())
									.oneElement()
						  ),
						  Q.linkElementByBlockNode(t.domFrag().oneElement(), t),
						  this.domFrag().append(
								O(f('span', { style: 'display:inline-block;width:0' }, [f.text(gt)]))
						  ));
					for (var e = 0; e < 2; e += 1)
						(function (r, i, a, u) {
							r[i].deleteOutOf = function (p, h) {
								var m, y;
								h.insDirOf(this[p] ? -p : p, this.parent),
									this.isEmpty() ||
										((m = this.getEnd(p)),
										this.children()
											.disown()
											.withDirAdopt(p, h.parent, h[p], h[-p])
											.domFrag()
											.insDirOf(-p, h.domFrag()),
										(h[-p] = m)),
									(r.supsub = a),
									delete r[i],
									delete r[''.concat(u, 'Into')],
									(y = r[a]),
									(y[''.concat(u, 'OutOf')] = Ht),
									delete y.deleteOutOf,
									i === 'sub' && r.domFrag().addClass('mq-sup-only').children().last().remove(),
									this.remove();
							};
						})(this, 'sub sup'.split(' ')[e], 'sup sub'.split(' ')[e], 'down up'.split(' ')[e]);
				}),
				n
			);
		})(M)),
		(le = (function (o) {
			function n() {
				var t = (o !== null && o.apply(this, arguments)) || this;
				return (
					(t.supsub = 'sub'),
					(t.domView = new N(1, function (e) {
						return f('span', { class: 'mq-supsub mq-non-leaf' }, [
							f.block('span', { class: 'mq-sub' }, e[0]),
							f('span', { style: 'display:inline-block;width:0' }, [f.text(gt)])
						]);
					})),
					(t.textTemplate = ['_']),
					(t.mathspeakTemplate = ['Subscript,', ', Baseline']),
					(t.ariaLabel = 'subscript'),
					t
				);
			}
			return (
				__extends(n, o),
				(n.prototype.finalizeTree = function () {
					(this.downInto = this.sub = this.getEnd(l)),
						(this.sub.upOutOf = Ht),
						o.prototype.finalizeTree.call(this);
				}),
				n
			);
		})(J)),
		(s.subscript = s._ = le),
		(s.superscript =
			s.supscript =
			s['^'] =
				(function (o) {
					function n() {
						var t = (o !== null && o.apply(this, arguments)) || this;
						return (
							(t.supsub = 'sup'),
							(t.domView = new N(1, function (e) {
								return f('span', { class: 'mq-supsub mq-non-leaf mq-sup-only' }, [
									f.block('span', { class: 'mq-sup' }, e[0])
								]);
							})),
							(t.textTemplate = ['^(', ')']),
							(t.ariaLabel = 'superscript'),
							(t.mathspeakTemplate = ['Superscript,', ', Baseline']),
							t
						);
					}
					return (
						__extends(n, o),
						(n.prototype.mathspeak = function (t) {
							var e,
								r,
								i = this.upInto;
							return i === void 0 || ((e = Pt(i)), (t && t.ignoreShorthand) || !St.test(e))
								? o.prototype.mathspeak.call(this)
								: e === '0'
								? 'to the 0 power'
								: e === '2'
								? 'squared'
								: e === '3'
								? 'cubed'
								: ((r = ''),
								  /^[+-]?\d{1,3}$/.test(e) &&
										(/(11|12|13|4|5|6|7|8|9|0)$/.test(e)
											? (r = 'th')
											: /1$/.test(e)
											? (r = 'st')
											: /2$/.test(e)
											? (r = 'nd')
											: /3$/.test(e) && (r = 'rd')),
								  'to the ' + (typeof i == 'object' ? i.mathspeak() : e) + r + ' power');
						}),
						(n.prototype.finalizeTree = function () {
							(this.upInto = this.sup = this.getEnd(c)),
								(this.sup.downOutOf = Ht),
								o.prototype.finalizeTree.call(this);
						}),
						n
					);
				})(J)),
		(ht = (function (o) {
			function n(t, e, r) {
				var i,
					a = o.call(this) || this;
				return (
					(a.ariaLabel = r || t.replace(/^\\/, '')),
					(i = new N(2, function (u) {
						return f('span', { class: 'mq-large-operator mq-non-leaf' }, [
							f('span', { class: 'mq-to' }, [f.block('span', {}, u[1])]),
							f('big', {}, [f.text(e)]),
							f('span', { class: 'mq-from' }, [f.block('span', {}, u[0])])
						]);
					})),
					V.prototype.setCtrlSeqHtmlTextAndMathspeak.call(a, t, i),
					a
				);
			}
			return (
				__extends(n, o),
				(n.prototype.createLeftOf = function (t) {
					o.prototype.createLeftOf.call(this, t),
						t.options.sumStartsWithNEquals &&
							(new pt('n').createLeftOf(t), new ie().createLeftOf(t));
				}),
				(n.prototype.latexRecursive = function (t) {
					var e, r;
					this.checkCursorContextOpen(t),
						(t.latex += this.ctrlSeq + '_{'),
						(e = t.latex.length),
						this.getEnd(l).latexRecursive(t),
						(r = t.latex.length),
						r === e && (t.latex += ' '),
						(t.latex += '}^{'),
						(e = t.latex.length),
						this.getEnd(c).latexRecursive(t),
						(r = t.latex.length),
						e === r && (t.latex += ' '),
						(t.latex += '}'),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.mathspeak = function () {
					return (
						'Start ' +
						this.ariaLabel +
						' from ' +
						this.getEnd(l).mathspeak() +
						' to ' +
						this.getEnd(c).mathspeak() +
						', end ' +
						this.ariaLabel +
						', '
					);
				}),
				(n.prototype.parser = function () {
					var t,
						e = k.string,
						r = k.optWhitespace,
						i = k.succeed,
						a = G.block,
						u = this,
						p = (u.blocks = [new R(), new R()]);
					for (t = 0; t < p.length; t += 1) p[t].adopt(u, u.getEnd(c), 0);
					return r
						.then(e('_').or(e('^')))
						.then(function (h) {
							var m = p[h === '_' ? 0 : 1];
							return a.then(function (y) {
								return y.children().adopt(m, m.getEnd(c), 0), i(u);
							});
						})
						.many()
						.result(u);
				}),
				(n.prototype.finalizeTree = function () {
					var t = this.getEnd(l),
						e = this.getEnd(c);
					(t.ariaLabel = 'lower bound'),
						(e.ariaLabel = 'upper bound'),
						(this.downInto = t),
						(this.upInto = e),
						(t.upOutOf = e),
						(e.downOutOf = t);
				}),
				n
			);
		})(M)),
		(s['\u2211'] =
			s.sum =
			s.summation =
				function () {
					return new ht('\\sum ', Le, 'sum');
				}),
		(s['\u220F'] =
			s.prod =
			s.product =
				function () {
					return new ht('\\prod ', Oe, 'product');
				}),
		(s.coprod = s.coproduct =
			function () {
				return new ht('\\coprod ', Se, 'co product');
			}),
		(s['\u222B'] =
			s.int =
			s.integral =
				(function (o) {
					function n() {
						var t = o.call(this, '\\int ', '', 'integral') || this;
						return (
							(t.ariaLabel = 'integral'),
							(t.domView = new N(2, function (e) {
								return f('span', { class: 'mq-int mq-non-leaf' }, [
									f('big', {}, [f.text(Te)]),
									f('span', { class: 'mq-supsub mq-non-leaf' }, [
										f('span', { class: 'mq-sup' }, [
											f.block('span', { class: 'mq-sup-inner' }, e[1])
										]),
										f.block('span', { class: 'mq-sub' }, e[0]),
										f('span', { style: 'display:inline-block;width:0' }, [f.text(gt)])
									])
								]);
							})),
							t
						);
					}
					return (
						__extends(n, o),
						(n.prototype.createLeftOf = function (t) {
							M.prototype.createLeftOf.call(this, t);
						}),
						n
					);
				})(ht)),
		(Qe =
			s.frac =
			s.dfrac =
			s.cfrac =
			s.fraction =
				(function (o) {
					function n() {
						var t = (o !== null && o.apply(this, arguments)) || this;
						return (
							(t.ctrlSeq = '\\frac'),
							(t.domView = new N(2, function (e) {
								return f('span', { class: 'mq-fraction mq-non-leaf' }, [
									f.block('span', { class: 'mq-numerator' }, e[0]),
									f.block('span', { class: 'mq-denominator' }, e[1]),
									f('span', { style: 'display:inline-block;width:0' }, [f.text(gt)])
								]);
							})),
							(t.textTemplate = ['(', ')/(', ')']),
							t
						);
					}
					return (
						__extends(n, o),
						(n.prototype.finalizeTree = function () {
							var t = this.getEnd(l),
								e = this.getEnd(c);
							(this.upInto = e.upOutOf = t),
								(this.downInto = t.downOutOf = e),
								(t.ariaLabel = 'numerator'),
								(e.ariaLabel = 'denominator'),
								this.getFracDepth() > 1
									? (this.mathspeakTemplate = [
											'StartNestedFraction,',
											'NestedOver',
											', EndNestedFraction'
									  ])
									: (this.mathspeakTemplate = ['StartFraction,', 'Over', ', EndFraction']);
						}),
						(n.prototype.mathspeak = function (t) {
							var e, r, i, a, u, p, h, m;
							if (t && t.createdLeftOf) return (e = t.createdLeftOf), e.parent.mathspeak();
							if (
								((r = Pt(this.getEnd(l))),
								(i = Pt(this.getEnd(c))),
								(!t || !t.ignoreShorthand) &&
									St.test(r) &&
									St.test(i) &&
									((a = r === '1' || r === '-1'),
									(u = ''),
									i === '2'
										? (u = a ? 'half' : 'halves')
										: i === '3'
										? (u = a ? 'third' : 'thirds')
										: i === '4'
										? (u = a ? 'quarter' : 'quarters')
										: i === '5'
										? (u = a ? 'fifth' : 'fifths')
										: i === '6'
										? (u = a ? 'sixth' : 'sixths')
										: i === '7'
										? (u = a ? 'seventh' : 'sevenths')
										: i === '8'
										? (u = a ? 'eighth' : 'eighths')
										: i === '9' && (u = a ? 'ninth' : 'ninths'),
									u !== ''))
							) {
								for (p = '', h = !1, m = this[l]; m && m[l] !== void 0; m = m[l])
									if (m.ctrlSeq !== '\\ ') {
										if (!St.test(m.ctrlSeq || '')) {
											h = !1;
											break;
										}
										h = !0;
									}
								return h && (p += 'and '), (p += this.getEnd(l).mathspeak() + ' ' + u);
							}
							return o.prototype.mathspeak.call(this);
						}),
						(n.prototype.getFracDepth = function () {
							var t = function (e, r) {
								return (
									e instanceof W &&
										e.ctrlSeq &&
										e.ctrlSeq.toLowerCase().search('frac') >= 0 &&
										(r += 1),
									e && e.parent ? t(e.parent, r) : r
								);
							};
							return t(this, 0);
						}),
						n
					);
				})(M)),
		(Ue =
			s.over =
			rt['/'] =
				(function (o) {
					function n() {
						return (o !== null && o.apply(this, arguments)) || this;
					}
					return (
						__extends(n, o),
						(n.prototype.createLeftOf = function (t) {
							var e, r, i;
							if (!this.replacedFragment) {
								if (((e = t[l]), !t.options.typingSlashCreatesNewFraction))
									for (
										;
										e &&
										!(
											e instanceof P ||
											e instanceof (s.text || K) ||
											e instanceof ht ||
											e.ctrlSeq === '\\ ' ||
											/^[,;:]$/.test(e.ctrlSeq)
										);

									)
										e = e[l];
								e instanceof ht &&
									e[c] instanceof J &&
									((e = e[c]), (r = e[c]) instanceof J && r.ctrlSeq != e.ctrlSeq && (e = e[c])),
									e === t[l] ||
										t.isTooDeep(1) ||
										((r = e[c]),
										(i = t[l]),
										this.replaces(new I(r || t.parent.getEnd(l), i)),
										(t[l] = e));
							}
							o.prototype.createLeftOf.call(this, t);
						}),
						n
					);
				})(Qe)),
		(ue = function () {
			return new V('\\operatorname{ans}', f('span', { class: 'mq-ans' }, [f.text('ans')]), 'ans');
		}),
		(s.ans = ue),
		(ce = function () {
			return new V(
				'\\%\\operatorname{of}',
				f('span', { class: 'mq-nonSymbola mq-operator-name' }, [f.text('% of ')]),
				'percent of'
			);
		}),
		(s.percent = s.percentof = ce),
		(pe = (function (o) {
			function n() {
				var t = (o !== null && o.apply(this, arguments)) || this;
				return (
					(t.ctrlSeq = '\\sqrt'),
					(t.domView = new N(1, function (e) {
						return f('span', { class: 'mq-non-leaf mq-sqrt-container' }, [
							f('span', { class: 'mq-scaled mq-sqrt-prefix' }, [xt.sqrt.html()]),
							f.block('span', { class: 'mq-non-leaf mq-sqrt-stem' }, e[0])
						]);
					})),
					(t.textTemplate = ['sqrt(', ')']),
					(t.mathspeakTemplate = ['StartRoot,', ', EndRoot']),
					(t.ariaLabel = 'root'),
					t
				);
			}
			return (
				__extends(n, o),
				(n.prototype.parser = function () {
					return G.optBlock
						.then(function (t) {
							return G.block.map(function (e) {
								var r = new Mt();
								return (r.blocks = [t, e]), t.adopt(r, 0, 0), e.adopt(r, t, 0), r;
							});
						})
						.or(o.prototype.parser.call(this));
				}),
				n
			);
		})(M)),
		(s.sqrt = pe),
		(s.hat = (function (o) {
			function n() {
				var t = (o !== null && o.apply(this, arguments)) || this;
				return (
					(t.ctrlSeq = '\\hat'),
					(t.domView = new N(1, function (e) {
						return f('span', { class: 'mq-non-leaf' }, [
							f('span', { class: 'mq-hat-prefix' }, [f.text('^')]),
							f.block('span', { class: 'mq-hat-stem' }, e[0])
						]);
					})),
					(t.textTemplate = ['hat(', ')']),
					t
				);
			}
			return __extends(n, o), n;
		})(M)),
		(Mt = (function (o) {
			function n() {
				var t = (o !== null && o.apply(this, arguments)) || this;
				return (
					(t.domView = new N(2, function (e) {
						return f('span', { class: 'mq-nthroot-container mq-non-leaf' }, [
							f.block('sup', { class: 'mq-nthroot mq-non-leaf' }, e[0]),
							f('span', { class: 'mq-scaled mq-sqrt-container' }, [
								f('span', { class: 'mq-sqrt-prefix mq-scaled' }, [xt.sqrt.html()]),
								f.block('span', { class: 'mq-sqrt-stem mq-non-leaf' }, e[1])
							])
						]);
					})),
					(t.textTemplate = ['sqrt[', '](', ')']),
					t
				);
			}
			return (
				__extends(n, o),
				(n.prototype.latexRecursive = function (t) {
					this.checkCursorContextOpen(t),
						(t.latex += '\\sqrt['),
						this.getEnd(l).latexRecursive(t),
						(t.latex += ']{'),
						this.getEnd(c).latexRecursive(t),
						(t.latex += '}'),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.mathspeak = function () {
					var t = this.getEnd(l).mathspeak(),
						e = this.getEnd(c).mathspeak();
					return (
						(this.getEnd(l).ariaLabel = 'Index'),
						(this.getEnd(c).ariaLabel = 'Radicand'),
						t === '3'
							? 'Start Cube Root, ' + e + ', End Cube Root'
							: 'Root Index ' + t + ', Start Root, ' + e + ', End Root'
					);
				}),
				n
			);
		})(pe)),
		(s.nthroot = Mt),
		(s.cbrt = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.createLeftOf = function (t) {
					o.prototype.createLeftOf.call(this, t),
						new Ot('3').createLeftOf(t),
						t.controller.moveRight();
				}),
				n
			);
		})(Mt)),
		(he = (function (o) {
			function n(t, e, r) {
				var i = new N(1, function (a) {
					return f('span', { class: 'mq-non-leaf' }, [
						f('span', { class: 'mq-diacritic-above' }, [e]),
						f.block('span', { class: 'mq-diacritic-stem' }, a[0])
					]);
				});
				return o.call(this, t, i, r) || this;
			}
			return __extends(n, o), n;
		})(M)),
		(s.vec = function () {
			return new he('\\vec', f.entityText('&rarr;'), ['vec(', ')']);
		}),
		(s.tilde = function () {
			return new he('\\tilde', f.text('~'), ['tilde(', ')']);
		}),
		(fe = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.setDOM = function (t) {
					var e, r;
					return (
						o.prototype.setDOM.call(this, t),
						(r = this.domFrag().children()),
						r.isEmpty() || (this.delimFrags = ((e = {}), (e[l] = r.first()), (e[c] = r.last()), e)),
						this
					);
				}),
				n
			);
		})(M)),
		(tt = (function (o) {
			function n(t, e, r, i, a) {
				var u,
					p = o.call(this, '\\left' + i, void 0, [e, r]) || this;
				return (
					(p.side = t),
					(p.sides = ((u = {}), (u[l] = { ch: e, ctrlSeq: i }), (u[c] = { ch: r, ctrlSeq: a }), u)),
					p
				);
			}
			return (
				__extends(n, o),
				(n.prototype.numBlocks = function () {
					return 1;
				}),
				(n.prototype.html = function () {
					var t = this,
						e = this.getSymbol(l),
						r = this.getSymbol(c);
					return (
						(this.domView = new N(1, function (i) {
							return f('span', { class: 'mq-non-leaf mq-bracket-container' }, [
								f(
									'span',
									{
										style: 'width:' + e.width,
										class: 'mq-scaled mq-bracket-l mq-paren' + (t.side === c ? ' mq-ghost' : '')
									},
									[e.html()]
								),
								f.block(
									'span',
									{
										style: 'margin-left:' + e.width + ';margin-right:' + r.width,
										class: 'mq-bracket-middle mq-non-leaf'
									},
									i[0]
								),
								f(
									'span',
									{
										style: 'width:' + r.width,
										class: 'mq-scaled mq-bracket-r mq-paren' + (t.side === l ? ' mq-ghost' : '')
									},
									[r.html()]
								)
							]);
						})),
						o.prototype.html.call(this)
					);
				}),
				(n.prototype.getSymbol = function (t) {
					var e = this.sides[t || c].ch;
					return xt[e] || { width: '0', html: '' };
				}),
				(n.prototype.latexRecursive = function (t) {
					this.checkCursorContextOpen(t),
						(t.latex += '\\left' + this.sides[l].ctrlSeq),
						this.getEnd(l).latexRecursive(t),
						(t.latex += '\\right' + this.sides[c].ctrlSeq),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.mathspeak = function (t) {
					var e,
						r = this.sides[l].ch,
						i = this.sides[c].ch;
					if (r === '|' && i === '|')
						(this.mathspeakTemplate = ['StartAbsoluteValue,', ', EndAbsoluteValue']),
							(this.ariaLabel = 'absolute value');
					else {
						if (t && t.createdLeftOf && this.side)
							return (
								(e = ''),
								this.side === l
									? (e = this.textTemplate[0])
									: this.side === c && (e = this.textTemplate[1]),
								(this.side === l ? 'left ' : 'right ') + mt[e]
							);
						(this.mathspeakTemplate = ['left ' + mt[r] + ',', ', right ' + mt[i]]),
							(this.ariaLabel = mt[r] + ' block');
					}
					return o.prototype.mathspeak.call(this);
				}),
				(n.prototype.matchBrack = function (t, e, r) {
					return (
						r instanceof n &&
						r.side &&
						r.side !== -e &&
						(!t.restrictMismatchedBrackets ||
							Et[this.sides[this.side].ch] === r.sides[r.side].ch ||
							{ '(': ']', '[': ')' }[this.sides[l].ch] === r.sides[c].ch) &&
						r
					);
				}),
				(n.prototype.closeOpposing = function (t) {
					(t.side = 0), (t.sides[this.side] = this.sides[this.side]);
					var e = t.delimFrags[this.side === l ? l : c].removeClass('mq-ghost');
					this.replaceBracket(e, this.side);
				}),
				(n.prototype.createLeftOf = function (t) {
					var e, r, i;
					this.replacedFragment ||
						((r = t.options),
						(e =
							this.sides[l].ch === '|'
								? this.matchBrack(r, c, t[c]) ||
								  this.matchBrack(r, l, t[l]) ||
								  this.matchBrack(r, 0, t.parent.parent)
								: this.matchBrack(r, -this.side, t[-this.side]) ||
								  this.matchBrack(r, -this.side, t.parent.parent))),
						e
							? ((i = this.side = -e.side),
							  this.closeOpposing(e),
							  e === t.parent.parent &&
									t[i] &&
									new I(t[i], t.parent.getEnd(i), -i)
										.disown()
										.withDirAdopt(-i, e.parent, e, e[i])
										.domFrag()
										.insDirOf(i, e.domFrag()),
							  e.bubble(function (a) {
									a.reflow();
							  }))
							: ((e = this),
							  (i = e.side),
							  e.replacedFragment
									? (e.side = 0)
									: t[-i] && (e.replaces(new I(t[-i], t.parent.getEnd(-i), i)), (t[-i] = 0)),
							  o.prototype.createLeftOf.call(this, t)),
						i === l ? t.insAtLeftEnd(e.getEnd(l)) : t.insRightOf(e);
				}),
				(n.prototype.placeCursor = function () {}),
				(n.prototype.unwrap = function () {
					this.getEnd(l)
						.children()
						.disown()
						.adopt(this.parent, this, this[c])
						.domFrag()
						.insertAfter(this.domFrag()),
						this.remove();
				}),
				(n.prototype.deleteSide = function (t, e, r) {
					var i,
						a,
						u,
						p,
						h,
						m = this.parent,
						y = this[t],
						w = m.getEnd(t);
					if (t === this.side)
						return this.unwrap(), void (y ? r.insDirOf(-t, y) : r.insAtDirEnd(t, m));
					if (
						((i = r.options),
						(a = !this.side),
						(this.side = -t),
						this.matchBrack(i, t, this.getEnd(l).getEnd(this.side)))
					)
						this.closeOpposing(this.getEnd(l).getEnd(this.side)),
							(u = this.getEnd(l).getEnd(t)),
							this.unwrap(),
							u && u.siblingCreated(r.options, t),
							y ? r.insDirOf(-t, y) : r.insAtDirEnd(t, m);
					else {
						if (this.matchBrack(i, t, this.parent.parent))
							this.parent.parent.closeOpposing(this), this.parent.parent.unwrap();
						else {
							if (e && a) return this.unwrap(), void (y ? r.insDirOf(-t, y) : r.insAtDirEnd(t, m));
							(this.sides[t] = en(this)),
								this.delimFrags[l].removeClass('mq-ghost'),
								this.delimFrags[c].removeClass('mq-ghost'),
								(p = this.delimFrags[t].addClass('mq-ghost')),
								this.replaceBracket(p, t);
						}
						y
							? ((h = this.getEnd(l)),
							  (u = h.getEnd(t)),
							  h.domFrag().removeClass('mq-empty'),
							  new I(y, w, -t)
									.disown()
									.withDirAdopt(-t, h, u, 0)
									.domFrag()
									.insAtDirEnd(t, h.domFrag().oneElement()),
							  u && u.siblingCreated(r.options, t),
							  r.insDirOf(-t, y))
							: e
							? r.insDirOf(t, this)
							: r.insAtDirEnd(t, this.getEnd(l));
					}
				}),
				(n.prototype.replaceBracket = function (t, e) {
					var r,
						i,
						a = this.getSymbol(e);
					t.children().replaceWith(O(a.html())),
						(t.oneElement().style.width = a.width),
						e === l
							? ((r = t.next()), r.isEmpty() || (r.oneElement().style.marginLeft = a.width))
							: ((i = t.prev()), i.isEmpty() || (i.oneElement().style.marginRight = a.width));
				}),
				(n.prototype.deleteTowards = function (t, e) {
					this.deleteSide(-t, !1, e);
				}),
				(n.prototype.finalizeTree = function () {
					(this.getEnd(l).deleteOutOf = function (t, e) {
						this.parent.deleteSide(t, !0, e);
					}),
						(this.finalizeTree = this.intentionalBlur =
							function () {
								this.delimFrags[this.side === l ? c : l].removeClass('mq-ghost'), (this.side = 0);
							});
				}),
				(n.prototype.siblingCreated = function (t, e) {
					e === -this.side && this.finalizeTree();
				}),
				n
			);
		})(fe)),
		(Et = {
			'(': ')',
			')': '(',
			'[': ']',
			']': '[',
			'{': '}',
			'}': '{',
			'\\{': '\\}',
			'\\}': '\\{',
			'&lang;': '&rang;',
			'&rang;': '&lang;',
			'\\langle ': '\\rangle ',
			'\\rangle ': '\\langle ',
			'|': '|',
			'\\lVert ': '\\rVert ',
			'\\rVert ': '\\lVert '
		}),
		(mt = { '&lang;': 'angle-bracket', '&rang;': 'angle-bracket', '|': 'pipe' }),
		$t('(', '', 'parenthesis'),
		$t('[', '', 'bracket'),
		$t('{', '\\{', 'brace'),
		(s.langle = function () {
			return new tt(l, '&lang;', '&rang;', '\\langle ', '\\rangle ');
		}),
		(s.rangle = function () {
			return new tt(c, '&lang;', '&rang;', '\\langle ', '\\rangle ');
		}),
		(rt['|'] = function () {
			return new tt(l, '|', '|', '|', '|');
		}),
		(s.lVert = function () {
			return new tt(l, '&#8741;', '&#8741;', '\\lVert ', '\\rVert ');
		}),
		(s.rVert = function () {
			return new tt(c, '&#8741;', '&#8741;', '\\lVert ', '\\rVert ');
		}),
		(s.left = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.parser = function () {
					var t = k.regex,
						e = k.string,
						r = k.optWhitespace;
					return r
						.then(t(/^(?:[([|]|\\\{|\\langle(?![a-zA-Z])|\\lVert(?![a-zA-Z]))/))
						.then(function (i) {
							var a = i.replace(/^\\/, '');
							return (
								i == '\\langle' && ((a = '&lang;'), (i += ' ')),
								i == '\\lVert' && ((a = '&#8741;'), (i += ' ')),
								G.then(function (u) {
									return e('\\right')
										.skip(r)
										.then(t(/^(?:[\])|]|\\\}|\\rangle(?![a-zA-Z])|\\rVert(?![a-zA-Z]))/))
										.map(function (p) {
											var h,
												m = p.replace(/^\\/, '');
											return (
												p == '\\rangle' && ((m = '&rang;'), (p += ' ')),
												p == '\\rVert' && ((m = '&#8741;'), (p += ' ')),
												(h = new tt(0, a, m, i, p)),
												(h.blocks = [u]),
												u.adopt(h, 0, 0),
												h
											);
										});
								})
							);
						});
				}),
				n
			);
		})(M)),
		(s.right = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.parser = function () {
					return k.fail('unmatched \\right');
				}),
				n
			);
		})(M)),
		(Nt = xt['(']),
		(It = xt[')']),
		(de = (function (o) {
			function n() {
				var t = (o !== null && o.apply(this, arguments)) || this;
				return (
					(t.ctrlSeq = '\\binom'),
					(t.domView = new N(2, function (e) {
						return f('span', { class: 'mq-non-leaf mq-bracket-container' }, [
							f('span', { style: 'width:' + Nt.width, class: 'mq-paren mq-bracket-l mq-scaled' }, [
								Nt.html()
							]),
							f(
								'span',
								{
									style: 'margin-left:' + Nt.width + '; margin-right:' + It.width,
									class: 'mq-non-leaf mq-bracket-middle'
								},
								[
									f('span', { class: 'mq-array mq-non-leaf' }, [
										f.block('span', {}, e[0]),
										f.block('span', {}, e[1])
									])
								]
							),
							f('span', { style: 'width:' + It.width, class: 'mq-paren mq-bracket-r mq-scaled' }, [
								It.html()
							])
						]);
					})),
					(t.textTemplate = ['choose(', ',', ')']),
					(t.mathspeakTemplate = ['StartBinomial,', 'Choose', ', EndBinomial']),
					(t.ariaLabel = 'binomial'),
					t
				);
			}
			return __extends(n, o), n;
		})(fe)),
		(s.binom = s.binomial = de),
		(s.choose = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.createLeftOf = function (t) {
					Ue.prototype.createLeftOf(t);
				}),
				n
			);
		})(de)),
		(We = (function (o) {
			function n() {
				var t = (o !== null && o.apply(this, arguments)) || this;
				return (
					(t.ctrlSeq = '\\MathQuillMathField'),
					(t.domView = new N(1, function (e) {
						return f('span', { class: 'mq-editable-field' }, [
							f.block('span', { class: 'mq-root-block', 'aria-hidden': 'true' }, e[0])
						]);
					})),
					t
				);
			}
			return (
				__extends(n, o),
				(n.prototype.parser = function () {
					var t = this,
						e = k.string,
						r = k.regex,
						i = k.succeed;
					return e('[')
						.then(r(/^[a-z][a-z0-9]*/i))
						.skip(e(']'))
						.map(function (a) {
							t.name = a;
						})
						.or(i(void 0))
						.then(o.prototype.parser.call(this));
				}),
				(n.prototype.finalizeTree = function (t) {
					function e(i) {
						if (
							(i.parentNode && !O(i).hasClass('mq-root-block') && e(i.parentNode),
							i.nodeType === Node.ELEMENT_NODE)
						) {
							var a = i;
							a.getAttribute('aria-hidden') === 'true' &&
								(a.removeAttribute('aria-hidden'),
								O(i)
									.children()
									.eachElement(function (u) {
										u.setAttribute('aria-hidden', 'true');
									}));
						}
					}
					var r = new Zt(this.getEnd(l), this.domFrag().oneElement(), t);
					(r.KIND_OF_MQ = 'MathField'),
						(r.editable = !0),
						r.createTextarea(),
						r.editablesTextareaEvents(),
						r.cursor.insAtRightEnd(r.root),
						xe(r.root),
						e(this.domFrag().parent().oneElement()),
						this.domFrag().oneElement().removeAttribute('aria-hidden');
				}),
				(n.prototype.registerInnerField = function (t, e) {
					var r = this.getEnd(l).controller,
						i = new e(r);
					(t[this.name] = i), t.push(i);
				}),
				(n.prototype.latexRecursive = function (t) {
					this.checkCursorContextOpen(t),
						this.getEnd(l).latexRecursive(t),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.text = function () {
					return this.getEnd(l).text();
				}),
				n
			);
		})(M)),
		(s.editable = s.MathQuillMathField = We),
		(me = (function (o) {
			function n() {
				return (o !== null && o.apply(this, arguments)) || this;
			}
			return (
				__extends(n, o),
				(n.prototype.setOptions = function (t) {
					function e() {
						return '';
					}
					return (
						(this.text = t.text || e),
						(this.domView = new N(0, function () {
							return f('span', {}, [Z(t.htmlString || '')]);
						})),
						(this.latex = t.latex || e),
						this
					);
				}),
				(n.prototype.latexRecursive = function (t) {
					this.checkCursorContextOpen(t),
						(t.latex += this.latex()),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.parser = function () {
					var t = this,
						e = k.string,
						r = k.regex,
						i = k.succeed;
					return e('{')
						.then(r(/^[a-z][a-z0-9]*/i))
						.skip(e('}'))
						.then(function (a) {
							return e('[')
								.then(r(/^[-\w\s]*/))
								.skip(e(']'))
								.or(i(void 0))
								.map(function (u) {
									return t.setOptions(Ut[a](u));
								});
						});
				}),
				n
			);
		})(V)),
		(s.embed = me),
		(rt['\\'] = (function (o) {
			function n() {
				var t = (o !== null && o.apply(this, arguments)) || this;
				return (
					(t.ctrlSeq = '\\'),
					(t.domView = new N(1, function (e) {
						return f('span', { class: 'mq-latex-command-input-wrapper mq-non-leaf' }, [
							f('span', { class: 'mq-latex-command-input mq-non-leaf' }, [
								f.text('\\'),
								f.block('span', {}, e[0])
							])
						]);
					})),
					(t.textTemplate = ['\\']),
					t
				);
			}
			return (
				__extends(n, o),
				(n.prototype.replaces = function (t) {
					(this._replacedFragment = t.disown()),
						(this.isEmpty = function () {
							return !1;
						});
				}),
				(n.prototype.createBlocks = function () {
					var t, e;
					o.prototype.createBlocks.call(this),
						(t = this.getEnd(l)),
						(t.focus = function () {
							return (
								this.parent.domFrag().addClass('mq-hasCursor'),
								this.isEmpty() && this.parent.domFrag().removeClass('mq-empty'),
								this
							);
						}),
						(t.blur = function () {
							return (
								this.parent.domFrag().removeClass('mq-hasCursor'),
								this.isEmpty() && this.parent.domFrag().addClass('mq-empty'),
								this
							);
						}),
						(t.write = function (r, i) {
							if ((r.show().deleteSelection(), i.match(/[a-z]/i)))
								new it(i).createLeftOf(r), r.controller.aria.alert(i);
							else {
								var a = this.parent.renderCommand(r);
								r.controller.aria.queue(a.mathspeak({ createdLeftOf: r })),
									i === '\\' && this.isEmpty() ? r.controller.aria.alert() : r.parent.write(r, i);
							}
						}),
						(e = t.keystroke),
						(t.keystroke = function (r, i, a) {
							if (r === 'Tab' || r === 'Enter' || r === 'Spacebar') {
								var u = this.parent.renderCommand(a.cursor);
								return (
									a.aria.alert(u.mathspeak({ createdLeftOf: a.cursor })),
									void (i == null || i.preventDefault())
								);
							}
							return e.call(this, r, i, a);
						});
				}),
				(n.prototype.createLeftOf = function (t) {
					var e, r, i;
					o.prototype.createLeftOf.call(this, t),
						this._replacedFragment &&
							((e = this.domFrag()),
							(r = e.oneElement()),
							this._replacedFragment.domFrag().addClass('mq-blur'),
							(i = function (a) {
								return (a.target = r), r.dispatchEvent(a), !1;
							}),
							r.addEventListener('mousedown', i),
							r.addEventListener('mouseup', i),
							this._replacedFragment.domFrag().insertBefore(e.children().first()));
				}),
				(n.prototype.latexRecursive = function (t) {
					this.checkCursorContextOpen(t),
						(t.latex += '\\'),
						this.getEnd(l).latexRecursive(t),
						(t.latex += ' '),
						this.checkCursorContextClose(t);
				}),
				(n.prototype.renderCommand = function (t) {
					var e, r, i;
					return (
						this.setDOM(this.domFrag().children().lastElement()),
						this.remove(),
						this[c] ? t.insLeftOf(this[c]) : t.insAtRightEnd(this.parent),
						(e = this.getEnd(l).latex()),
						e || (e = ' '),
						(r = s[e]),
						r
							? ((i = void 0),
							  (i = zt(r) ? new r(e) : r(e)),
							  this._replacedFragment && i.replaces(this._replacedFragment),
							  i.createLeftOf(t),
							  i)
							: ((i = new Dt()),
							  i.replaces(e),
							  i.createLeftOf(t),
							  t.insRightOf(i),
							  this._replacedFragment && this._replacedFragment.remove(),
							  i)
					);
				}),
				n
			);
		})(M)),
		window.jQuery)
	) {
		yt = qt(1);
		for (ge in yt)
			(function (o, n) {
				typeof n == 'function'
					? ((et[o] = function () {
							return kt(), n.apply(this, arguments);
					  }),
					  (et[o].prototype = n.prototype))
					: (et[o] = n);
			})(ge, yt[ge]);
	}
})();
